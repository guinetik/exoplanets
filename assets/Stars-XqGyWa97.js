import{c as q,d as G,u as O,f as U,r as i,j as e,S as z}from"./index-Bnz9bIRr.js";import{S as H}from"./StarCard-rzauG6Hx.js";const b=24;function V(){var A;const{t:a}=q(),{getAllStars:S,isLoading:B,error:v}=G(),{trackSearch:E,trackFilter:T}=O(),[m,C]=U(),j=i.useRef(null),[h,_]=i.useState(m.get("sort")||"name"),[c,M]=i.useState(((A=m.get("classes"))==null?void 0:A.split(",").filter(Boolean))||[]),[d,P]=i.useState(m.get("search")||""),[I,p]=i.useState(parseInt(m.get("page")||"1",10)),[l,k]=i.useState(m.get("binary")||"all"),g=i.useMemo(()=>S(),[S]),L=i.useMemo(()=>{const s=new Set;return g.forEach(n=>{n.star_class&&s.add(n.star_class)}),Array.from(s).sort()},[g]),f=i.useMemo(()=>{let s=g;if(c.length>0&&(s=s.filter(t=>t.star_class&&c.includes(t.star_class))),l==="binary"?s=s.filter(t=>t.sy_snum>1):l==="single"&&(s=s.filter(t=>t.sy_snum===1)),d){const t=d.toLowerCase();s=s.filter(u=>u.hostname.toLowerCase().includes(t))}return[...s].sort((t,u)=>{switch(h){case"distance":return(t.distance_ly??1/0)-(u.distance_ly??1/0);case"planets":return u.sy_pnum-t.sy_pnum;case"temperature":return(u.st_teff??0)-(t.st_teff??0);case"name":default:return t.hostname.localeCompare(u.hostname)}})},[g,c,d,h,l]),o=Math.ceil(f.length/b),r=Math.min(Math.max(1,I),o||1),y=(r-1)*b,w=y+b,F=f.slice(y,w);i.useEffect(()=>{const s=new URLSearchParams;h!=="name"&&s.set("sort",h),c.length>0&&s.set("classes",c.join(",")),d&&s.set("search",d),l!=="all"&&s.set("binary",l),r!==1&&s.set("page",String(r)),C(s,{replace:!0})},[h,c,d,l,r,C]);const x=()=>{p(1)},R=s=>{const n=!c.includes(s);M(t=>t.includes(s)?t.filter(u=>u!==s):[...t,s]),x(),n&&T("star_class",s)},$=s=>{P(s),x(),j.current&&clearTimeout(j.current),s.length>=2&&(j.current=setTimeout(()=>{const n=g.filter(t=>t.hostname.toLowerCase().includes(s.toLowerCase()));E("stars",s,n.length)},500))},D=s=>{_(s),x()},N=s=>{k(s),x()},Q=()=>{M([]),P(""),_("name"),k("all"),p(1)};return B?e.jsx(z,{message:a("pages.stars.loading")}):v?e.jsx("div",{className:"error-container",children:e.jsxs("div",{className:"error-content",children:[e.jsx("h1",{className:"error-title",children:a("pages.stars.errorTitle")}),e.jsx("p",{className:"error-message",children:v})]})}):e.jsxs("div",{className:"page-container",children:[e.jsx("h1",{className:"page-title",children:a("pages.stars.title")}),e.jsxs("div",{className:"stars-controls",children:[e.jsx("div",{className:"search-bar",children:e.jsx("input",{type:"text",placeholder:a("pages.stars.searchPlaceholder"),value:d,onChange:s=>$(s.target.value),className:"search-input"})}),e.jsxs("div",{className:"controls-row",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:a("pages.stars.filters.starClass")}),e.jsx("div",{className:"class-buttons",children:L.map(s=>e.jsx("button",{onClick:()=>R(s),className:`class-button ${c.includes(s)?"active":""}`,children:s},s))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:a("pages.stars.filters.systemType","System Type")}),e.jsxs("div",{className:"class-buttons",children:[e.jsx("button",{onClick:()=>N("all"),className:`class-button ${l==="all"?"active":""}`,children:a("pages.stars.filters.allSystems","All")}),e.jsx("button",{onClick:()=>N("binary"),className:`class-button ${l==="binary"?"active":""}`,children:a("pages.stars.filters.binarySystems","Binary ★★")}),e.jsx("button",{onClick:()=>N("single"),className:`class-button ${l==="single"?"active":""}`,children:a("pages.stars.filters.singleSystems","Single ★")})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:a("pages.stars.filters.sortBy")}),e.jsxs("select",{value:h,onChange:s=>D(s.target.value),className:"sort-select",children:[e.jsx("option",{value:"name",children:a("pages.stars.sort.name")}),e.jsx("option",{value:"distance",children:a("pages.stars.sort.distance")}),e.jsx("option",{value:"planets",children:a("pages.stars.sort.planets")}),e.jsx("option",{value:"temperature",children:a("pages.stars.sort.temperature")})]})]}),(c.length>0||d||l!=="all")&&e.jsx("button",{onClick:Q,className:"clear-button",children:a("pages.stars.filters.clearFilters")})]}),e.jsxs("div",{className:"results-info",children:[a(f.length!==1?"pages.stars.results.showing_plural":"pages.stars.results.showing",{start:y+1,end:Math.min(w,f.length),filtered:f.length})," ",a("pages.stars.results.total",{total:g.length})]})]}),F.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stars-grid",children:F.map(s=>e.jsx("div",{className:"stars-grid-item",children:e.jsx(H,{star:s})},s.id))}),o>1&&e.jsxs("div",{className:"pagination-container",children:[e.jsx("button",{onClick:()=>p(Math.max(1,r-1)),disabled:r===1,className:"pagination-button",children:a("pages.stars.pagination.previous")}),e.jsx("div",{className:"pagination-info",children:a("pages.stars.pagination.pageOf",{current:r,total:o})}),e.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,o)},(s,n)=>{let t=n+1;return o>5&&(r<=3?t=n+1:r>=o-2?t=o-4+n:t=r-2+n),e.jsx("button",{onClick:()=>p(t),className:`pagination-number ${r===t?"active":""}`,children:t},t)})}),e.jsx("button",{onClick:()=>p(Math.min(o,r+1)),disabled:r===o,className:"pagination-button",children:a("pages.stars.pagination.next")})]})]}):e.jsx("div",{className:"placeholder",children:a("pages.stars.results.noResults")})]})}export{V as default};
