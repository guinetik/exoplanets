import{u as R,c as Q,e as q,r as c,j as e,S as D}from"./index-9Wcf8Asn.js";import{S as G}from"./StarCard-CzIbU1Tb.js";const y=24;function z(){var B;const{t}=R(),{getAllStars:b,isLoading:E,error:v}=Q(),[g,S]=q(),[h,C]=c.useState(g.get("sort")||"name"),[o,_]=c.useState(((B=g.get("classes"))==null?void 0:B.split(",").filter(Boolean))||[]),[d,M]=c.useState(g.get("search")||""),[F,m]=c.useState(parseInt(g.get("page")||"1",10)),[n,P]=c.useState(g.get("binary")||"all"),p=c.useMemo(()=>b(),[b]),I=c.useMemo(()=>{const s=new Set;return p.forEach(l=>{l.star_class&&s.add(l.star_class)}),Array.from(s).sort()},[p]),f=c.useMemo(()=>{let s=p;if(o.length>0&&(s=s.filter(a=>a.star_class&&o.includes(a.star_class))),n==="binary"?s=s.filter(a=>a.sy_snum>1):n==="single"&&(s=s.filter(a=>a.sy_snum===1)),d){const a=d.toLowerCase();s=s.filter(u=>u.hostname.toLowerCase().includes(a))}return[...s].sort((a,u)=>{switch(h){case"distance":return(a.distance_ly??1/0)-(u.distance_ly??1/0);case"planets":return u.sy_pnum-a.sy_pnum;case"temperature":return(u.st_teff??0)-(a.st_teff??0);case"name":default:return a.hostname.localeCompare(u.hostname)}})},[p,o,d,h,n]),i=Math.ceil(f.length/y),r=Math.min(Math.max(1,F),i||1),j=(r-1)*y,k=j+y,w=f.slice(j,k);c.useEffect(()=>{const s=new URLSearchParams;h!=="name"&&s.set("sort",h),o.length>0&&s.set("classes",o.join(",")),d&&s.set("search",d),n!=="all"&&s.set("binary",n),r!==1&&s.set("page",String(r)),S(s,{replace:!0})},[h,o,d,n,r,S]);const x=()=>{m(1)},A=s=>{_(l=>l.includes(s)?l.filter(a=>a!==s):[...l,s]),x()},T=s=>{M(s),x()},$=s=>{C(s),x()},N=s=>{P(s),x()},L=()=>{_([]),M(""),C("name"),P("all"),m(1)};return E?e.jsx(D,{message:t("pages.stars.loading")}):v?e.jsx("div",{className:"error-container",children:e.jsxs("div",{className:"error-content",children:[e.jsx("h1",{className:"error-title",children:t("pages.stars.errorTitle")}),e.jsx("p",{className:"error-message",children:v})]})}):e.jsxs("div",{className:"page-container",children:[e.jsx("h1",{className:"page-title",children:t("pages.stars.title")}),e.jsxs("div",{className:"stars-controls",children:[e.jsx("div",{className:"search-bar",children:e.jsx("input",{type:"text",placeholder:t("pages.stars.searchPlaceholder"),value:d,onChange:s=>T(s.target.value),className:"search-input"})}),e.jsxs("div",{className:"controls-row",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:t("pages.stars.filters.starClass")}),e.jsx("div",{className:"class-buttons",children:I.map(s=>e.jsx("button",{onClick:()=>A(s),className:`class-button ${o.includes(s)?"active":""}`,children:s},s))})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:t("pages.stars.filters.systemType","System Type")}),e.jsxs("div",{className:"class-buttons",children:[e.jsx("button",{onClick:()=>N("all"),className:`class-button ${n==="all"?"active":""}`,children:t("pages.stars.filters.allSystems","All")}),e.jsx("button",{onClick:()=>N("binary"),className:`class-button ${n==="binary"?"active":""}`,children:t("pages.stars.filters.binarySystems","Binary ★★")}),e.jsx("button",{onClick:()=>N("single"),className:`class-button ${n==="single"?"active":""}`,children:t("pages.stars.filters.singleSystems","Single ★")})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:t("pages.stars.filters.sortBy")}),e.jsxs("select",{value:h,onChange:s=>$(s.target.value),className:"sort-select",children:[e.jsx("option",{value:"name",children:t("pages.stars.sort.name")}),e.jsx("option",{value:"distance",children:t("pages.stars.sort.distance")}),e.jsx("option",{value:"planets",children:t("pages.stars.sort.planets")}),e.jsx("option",{value:"temperature",children:t("pages.stars.sort.temperature")})]})]}),(o.length>0||d||n!=="all")&&e.jsx("button",{onClick:L,className:"clear-button",children:t("pages.stars.filters.clearFilters")})]}),e.jsxs("div",{className:"results-info",children:[t(f.length!==1?"pages.stars.results.showing_plural":"pages.stars.results.showing",{start:j+1,end:Math.min(k,f.length),filtered:f.length})," ",t("pages.stars.results.total",{total:p.length})]})]}),w.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stars-grid",children:w.map(s=>e.jsx("div",{className:"stars-grid-item",children:e.jsx(G,{star:s})},s.id))}),i>1&&e.jsxs("div",{className:"pagination-container",children:[e.jsx("button",{onClick:()=>m(Math.max(1,r-1)),disabled:r===1,className:"pagination-button",children:t("pages.stars.pagination.previous")}),e.jsx("div",{className:"pagination-info",children:t("pages.stars.pagination.pageOf",{current:r,total:i})}),e.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,i)},(s,l)=>{let a=l+1;return i>5&&(r<=3?a=l+1:r>=i-2?a=i-4+l:a=r-2+l),e.jsx("button",{onClick:()=>m(a),className:`pagination-number ${r===a?"active":""}`,children:a},a)})}),e.jsx("button",{onClick:()=>m(Math.min(i,r+1)),disabled:r===i,className:"pagination-button",children:t("pages.stars.pagination.next")})]})]}):e.jsx("div",{className:"placeholder",children:t("pages.stars.results.noResults")})]})}export{z as default};
