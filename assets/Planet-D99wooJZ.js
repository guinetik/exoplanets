import{r as h,j as t,k as Kt,l as Pt,t as Dt,i as It,E as Lt,G as Ht,H as Ot,I as Vt,s as ot,D as Bt,u as O,J as Gt,n as vt,K as tt,N as Ut,O as Wt,R as Yt,L as gt,P as qt,z as Xt,d as Zt,c as Jt}from"./index-Dvm5AJp8.js";import{C as Qt,a as te}from"./react-three-fiber.esm-BlujrVGn.js";import{c as ee}from"./ringVisuals-BKm5bbSj.js";import{O as ae,s as B,f as pt,m as dt,g as st,h as rt,b as mt,d as ht,e as yt}from"./transform-DLztkFWH.js";import{r as jt,u as Nt}from"./reviewService-VMm4BpLF.js";import{U as se}from"./UserPrompt-yXdWFanK.js";import{m as re,l as At,a as _t,b as ie}from"./monotone-CvAkBM_g.js";function kt(e,a,s){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+a)/6,(e._y0+4*e._y1+s)/6)}function zt(e){this._context=e}zt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,a){switch(e=+e,a=+a,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,a):this._context.moveTo(e,a);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kt(this,e,a);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=a}};function xt(e){return new zt(e)}function wt(e,a,s,i=.5){return e==null||isNaN(e)?i:Math.max(0,Math.min(1,(e-a)/(s-a)))}function Et(e,a,s){return Math.max(a,Math.min(s,e))}function Rt(e){const a=Et(e,0,1);return a*a*(3-2*a)}function ne({count:e=2e3}){const a=h.useMemo(()=>{const s=new Float32Array(e*3);for(let i=0;i<e;i++){const x=Math.random()*Math.PI*2,n=Math.acos(2*Math.random()-1),b=200;s[i*3]=b*Math.sin(n)*Math.cos(x),s[i*3+1]=b*Math.sin(n)*Math.sin(x),s[i*3+2]=b*Math.cos(n)}return s},[e]);return t.jsxs("points",{children:[t.jsx("bufferGeometry",{children:t.jsx("bufferAttribute",{attach:"attributes-position",count:e,array:a,itemSize:3})}),t.jsx("pointsMaterial",{size:1.2,color:16777215,transparent:!0,opacity:.5,sizeAttenuation:!1})]})}function le(e){let a=0;for(let s=0;s<e.length;s++){const i=e.charCodeAt(s);a=(a<<5)-a+i,a=a&a}return Math.abs(a%1e3)/1e3}function oe({planet:e}){const a=h.useRef(null),s=h.useRef(null),i=h.useRef(null),x=h.useRef(null),n=h.useMemo(()=>Kt(e),[e]),b=h.useMemo(()=>Pt(n),[n]),g=h.useMemo(()=>Dt("v2"),[]),R=h.useMemo(()=>It({planet:e,detailLevel:"detailed",starTemp:e.st_teff??void 0}),[e]),c=h.useMemo(()=>Lt(e),[e]),M=h.useMemo(()=>Ht(e),[e]),w=e.is_likely_tidally_locked??!1,_=h.useMemo(()=>{const z=le(e.pl_name),A=wt(e.pl_dens,.3,13,.5),T=wt(e.pl_insol,.01,1e4,.5),v=Ot(e).temperatureK,y=ee(v,z);return{uBaseColor:{value:y},uRingColor:{value:y},uTime:{value:0},uSeed:{value:z},uDensity:{value:A},uInsolation:{value:T},uInnerRadius:{value:2.5},uOuterRadius:{value:4}}},[e]);te((z,A)=>{a.current&&(a.current.rotation.x=M,w?a.current.rotation.y+=A*.02:a.current.rotation.y+=A*c);const T=z.clock.elapsedTime;i.current&&(i.current.uniforms.uTime.value=T),x.current&&(x.current.uniforms.uTime.value=T)});const j=h.useMemo(()=>Vt(e),[e]),F=h.useMemo(()=>Math.PI/2,[]);return t.jsx("group",{position:[0,.2,0],children:t.jsxs("group",{ref:a,children:[t.jsxs("mesh",{ref:s,children:[t.jsx("sphereGeometry",{args:[2,64,64]}),t.jsx("shaderMaterial",{ref:i,vertexShader:ot.get(g),fragmentShader:ot.get(b),uniforms:R})]}),j&&t.jsxs("mesh",{rotation:[F,0,0],children:[t.jsx("ringGeometry",{args:[2.5,4,128,1]}),t.jsx("shaderMaterial",{ref:x,vertexShader:ot.get("ringsVert"),fragmentShader:ot.get("ringsFrag"),uniforms:_,transparent:!0,side:Bt,depthWrite:!1})]})]})})}function ce({planet:e}){return t.jsx(Qt,{camera:{position:[0,0,9],fov:50},style:{background:"transparent"},children:t.jsxs(h.Suspense,{fallback:null,children:[t.jsx("ambientLight",{intensity:.4}),t.jsx("hemisphereLight",{args:["#ffffff","#444444",.4]}),t.jsx("directionalLight",{position:[5,3,5],intensity:1}),t.jsx(ne,{count:2e3}),t.jsx(oe,{planet:e}),t.jsx(ae,{enablePan:!1,enableZoom:!1,autoRotate:!0,autoRotateSpeed:.5})]})})}const de={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};function Ft({rating:e,onChange:a,readonly:s=!1,size:i="md"}){const x=de[i],n=g=>{!s&&a&&a(g)},b=(g,R)=>{!s&&a&&(R.key==="Enter"||R.key===" ")&&(R.preventDefault(),a(g))};return t.jsx("div",{className:`star-rating ${s?"star-rating-readonly":"star-rating-interactive"}`,children:[1,2,3,4,5].map(g=>t.jsx("button",{type:"button",className:`star-rating-star ${e>=g?"filled":"empty"}`,onClick:()=>n(g),onKeyDown:R=>b(g,R),disabled:s,"aria-label":`${g} star${g!==1?"s":""}`,tabIndex:s?-1:0,children:t.jsx("svg",{className:x,fill:e>=g?"#faca15":"#4b5563",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})})},g))})}function pe(e){const a=Date.now(),s=365.25*24*60*60*1e3,i=(a-e)/s;if(i>1e3){const n=Math.round(i);if(n>=1e6)return`~${(n/1e6).toFixed(1)}M years ago`;if(n>=1e3)return`~${(n/1e3).toFixed(1)}k years ago`}return new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"})}function me({review:e}){const a=e.author;return t.jsxs("article",{className:"review-card",children:[t.jsxs("header",{className:"review-header",children:[t.jsx("img",{className:"review-avatar",src:(a==null?void 0:a.avatar)||`https://api.dicebear.com/7.x/bottts-neutral/svg?seed=${e.userid}`,alt:`${(a==null?void 0:a.name)||"Unknown"}'s avatar`}),t.jsxs("div",{className:"review-author-info",children:[t.jsx("span",{className:"review-author-name",children:(a==null?void 0:a.name)||"Unknown Traveler"}),t.jsx("time",{className:"review-date",children:pe(e.date)})]})]}),t.jsxs("div",{className:"review-rating-row",children:[t.jsx(Ft,{rating:e.rate,readonly:!0,size:"sm"}),t.jsx("h3",{className:"review-title",children:e.title})]}),t.jsx("p",{className:"review-text",children:e.text})]})}function he({reviews:e,loading:a}){const{t:s}=O();return a?t.jsxs("div",{className:"reviews-loading",children:[t.jsx("div",{className:"reviews-loading-spinner"}),t.jsx("span",{children:s("common.loading")})]}):e.length===0?t.jsx("div",{className:"reviews-empty",children:t.jsx("p",{children:s("pages.planet.info.reviews.empty")})}):t.jsx("div",{className:"reviews-list",children:e.map(i=>t.jsx(me,{review:i},i.id))})}function xe({user:e,onSubmit:a,onClose:s}){const{t:i}=O(),[x,n]=h.useState(4),[b,g]=h.useState(""),[R,c]=h.useState(""),[M,w]=h.useState(!1),[_,j]=h.useState({}),F=()=>{const T={};return b.trim().length<3&&(T.title=i("pages.planet.info.reviews.form.errorTitleMin")),R.trim().length<10&&(T.text=i("pages.planet.info.reviews.form.errorTextMin")),j(T),Object.keys(T).length===0},z=async T=>{if(T.preventDefault(),!!F()){w(!0);try{await a({rate:x,title:b.trim(),text:R.trim()})}finally{w(!1)}}},A=T=>{T.target===T.currentTarget&&!M&&s()};return t.jsx("div",{className:"review-form-overlay",onClick:A,children:t.jsxs("div",{className:"review-form-modal",children:[t.jsx("button",{className:"review-form-close",onClick:s,disabled:M,"aria-label":"Close",children:"√ó"}),t.jsx("h2",{className:"review-form-title",children:i("pages.planet.info.reviews.form.title")}),t.jsxs("div",{className:"review-form-user",children:[t.jsx("img",{src:e.avatar,alt:e.name,className:"review-form-avatar"}),t.jsx("span",{className:"review-form-username",children:e.name})]}),t.jsxs("form",{onSubmit:z,className:"review-form",children:[t.jsxs("div",{className:"review-form-field",children:[t.jsx("label",{className:"review-form-label",children:i("pages.planet.info.reviews.form.ratingLabel")}),t.jsx(Ft,{rating:x,onChange:n,size:"lg"})]}),t.jsxs("div",{className:"review-form-field",children:[t.jsx("label",{htmlFor:"review-title",className:"review-form-label",children:i("pages.planet.info.reviews.form.titleLabel")}),t.jsx("input",{id:"review-title",type:"text",className:`review-form-input ${_.title?"error":""}`,placeholder:i("pages.planet.info.reviews.form.titlePlaceholder"),value:b,onChange:T=>{g(T.target.value),_.title&&j({..._,title:void 0})},disabled:M,maxLength:100}),_.title&&t.jsx("span",{className:"review-form-error",children:_.title})]}),t.jsxs("div",{className:"review-form-field",children:[t.jsx("label",{htmlFor:"review-text",className:"review-form-label",children:i("pages.planet.info.reviews.form.textLabel")}),t.jsx("textarea",{id:"review-text",className:`review-form-textarea ${_.text?"error":""}`,placeholder:i("pages.planet.info.reviews.form.textPlaceholder"),value:R,onChange:T=>{c(T.target.value),_.text&&j({..._,text:void 0})},disabled:M,rows:4,maxLength:1e3}),_.text&&t.jsx("span",{className:"review-form-error",children:_.text})]}),t.jsx("button",{type:"submit",className:"review-form-submit",disabled:M,children:i(M?"common.loading":"pages.planet.info.reviews.form.submit")})]})]})})}function fe({planetId:e}){const{t:a}=O(),{profile:s,loading:i}=Gt(),[x,n]=h.useState([]),[b,g]=h.useState(!0),[R,c]=h.useState(!1),[M,w]=h.useState(!1),[_,j]=h.useState(null),F=s||_,z=h.useCallback(async()=>{g(!0);try{const y=await jt.getReviews(e);n(y)}finally{g(!1)}},[e]);h.useEffect(()=>{z()},[z]),h.useEffect(()=>{const y=Nt.getUser();y&&j(y)},[]);const A=()=>{F?c(!0):w(!0)},T=y=>{const m=Nt.createUser(y);j(m),w(!1),c(!0)},C=()=>{w(!1),s&&c(!0)},v=async y=>{F&&(await jt.createReview({planet:e,userid:F.uid,rate:y.rate,title:y.title,text:y.text},F),c(!1),await z())};return i?t.jsx("div",{className:"reviews-section",children:t.jsx("div",{className:"reviews-loading",children:"Loading..."})}):t.jsxs("div",{className:"reviews-section",children:[t.jsx("div",{className:"reviews-header",children:t.jsx("button",{className:"reviews-write-button",onClick:A,children:a("pages.planet.info.reviews.writeReview")})}),t.jsx(he,{reviews:x,loading:b}),M&&t.jsx(se,{onSubmit:T,onClose:C}),R&&F&&t.jsx(xe,{user:F,onSubmit:v,onClose:()=>c(!1)})]})}const ue={pl_rade:{value:1,unit:"R‚äï",labelKey:"earthRadius"},pl_bmasse:{value:1,unit:"M‚äï",labelKey:"earthMass"},pl_dens:{value:5.51,unit:"g/cm¬≥",labelKey:"earthDensity"},pl_eqt:{value:255,unit:"K",labelKey:"earthEqTemp"},pl_insol:{value:1,unit:"S‚äï",labelKey:"earthInsolation"},pl_orbper:{value:365.25,unit:"days",labelKey:"earthOrbitalPeriod"},pl_orbsmax:{value:1,unit:"AU",labelKey:"earthSemiMajorAxis"},pl_orbeccen:{value:.017,unit:"",labelKey:"earthOrbitalEccentricity"},st_teff:{value:5778,unit:"K",labelKey:"sunTemperature"},st_met:{value:0,unit:"dex",labelKey:"sunMetallicity"},st_age:{value:4.6,unit:"Gyr",labelKey:"sunAge"}},ge=[{id:"hostname",labelKey:"hostStar",format:e=>e.hostname},{id:"planet_type",labelKey:"planetType",format:(e,a)=>e.planet_type||a},{id:"pl_rade",labelKey:"radius",format:(e,a)=>e.pl_rade?`${e.pl_rade.toFixed(2)} R‚äï`:a,earthRef:"pl_rade"},{id:"pl_bmasse",labelKey:"mass",format:(e,a)=>e.pl_bmasse?`${e.pl_bmasse.toFixed(2)} M‚äï`:a,earthRef:"pl_bmasse"},{id:"pl_dens",labelKey:"density",format:(e,a)=>e.pl_dens?`${e.pl_dens.toFixed(2)} g/cm¬≥`:a,earthRef:"pl_dens"},{id:"pl_insol",labelKey:"insolationFlux",format:(e,a)=>e.pl_insol?`${e.pl_insol.toFixed(2)} S‚äï`:a,earthRef:"pl_insol"},{id:"pl_eqt",labelKey:"eqTemperature",format:(e,a)=>e.pl_eqt?`${e.pl_eqt.toFixed(0)} K`:a,earthRef:"pl_eqt"},{id:"pl_orbper",labelKey:"orbitalPeriod",format:(e,a)=>e.pl_orbper?`${e.pl_orbper.toFixed(2)} days`:a,earthRef:"pl_orbper"},{id:"pl_orbsmax",labelKey:"semiMajorAxis",format:(e,a)=>e.pl_orbsmax?`${e.pl_orbsmax.toFixed(3)} AU`:a,earthRef:"pl_orbsmax"},{id:"pl_orbeccen",labelKey:"orbitalEccentricity",format:(e,a)=>e.pl_orbeccen!==null?e.pl_orbeccen.toFixed(3):a,earthRef:"pl_orbeccen"}],ve=[{id:"st_teff",labelKey:"starTemperature",format:(e,a)=>e.st_teff?`${e.st_teff.toFixed(0)} K`:a,earthRef:"st_teff"},{id:"st_met",labelKey:"starMetallicity",format:(e,a)=>e.st_met!==null?`${e.st_met.toFixed(2)} dex`:a,earthRef:"st_met"},{id:"st_age",labelKey:"starAge",format:(e,a)=>e.st_age?`${e.st_age.toFixed(2)} Gyr`:a,earthRef:"st_age"}],be=[{id:"disc_year",labelKey:"discoveryYear",format:(e,a)=>{var s;return((s=e.disc_year)==null?void 0:s.toString())||a}},{id:"discoverymethod",labelKey:"discoveryMethod",format:(e,a)=>e.discoverymethod||a},{id:"disc_facility",labelKey:"facility",format:(e,a)=>e.disc_facility||a}];function E({flagKey:e,className:a}){const{t:s}=O(),i=s(`pages.planet.info.flags.${e}`),x=s(`pages.planet.info.flagDescriptions.${e}`);return t.jsx("span",{className:`planet-flag ${a}`,title:x,children:i})}function ft({field:e,planet:a}){const{t:s}=O(),i=e.earthRef?ue[e.earthRef]:null,x=s("pages.planet.info.unknown"),n=e.format(a,x),b=s(`pages.planet.info.fields.${e.labelKey}`),g=i?s(`pages.planet.info.earthRef.${i.labelKey}`):null;return t.jsxs("div",{className:"planet-property-row",title:i&&g?`${g}: ${i.value} ${i.unit}`:void 0,children:[t.jsxs("span",{className:"planet-property-label",children:[b,i&&g&&t.jsx("span",{className:"earth-indicator",title:`${g}: ${i.value} ${i.unit}`,children:"üåç"})]}),t.jsx("span",{className:"planet-property-value",children:n})]})}function ye({planet:e}){const{t:a}=O();return t.jsxs("div",{className:"planet-info-container",children:[t.jsx("section",{className:"planet-info-section",children:t.jsxs("div",{className:"planet-flags",children:[e.is_habitable_zone&&t.jsx(E,{flagKey:"habitableZone",className:"flag-habitable"}),e.is_earth_like&&t.jsx(E,{flagKey:"earthLike",className:"flag-earth-like"}),e.is_top_habitable_candidate&&t.jsx(E,{flagKey:"topCandidate",className:"flag-top-candidate"}),e.is_potentially_rocky&&t.jsx(E,{flagKey:"potentiallyRocky",className:"flag-rocky"}),e.has_earth_like_insolation&&t.jsx(E,{flagKey:"earthLikeInsolation",className:"flag-habitable"}),e.is_hot_jupiter&&t.jsx(E,{flagKey:"hotJupiter",className:"flag-hot-jupiter"}),e.is_hot_neptune&&t.jsx(E,{flagKey:"hotNeptune",className:"flag-hot-neptune"}),e.is_ultra_hot&&t.jsx(E,{flagKey:"ultraHot",className:"flag-ultra-hot"}),e.is_frozen_world&&t.jsx(E,{flagKey:"frozenWorld",className:"flag-frozen"}),e.is_ultra_dense&&t.jsx(E,{flagKey:"ultraDense",className:"flag-ultra-dense"}),e.is_puffy&&t.jsx(E,{flagKey:"puffy",className:"flag-puffy"}),e.is_super_massive&&t.jsx(E,{flagKey:"superMassive",className:"flag-super-massive"}),e.is_lightweight&&t.jsx(E,{flagKey:"lightweight",className:"flag-lightweight"}),e.is_ultra_short_period&&t.jsx(E,{flagKey:"ultraShortPeriod",className:"flag-ultra-short"}),e.is_long_period&&t.jsx(E,{flagKey:"longPeriod",className:"flag-long-period"}),e.is_eccentric_orbit&&t.jsx(E,{flagKey:"eccentricOrbit",className:"flag-eccentric"}),e.is_circular_orbit&&t.jsx(E,{flagKey:"circularOrbit",className:"flag-circular"}),e.is_likely_tidally_locked&&t.jsx(E,{flagKey:"tidallyLocked",className:"flag-tidally-locked"}),e.is_circumbinary&&t.jsx(E,{flagKey:"circumbinary",className:"flag-circumbinary"}),e.is_multi_planet_system&&t.jsx(E,{flagKey:"multiPlanet",className:"flag-multi-planet"}),e.is_rich_system&&t.jsx(E,{flagKey:"richSystem",className:"flag-rich-system"}),e.is_multi_star_system&&t.jsx(E,{flagKey:"multiStar",className:"flag-multi-star"}),e.is_very_nearby&&t.jsx(E,{flagKey:"veryNearby",className:"flag-very-nearby"}),e.is_nearby&&!e.is_very_nearby&&t.jsx(E,{flagKey:"nearby",className:"flag-nearby"}),e.is_solar_analog&&t.jsx(E,{flagKey:"solarAnalog",className:"flag-solar-analog"}),e.is_red_dwarf_host&&t.jsx(E,{flagKey:"redDwarfHost",className:"flag-red-dwarf"}),e.is_young_system&&t.jsx(E,{flagKey:"youngSystem",className:"flag-young"}),e.is_ancient_system&&t.jsx(E,{flagKey:"ancientSystem",className:"flag-ancient"}),e.is_metal_rich_star&&t.jsx(E,{flagKey:"metalRich",className:"flag-metal-rich"}),e.is_metal_poor_star&&t.jsx(E,{flagKey:"metalPoor",className:"flag-metal-poor"}),e.is_transiting&&t.jsx(E,{flagKey:"transiting",className:"flag-transiting"}),e.has_rv_data&&t.jsx(E,{flagKey:"hasRvData",className:"flag-rv"}),e.has_ttv&&t.jsx(E,{flagKey:"hasTtv",className:"flag-ttv"}),e.is_controversial&&t.jsx(E,{flagKey:"controversial",className:"flag-controversial"})]})}),t.jsxs("section",{className:"planet-info-section",children:[t.jsx("h2",{className:"planet-info-section-title",children:a("pages.planet.info.sections.properties")}),t.jsx("p",{className:"earth-comparison-hint",children:a("pages.planet.info.earthComparison")}),t.jsx("div",{className:"planet-properties-table",children:ge.map(s=>t.jsx(ft,{field:s,planet:e},s.id))})]}),t.jsxs("section",{className:"planet-info-section",children:[t.jsx("h2",{className:"planet-info-section-title",children:a("pages.planet.info.sections.hostStar")}),t.jsx("div",{className:"planet-properties-table",children:ve.map(s=>t.jsx(ft,{field:s,planet:e},s.id))})]}),t.jsxs("section",{className:"planet-info-section",children:[t.jsx("h2",{className:"planet-info-section-title",children:a("pages.planet.info.sections.discovery")}),t.jsx("div",{className:"planet-properties-table",children:be.map(s=>t.jsx(ft,{field:s,planet:e},s.id))})]}),t.jsxs("section",{className:"planet-info-section",children:[t.jsx("h2",{className:"planet-info-section-title",children:a("pages.planet.info.sections.reviews")}),t.jsx(fe,{planetId:vt(e.pl_name)})]})]})}const ut={"Sub-Earth":"#a0a0a0","Earth-sized":"#4a90d9","Super-Earth":"#6bb86b","Sub-Neptune":"#7ec8e3","Neptune-like":"#4169e1","Gas Giant":"#d4a574",unknown:"#888888"};function Ct(e){return e?ut[e]??ut.unknown:ut.unknown}function je(e){return e.is_habitable_zone?"#00ff88":e.is_earth_like?"#4a90d9":Ct(e.planet_type??null)}function Ne(e){const a=tt.COMPARISON_MAX_SIZE,s=tt.COMPARISON_MIN_SIZE,i=tt.COMPARISON_MAX_RADIUS_FACTOR,x=e>=1?a/Math.min(e,i):a,n=e>=1?a:a*e,b=Math.max(x,s),g=Math.max(n,s);return{earthDisplaySize:b,planetDisplaySize:g}}function _e(e){return`radial-gradient(circle at 30% 30%, #fff, ${e}, ${e}dd)`}const Z={radius:tt.EARTH_RADIUS_RELATIVE,mass:tt.EARTH_MASS_RELATIVE,density:tt.EARTH_DENSITY,temperature:tt.EARTH_EQUILIBRIUM_TEMP},ke="radial-gradient(circle at 30% 30%, #87ceeb, #4a90d9, #1e4d7b)";function we({planet:e}){const{t:a}=O(),s=e.pl_rade||1,i=e.pl_bmasse||null,x=e.pl_dens||null,n=e.pl_eqt||null,{earthDisplaySize:b,planetDisplaySize:g}=Ne(s),R=Ut(i,s),c=(R==null?void 0:R.gravityEarth)??null,M=Ct(e.planet_type),w=[{key:"radius",label:a("pages.planet.comparison.radius"),earthValue:`${Z.radius.toFixed(1)} R‚äï`,planetValue:e.pl_rade?`${e.pl_rade.toFixed(2)} R‚äï`:"‚Äî",ratio:e.pl_rade?e.pl_rade/Z.radius:null},{key:"mass",label:a("pages.planet.comparison.mass"),earthValue:`${Z.mass.toFixed(1)} M‚äï`,planetValue:i?`${i.toFixed(2)} M‚äï`:"‚Äî",ratio:i?i/Z.mass:null},{key:"density",label:a("pages.planet.comparison.density"),earthValue:`${Z.density.toFixed(2)} g/cm¬≥`,planetValue:x?`${x.toFixed(2)} g/cm¬≥`:"‚Äî",ratio:x?x/Z.density:null},{key:"gravity",label:a("pages.planet.comparison.gravity"),earthValue:"1.0 g",planetValue:c?`${c.toFixed(2)} g`:"‚Äî",ratio:c},{key:"temperature",label:a("pages.planet.comparison.temperature"),earthValue:`${Z.temperature} K`,planetValue:n?`${n.toFixed(0)} K`:"‚Äî",ratio:n?n/Z.temperature:null}],_=j=>j===null?"":j>1?a("pages.planet.comparison.timesLarger",{times:j.toFixed(1)}):j<1?a("pages.planet.comparison.timesSmaller",{times:(1/j).toFixed(1)}):a("pages.planet.comparison.similar");return t.jsxs("div",{className:"planet-earth-comparison",children:[t.jsxs("div",{className:"comparison-visual",children:[t.jsxs("div",{className:"comparison-body",children:[t.jsx("div",{className:"comparison-sphere earth",style:{width:b,height:b,background:ke},children:t.jsx("div",{className:"sphere-highlight"})}),t.jsx("span",{className:"comparison-label",children:a("pages.planet.comparison.earth")}),t.jsx("span",{className:"comparison-stats",children:"1.0 R‚äï ‚Ä¢ 1.0 M‚äï"})]}),t.jsx("div",{className:"comparison-vs",children:"vs"}),t.jsxs("div",{className:"comparison-body",children:[t.jsx("div",{className:"comparison-sphere planet",style:{width:g,height:g,background:_e(M)},children:t.jsx("div",{className:"sphere-highlight"})}),t.jsx("span",{className:"comparison-label",children:e.pl_name}),t.jsxs("span",{className:"comparison-stats",children:[e.pl_rade?`${e.pl_rade.toFixed(2)} R‚äï`:"‚Äî"," ‚Ä¢ ",i?`${i.toFixed(1)} M‚äï`:"‚Äî"]})]})]}),t.jsx("div",{className:"comparison-summary",children:s>1?t.jsx("p",{children:a("pages.planet.comparison.largerThanEarth",{times:s.toFixed(1)})}):s<1?t.jsx("p",{children:a("pages.planet.comparison.smallerThanEarth",{pct:((1-s)*100).toFixed(0)})}):t.jsx("p",{children:a("pages.planet.comparison.similarToEarth")})}),t.jsx("div",{className:"comparison-metrics",children:w.map(j=>t.jsxs("div",{className:"comparison-metric-row",children:[t.jsx("span",{className:"metric-label",children:j.label}),t.jsx("span",{className:"metric-earth",children:j.earthValue}),t.jsx("span",{className:"metric-planet",children:j.planetValue}),t.jsx("span",{className:"metric-ratio",children:_(j.ratio)})]},j.key))})]})}function Re(e){let a=0;if(e.pl_eqt){const n=e.pl_eqt;if(n>=200&&n<=320){const b=Math.abs(n-255);a=Math.max(0,40-b*.5)}else n<200?a=Math.max(0,20-(200-n)*.2):a=Math.max(0,20-(n-320)*.1)}let s=0;if(e.pl_rade){const n=e.pl_rade;n>=.8&&n<=1.5?s=30:n>=.5&&n<=2?s=25:n>=.3&&n<=2.5?s=15:n<=4?s=8:s=2}let i=0;switch(e.star_class){case"G":i=20;break;case"K":i=18;break;case"F":i=15;break;case"M":i=12;break;case"A":i=8;break;default:i=5}let x=0;if(e.pl_insol){const n=e.pl_insol;n>=.5&&n<=2?x=10:n>=.25&&n<=4?x=6:x=2}return{temperature:Math.round(a),size:Math.round(s),starType:i,insolation:x}}function Se(e){return e>=80?"#00ff88":e>=60?"#88ff00":e>=40?"#ffcc00":e>=20?"#ff8800":"#ff4444"}function Me(e,a){return e>=80?"excellent":e>=60?"good":e>=40?"moderate":e>=20?"low":"minimal"}function Te({planet:e}){const{t:a}=O(),s=e.habitability_score||0,i=h.useMemo(()=>Re(e),[e]),x=Se(s),n=Me(s),b=160,g=12,R=(b-g)/2,c=2*Math.PI*R,M=s/100*c,w=c-M,_=[{key:"temperature",label:a("pages.planet.habitability.temperature"),value:i.temperature,max:40,color:"#ff6b6b"},{key:"size",label:a("pages.planet.habitability.size"),value:i.size,max:30,color:"#4ecdc4"},{key:"starType",label:a("pages.planet.habitability.starType"),value:i.starType,max:20,color:"#ffe66d"},{key:"insolation",label:a("pages.planet.habitability.insolation"),value:i.insolation,max:10,color:"#a8e6cf"}];return t.jsxs("div",{className:"habitability-gauge",children:[t.jsxs("div",{className:"gauge-container",children:[t.jsxs("svg",{className:"gauge-svg",width:b,height:b,viewBox:`0 0 ${b} ${b}`,children:[t.jsx("circle",{className:"gauge-background",cx:b/2,cy:b/2,r:R,fill:"none",stroke:"rgba(255, 255, 255, 0.1)",strokeWidth:g}),t.jsx("circle",{className:"gauge-progress",cx:b/2,cy:b/2,r:R,fill:"none",stroke:x,strokeWidth:g,strokeLinecap:"round",strokeDasharray:c,strokeDashoffset:w,transform:`rotate(-90 ${b/2} ${b/2})`,style:{transition:"stroke-dashoffset 1s ease-out, stroke 0.3s ease",filter:`drop-shadow(0 0 6px ${x}80)`}})]}),t.jsxs("div",{className:"gauge-center",children:[t.jsx("span",{className:"gauge-score",style:{color:x},children:s.toFixed(0)}),t.jsx("span",{className:"gauge-label",children:"/100"})]})]}),t.jsx("div",{className:"gauge-tier",style:{color:x},children:a(`pages.planet.habitability.tiers.${n}`)}),t.jsxs("div",{className:"habitability-breakdown",children:[t.jsx("h4",{className:"breakdown-title",children:a("pages.planet.habitability.breakdown")}),_.map(j=>t.jsxs("div",{className:"breakdown-item",children:[t.jsxs("div",{className:"breakdown-header",children:[t.jsx("span",{className:"breakdown-label",children:j.label}),t.jsxs("span",{className:"breakdown-value",children:[j.value,"/",j.max]})]}),t.jsx("div",{className:"breakdown-bar-track",children:t.jsx("div",{className:"breakdown-bar-fill",style:{width:`${j.value/j.max*100}%`,backgroundColor:j.color}})})]},j.key))]}),t.jsxs("div",{className:"habitability-indicators",children:[e.is_habitable_zone&&t.jsxs("span",{className:"indicator positive",children:["‚úì ",a("pages.planet.habitability.inHabitableZone")]}),e.is_earth_like&&t.jsxs("span",{className:"indicator positive",children:["‚úì ",a("pages.planet.habitability.earthLikeSize")]}),e.is_potentially_rocky&&t.jsxs("span",{className:"indicator positive",children:["‚úì ",a("pages.planet.habitability.potentiallyRocky")]}),e.is_top_habitable_candidate&&t.jsxs("span",{className:"indicator highlight",children:["‚òÖ ",a("pages.planet.habitability.topCandidate")]})]})]})}const J={SCORCHING:1500,HOT:500,WARM:320,HABITABLE_UPPER:320,HABITABLE_LOWER:200,COLD:150,FROZEN:100},et={VENUS:737,EARTH:255,MARS:210};function Ae(e){return e===null?{zone:"unknown",color:"#666666",description:"Temperature unknown"}:e>J.SCORCHING?{zone:"scorching",color:"#ff2200",description:"Extreme heat - metals may vaporize"}:e>J.HOT?{zone:"hot",color:"#ff6600",description:"Very hot - surface would be molten"}:e>J.WARM?{zone:"warm",color:"#ffaa00",description:"Too warm for liquid water"}:e>=J.HABITABLE_LOWER?{zone:"habitable",color:"#00ff88",description:"Potential for liquid water"}:e>=J.COLD?{zone:"cool",color:"#00ccff",description:"Cool - water would be frozen"}:e>=J.FROZEN?{zone:"cold",color:"#0088ff",description:"Cold - likely frozen surface"}:{zone:"frozen",color:"#4444ff",description:"Extreme cold - cryogenic conditions"}}function at(e){const i=Math.max(50,Math.min(2e3,e)),x=Math.log(50),n=Math.log(2e3);return(Math.log(i)-x)/(n-x)*100}function ze({planet:e}){const{t:a}=O(),s=e.pl_eqt,i=s?null:Wt(e.st_teff??null,e.st_rad??null,e.pl_orbsmax??null),x=s||(i==null?void 0:i.temperatureK)||null,n=!s&&i!==null,b=Ae(x),g=x?at(x):50,R=[{name:"Venus",temp:et.VENUS,position:at(et.VENUS),emoji:"ü™ê"},{name:"Earth",temp:et.EARTH,position:at(et.EARTH),emoji:"üåç"},{name:"Mars",temp:et.MARS,position:at(et.MARS),emoji:"üî¥"}],c=at(J.HABITABLE_LOWER),M=at(J.HABITABLE_UPPER);return t.jsxs("div",{className:"temperature-zone-indicator",children:[t.jsx("h4",{className:"temp-zone-title",children:a("pages.planet.temperature.title")}),t.jsx("div",{className:"temp-value-display",children:x?t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"temp-value",style:{color:b.color},children:[x.toFixed(0)," K"]}),t.jsxs("span",{className:"temp-celsius",children:["(",(x-273.15).toFixed(0),"¬∞C)"]}),n&&t.jsxs("span",{className:"temp-approximate",title:"Calculated using Stefan-Boltzmann law from stellar and orbital parameters",children:[" ","~"]})]}):t.jsx("span",{className:"temp-unknown",children:a("pages.planet.temperature.unknown")})}),t.jsx("div",{className:"temp-zone-label",style:{color:b.color},children:a(`pages.planet.temperature.zones.${b.zone}`)}),t.jsxs("div",{className:"temp-scale-container",children:[t.jsxs("div",{className:"temp-scale-bar",children:[t.jsx("div",{className:"temp-habitable-zone",style:{left:`${c}%`,width:`${M-c}%`}}),t.jsx("div",{className:"temp-scale-gradient"}),R.map(w=>t.jsxs("div",{className:"temp-reference-marker",style:{left:`${w.position}%`},title:`${w.name}: ${w.temp}K`,children:[t.jsx("span",{className:"reference-emoji",children:w.emoji}),t.jsx("span",{className:"reference-line"})]},w.name)),x&&t.jsxs("div",{className:"temp-planet-marker",style:{left:`${g}%`,borderColor:b.color},children:[t.jsx("div",{className:"marker-dot",style:{backgroundColor:b.color}}),t.jsx("div",{className:"marker-label",children:e.pl_letter||"‚óè"})]})]}),t.jsxs("div",{className:"temp-scale-labels",children:[t.jsx("span",{className:"scale-label cold",children:a("pages.planet.temperature.frozen")}),t.jsx("span",{className:"scale-label habitable",children:a("pages.planet.temperature.habitable")}),t.jsx("span",{className:"scale-label hot",children:a("pages.planet.temperature.scorching")})]})]}),t.jsx("p",{className:"temp-zone-description",children:a(`pages.planet.temperature.descriptions.${b.zone}`)}),n&&t.jsx("p",{className:"temp-approximation-notice",children:"‚ìò Temperature estimated using Stefan-Boltzmann law (T = T‚òÖ √ó ‚àö(R‚òÖ/2a)) from stellar temperature, radius, and orbital distance. NASA data not available."}),t.jsxs("div",{className:"temp-legend",children:[t.jsxs("div",{className:"legend-item",children:[t.jsx("span",{className:"legend-marker earth",children:"üåç"}),t.jsx("span",{className:"legend-text",children:"Earth (255K)"})]}),t.jsxs("div",{className:"legend-item",children:[t.jsx("span",{className:"legend-marker habitable-zone"}),t.jsx("span",{className:"legend-text",children:a("pages.planet.temperature.habitableZone")})]})]})]})}function Ee({planet:e,siblings:a}){var n;const{t:s}=O(),i=h.useRef(null),x=h.useRef(null);return h.useEffect(()=>{if(!i.current||!x.current)return;const b=x.current.clientWidth,g=Math.min(b,350),R=40,c=(g-R*2)/2,M=g/2,w=g/2,_=B(i.current);_.selectAll("*").remove(),_.attr("width",g).attr("height",g);const F=(a.length>0?a:[e]).filter(r=>r.pl_orbsmax&&r.pl_orbsmax>0).map(r=>({name:r.pl_name.split(" ").pop()||r.pl_name,fullName:r.pl_name,semiMajorAxis:r.pl_orbsmax,eccentricity:r.pl_orbeccen||0,habitable:r.is_habitable_zone||!1,isCurrent:r.pl_name===e.pl_name,color:je(r),planetType:r.planet_type})).sort((r,l)=>r.semiMajorAxis-l.semiMajorAxis);if(F.length===0)return;const z=Math.max(...F.map(r=>r.semiMajorAxis)),A=Yt(e.st_lum),T=Math.max(z*1.3,A.outer*1.2),C=c/T;_.append("circle").attr("cx",M).attr("cy",w).attr("r",c+R/2).attr("fill","rgba(0, 0, 0, 0.3)");const v=A.inner*C,y=A.outer*C;y>0&&y<=c+20&&(_.append("circle").attr("cx",M).attr("cy",w).attr("r",Math.min(y,c)).attr("fill","rgba(0, 255, 136, 0.1)").attr("stroke","rgba(0, 255, 136, 0.3)").attr("stroke-width",1),v>0&&_.append("circle").attr("cx",M).attr("cy",w).attr("r",v).attr("fill","rgba(0, 0, 0, 0.3)").attr("stroke","rgba(0, 255, 136, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","4,4")),[.1,.5,1,2,5,10,20,50].filter(r=>r*C<c&&r<T).forEach(r=>{_.append("circle").attr("cx",M).attr("cy",w).attr("r",r*C).attr("fill","none").attr("stroke","rgba(255, 255, 255, 0.1)").attr("stroke-width",.5),_.append("text").attr("x",M+r*C+3).attr("y",w-3).attr("fill","rgba(255, 255, 255, 0.3)").attr("font-size","8px").text(`${r} AU`)}),_.append("circle").attr("cx",M).attr("cy",w).attr("r",10).attr("fill","#ffcc00").attr("filter","drop-shadow(0 0 10px rgba(255, 200, 0, 0.5))"),F.forEach((r,l)=>{const f=r.semiMajorAxis*C,p=l/F.length*Math.PI*2-Math.PI/2,S=M+Math.cos(p)*f,d=w+Math.sin(p)*f;_.append("circle").attr("cx",M).attr("cy",w).attr("r",f).attr("fill","none").attr("stroke",r.isCurrent?"rgba(255, 255, 255, 0.6)":r.habitable?"rgba(0, 255, 136, 0.4)":"rgba(0, 204, 255, 0.2)").attr("stroke-width",r.isCurrent?2:1).attr("stroke-dasharray",r.isCurrent?"none":"4,4");const o=r.isCurrent?10:6;_.append("circle").attr("cx",S).attr("cy",d).attr("r",o).attr("fill",r.color).attr("stroke",r.isCurrent?"#fff":"rgba(255,255,255,0.5)").attr("stroke-width",r.isCurrent?2:1).attr("filter",r.isCurrent?"drop-shadow(0 0 8px rgba(255,255,255,0.5))":"none"),_.append("text").attr("x",S).attr("y",d-o-5).attr("text-anchor","middle").attr("fill",r.isCurrent?"#fff":"rgba(255, 255, 255, 0.7)").attr("font-size",r.isCurrent?"11px":"9px").attr("font-weight",r.isCurrent?"bold":"normal").text(r.name)})},[e,a]),e.pl_orbsmax?t.jsxs("div",{className:"orbital-position-container",children:[t.jsx("h4",{className:"orbital-title",children:s("pages.planet.orbital.title")}),t.jsx("div",{ref:x,className:"orbital-chart",children:t.jsx("svg",{ref:i})}),t.jsxs("div",{className:"orbital-legend",children:[t.jsxs("div",{className:"orbital-legend-item",children:[t.jsx("div",{className:"orbital-legend-dot star"}),t.jsx("span",{children:e.hostname})]}),t.jsxs("div",{className:"orbital-legend-item",children:[t.jsx("div",{className:"orbital-legend-dot current"}),t.jsx("span",{children:e.pl_name})]}),t.jsxs("div",{className:"orbital-legend-item",children:[t.jsx("div",{className:"orbital-legend-dot hz"}),t.jsx("span",{children:s("pages.planet.orbital.habitableZone")})]})]}),t.jsxs("div",{className:"orbital-info",children:[t.jsxs("div",{className:"orbital-info-item",children:[t.jsx("span",{className:"info-label",children:s("pages.planet.orbital.distance")}),t.jsxs("span",{className:"info-value",children:[(n=e.pl_orbsmax)==null?void 0:n.toFixed(3)," AU"]})]}),e.pl_orbper&&t.jsxs("div",{className:"orbital-info-item",children:[t.jsx("span",{className:"info-label",children:s("pages.planet.orbital.period")}),t.jsx("span",{className:"info-value",children:e.pl_orbper<365?`${e.pl_orbper.toFixed(1)} days`:`${(e.pl_orbper/365.25).toFixed(2)} years`})]}),e.pl_orbeccen!==null&&t.jsxs("div",{className:"orbital-info-item",children:[t.jsx("span",{className:"info-label",children:s("pages.planet.orbital.eccentricity")}),t.jsx("span",{className:"info-value",children:e.pl_orbeccen.toFixed(3)})]})]})]}):t.jsx("div",{className:"orbital-position-container",children:t.jsx("div",{className:"orbital-no-data",children:s("pages.planet.orbital.noData")})})}function Fe(e,a){return e.is_earth_like&&e.is_habitable_zone?a("pages.planet.siblings.earthLikeHabitable"):e.is_habitable_zone?a("pages.planet.siblings.habitable"):e.is_hot_jupiter?a("pages.planet.siblings.hotJupiter"):e.is_frozen_world?a("pages.planet.siblings.frozen"):e.planet_type||a("pages.planet.siblings.exoplanet")}function Ce({currentPlanet:e,siblings:a}){const{t:s}=O(),i=a.filter(n=>n.pl_name!==e.pl_name);if(i.length===0)return null;const x=[...i].sort((n,b)=>(n.pl_orbsmax||999)-(b.pl_orbsmax||999));return t.jsxs("div",{className:"sibling-planets-section",children:[t.jsx("h3",{className:"sibling-planets-title",children:s("pages.planet.siblings.title",{system:e.hostname})}),t.jsx("p",{className:"sibling-planets-subtitle",children:s("pages.planet.siblings.count",{count:i.length})}),t.jsx("div",{className:"sibling-planets-grid",children:x.map(n=>t.jsxs(gt,{to:`/planets/${vt(n.pl_name)}`,className:"sibling-planet-card",children:[t.jsx("div",{className:"sibling-thumbnail",children:t.jsx(qt,{planet:n,size:64})}),t.jsxs("div",{className:"sibling-info",children:[t.jsx("span",{className:"sibling-name",children:n.pl_name.replace(e.hostname,"").trim()||n.pl_letter||n.pl_name}),t.jsx("span",{className:"sibling-type",children:Fe(n,s)})]}),t.jsxs("div",{className:"sibling-stats",children:[n.pl_rade&&t.jsxs("div",{className:"sibling-stat",children:[t.jsx("span",{className:"stat-value",children:n.pl_rade.toFixed(1)}),t.jsx("span",{className:"stat-unit",children:"R‚äï"})]}),n.pl_eqt&&t.jsxs("div",{className:"sibling-stat",children:[t.jsx("span",{className:"stat-value",children:n.pl_eqt.toFixed(0)}),t.jsx("span",{className:"stat-unit",children:"K"})]}),n.pl_orbsmax&&t.jsxs("div",{className:"sibling-stat",children:[t.jsx("span",{className:"stat-value",children:n.pl_orbsmax.toFixed(2)}),t.jsx("span",{className:"stat-unit",children:"AU"})]})]}),t.jsxs("div",{className:"sibling-badges",children:[n.is_habitable_zone&&t.jsx("span",{className:"sibling-badge habitable",children:"HZ"}),n.is_earth_like&&t.jsx("span",{className:"sibling-badge earth-like",children:"üåç"}),n.is_hot_jupiter&&t.jsx("span",{className:"sibling-badge hot",children:"üî•"})]})]},n.pl_name))})]})}function $e(e,a=1){const s=e.pl_rvamp,i=e.pl_orbper,x=(e.st_radv||0)*1e3,n=[],b=Math.floor(a*100);for(let g=0;g<=b;g++){const R=g/100*2*Math.PI,c=g/100*i,M=x+s*Math.sin(R);n.push({time:c,velocity:M,phase:R})}return n}function Ke(e){if(e==null||isNaN(e))return"N/A";const a=Number(e);return Math.abs(a)<1?`${(a*1e3).toFixed(0)} cm/s`:`${a.toFixed(2)} m/s`}function Pe({planet:e,siblings:a=[]}){const{t:s}=O(),[i,x]=h.useState(null),[n,b]=h.useState(0),g=h.useRef(null),R=h.useRef(null),c=h.useRef(null),M=h.useRef(null),w=h.useRef(null),_=h.useRef(null),j=h.useRef(null),F=h.useRef(null),z=h.useRef(null),A=h.useRef(null),T=h.useRef(),C=e.pl_rvamp!==null&&e.pl_orbper!==null;if(h.useEffect(()=>{if(!C)return;const m=15,r=.01,l=m/e.pl_orbper,f=r*Math.min(Math.max(l,.2),8),p=()=>{b(S=>(S+f)%(Math.PI*2)),T.current=requestAnimationFrame(p)};return T.current=requestAnimationFrame(p),()=>{T.current&&cancelAnimationFrame(T.current)}},[C,e.pl_orbper]),h.useEffect(()=>{if(!C||!g.current||!R.current)return;const m=R.current.clientWidth,r=Math.min(m-20,1200),l=380,f={top:20,right:30,bottom:80,left:70},p=B(g.current);p.selectAll("*").remove(),p.attr("width",r).attr("height",l);const S=$e(e),d=pt().domain([0,dt(S,P=>P.time)]).range([f.left,r-f.right]),o=pt().domain([re(S,P=>P.velocity)-e.pl_rvamp*.2,dt(S,P=>P.velocity)+e.pl_rvamp*.2]).range([l-f.bottom,f.top]),u=At().x(P=>d(P.time)).y(P=>o(P.velocity)).curve(xt);p.append("rect").attr("width",r).attr("height",l).attr("fill","rgba(0, 0, 0, 0.2)"),p.append("g").attr("class","grid").attr("transform",`translate(0,${l-f.bottom})`).call(st(d).ticks(5).tickSize(-280).tickFormat(()=>"")).selectAll("line").attr("stroke","rgba(255, 255, 255, 0.05)"),p.append("g").attr("class","grid").attr("transform",`translate(${f.left},0)`).call(rt(o).ticks(5).tickSize(-(r-f.left-f.right)).tickFormat(()=>"")).selectAll("line").attr("stroke","rgba(255, 255, 255, 0.05)");const N=e.pl_rvamp,K=e.pl_orbper,k=(e.st_radv||0)*1e3;p.append("line").attr("x1",f.left).attr("x2",r-f.right).attr("y1",o(k)).attr("y2",o(k)).attr("stroke","rgba(255, 255, 255, 0.3)").attr("stroke-width",2).attr("stroke-dasharray","5,5");const $=_t().x(P=>d(P.time)).y0(o(k)).y1(P=>o(Math.max(P.velocity,k))).curve(xt);p.append("path").datum(S).attr("d",$).attr("fill","rgba(255, 100, 100, 0.15)").attr("opacity",.8);const V=_t().x(P=>d(P.time)).y0(o(k)).y1(P=>o(Math.min(P.velocity,k))).curve(xt);p.append("path").datum(S).attr("d",V).attr("fill","rgba(100, 150, 255, 0.15)").attr("opacity",.8),p.append("path").datum(S).attr("id","rv-curve-path").attr("d",u).attr("fill","none").attr("stroke","#00ccff").attr("stroke-width",2).attr("opacity",.9);const D=16,G=f.left,I=l-f.bottom+10;p.append("rect").attr("x",G-5).attr("y",I-5).attr("width",280).attr("height",D+10).attr("fill","rgba(0, 0, 0, 0.6)").attr("stroke","rgba(255, 255, 255, 0.3)").attr("stroke-width",1).attr("rx",4),p.append("rect").attr("x",G).attr("y",I).attr("width",20).attr("height",12).attr("fill","rgba(255, 100, 100, 0.4)"),p.append("text").attr("x",G+25).attr("y",I+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Redshift (away)");const H=G+120;p.append("rect").attr("x",H).attr("y",I).attr("width",20).attr("height",12).attr("fill","rgba(100, 150, 255, 0.4)"),p.append("text").attr("x",H+25).attr("y",I+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Blueshift (toward)");const U=G+240;p.append("line").attr("x1",U).attr("x2",U+20).attr("y1",I+6).attr("y2",I+6).attr("stroke","rgba(255, 255, 255, 0.5)").attr("stroke-width",2).attr("stroke-dasharray","4,2"),p.append("text").attr("x",U+25).attr("y",I+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Baseline"),p.append("circle").attr("cx",0).attr("cy",0).attr("r",6).attr("fill","#ff6b6b").attr("stroke","#fff").attr("stroke-width",2).attr("class","rv-animated-marker");const W=p.append("g").attr("transform",`translate(0,${l-f.bottom})`).call(st(d).ticks(5));W.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),W.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)"),p.append("text").attr("x",r/2).attr("y",l-5).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","12px").text(s("pages.planet.rv.xAxisLabel"));const X=p.append("g").attr("transform",`translate(${f.left},0)`).call(rt(o).ticks(5).tickFormat(P=>`${P}`));X.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),X.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)"),p.append("text").attr("transform","rotate(-90)").attr("x",-190).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","12px").text(s("pages.planet.rv.yAxisLabel"));const Q=n/(Math.PI*2)*K,it=k+N*Math.sin(n);p.select(".rv-animated-marker").attr("cx",d(Q)).attr("cy",o(it))},[n,C,e,s]),h.useEffect(()=>{if(!C||!w.current||!_.current)return;const m=250,r=m/2,l=m/2,f=m/2-20,p=B(w.current);p.selectAll("*").remove(),p.attr("width",m).attr("height",m),p.append("rect").attr("width",m).attr("height",m).attr("fill","rgba(0, 0, 0, 0.3)");const S=f*.7,d=f*.15,o=r+Math.cos(n)*S,u=l+Math.sin(n)*S,N=r-Math.cos(n)*d,K=l-Math.sin(n)*d;p.append("circle").attr("cx",r).attr("cy",l).attr("r",S).attr("fill","none").attr("stroke","rgba(255, 255, 255, 0.2)").attr("stroke-width",1).attr("stroke-dasharray","4,4"),p.append("circle").attr("cx",r).attr("cy",l).attr("r",d).attr("fill","none").attr("stroke","rgba(255, 200, 0, 0.3)").attr("stroke-width",1).attr("stroke-dasharray","2,2");const k=90,$=k*Math.PI/180,V=Math.cos($),D=Math.sin($),I=-(Math.cos(n)*V+Math.sin(n)*D);let H;if(I>.05){const L=Math.abs(I);H=`rgba(0, ${Math.floor(150+L*105)}, 255, ${.4+L*.3})`}else if(I<-.05){const L=Math.abs(I),lt=255,bt=Math.floor(200-L*200);H=`rgba(${lt}, ${bt}, 0, ${.4+L*.3})`}else H="rgba(255, 255, 200, 0.25)";const U=40,W=60,X=(k-U/2)*Math.PI/180,Q=(k+U/2)*Math.PI/180,it=`${N+Math.cos(X)*W},${K+Math.sin(X)*W}`,P=`${N+Math.cos(Q)*W},${K+Math.sin(Q)*W}`;p.append("path").attr("d",`M ${N},${K} L ${it} L ${P} Z`).attr("fill",H).attr("opacity",.6),p.append("circle").attr("cx",N).attr("cy",K).attr("r",15).attr("fill","#ffcc00").attr("filter","drop-shadow(0 0 8px rgba(255, 200, 0, 0.6))"),p.append("circle").attr("cx",o).attr("cy",u).attr("r",8).attr("fill","#00ccff").attr("stroke","#fff").attr("stroke-width",1),p.append("circle").attr("cx",r).attr("cy",l).attr("r",3).attr("fill","#ff6b6b").attr("opacity",.5),p.append("text").attr("x",m/2).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","11px").text("Orbital Motion")},[n,C]),h.useEffect(()=>{if(!C||!j.current||!F.current)return;const m=250,r=80,l=r/2,f=180,p=B(j.current);p.selectAll("*").remove(),p.attr("width",m).attr("height",r),p.append("rect").attr("width",m).attr("height",r).attr("fill","rgba(0, 0, 0, 0.3)"),p.append("line").attr("x1",35).attr("x2",35+f).attr("y1",l).attr("y2",l).attr("stroke","rgba(255, 255, 255, 0.3)").attr("stroke-width",2);const S=35+f/2+Math.cos(n)*8,d=35+f/2+Math.cos(n)*60;p.append("circle").attr("cx",S).attr("cy",l).attr("r",12).attr("fill","#ffcc00").attr("filter","drop-shadow(0 0 6px rgba(255, 200, 0, 0.5))"),p.append("circle").attr("cx",d).attr("cy",l).attr("r",6).attr("fill","#00ccff").attr("stroke","#fff").attr("stroke-width",1),p.append("text").attr("x",m/2).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","11px").text("Side View")},[n,C]),h.useEffect(()=>{if(!C||!z.current||!A.current)return;const m=Math.min(A.current.clientWidth,600),r=B(z.current);r.selectAll("*").remove(),r.attr("width",m).attr("height",380),r.append("rect").attr("width",m).attr("height",380).attr("fill","rgba(0, 0, 0, 0.3)");const l=r.append("defs").append("linearGradient").attr("id","spectrum-gradient").attr("x1","0%").attr("x2","100%");l.append("stop").attr("offset","0%").attr("stop-color","#4169e1"),l.append("stop").attr("offset","25%").attr("stop-color","#00bfff"),l.append("stop").attr("offset","50%").attr("stop-color","#90ee90"),l.append("stop").attr("offset","75%").attr("stop-color","#ffff00"),l.append("stop").attr("offset","100%").attr("stop-color","#ff4500"),r.append("rect").attr("x",20).attr("y",20).attr("width",m-40).attr("height",40).attr("fill","url(#spectrum-gradient)");const f=e.pl_rvamp,p=f*Math.sin(n),d=p/f*20;[{pos:.05,label:"Ca K"},{pos:.08,label:"Ca H"},{pos:.25,label:"H-Œ¥"},{pos:.35,label:"H-Œ≥"},{pos:.45,label:"H-Œ≤"},{pos:.55,label:"Mg"},{pos:.59,label:"Na D"},{pos:.61,label:"Na D"},{pos:.75,label:"H-Œ±"},{pos:.88,label:"Ca II"}].forEach(($,V)=>{const D=20+(m-40)*$.pos;r.append("line").attr("x1",D).attr("x2",D).attr("y1",10).attr("y2",70).attr("stroke","#000").attr("stroke-width",1).attr("stroke-dasharray","3,3").attr("opacity",.6),r.append("line").attr("x1",D+d).attr("x2",D+d).attr("y1",20).attr("y2",60).attr("stroke","#000").attr("stroke-width",3).attr("opacity",.9);const G=80+V%3*10;r.append("text").attr("x",D).attr("y",G).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.6)").attr("font-size",m<500?"6px":"8px").text($.label)});const u=Math.abs(p)>.1?`${p>0?"Redshift":"Blueshift"} (${Math.abs(p).toFixed(1)} m/s)`:"No shift (perpendicular motion)";r.append("text").attr("x",m/2).attr("y",110).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size",m<500?"8px":"10px").text(u);const N=[{text:"How to Read These Visualizations:",y:135,bold:!0,size:11},{text:"",y:145},{text:"REDSHIFT (Star moving away from us):",y:155,bold:!0},{text:"  ‚Ä¢ Orbital View: Planet at BOTTOM position",y:168},{text:"  ‚Ä¢ Side View: Both star & planet on RIGHT (far side)",y:181},{text:"  ‚Ä¢ RV Curve: Red marker at PEAK (maximum velocity)",y:194},{text:"  ‚Ä¢ Spectrum: Black lines shift RIGHT (toward red)",y:207},{text:"",y:217},{text:"BLUESHIFT (Star moving toward us):",y:227,bold:!0},{text:"  ‚Ä¢ Orbital View: Planet at TOP position",y:240},{text:"  ‚Ä¢ Side View: Both star & planet on LEFT (near side)",y:253},{text:"  ‚Ä¢ RV Curve: Red marker at VALLEY (minimum velocity)",y:266},{text:"  ‚Ä¢ Spectrum: Black lines shift LEFT (toward blue)",y:279},{text:"",y:289},{text:"NO DOPPLER SHIFT (Perpendicular motion):",y:299,bold:!0},{text:"  ‚Ä¢ Orbital View: Planet at LEFT or RIGHT sides",y:312},{text:"  ‚Ä¢ Side View: Both at center position",y:325},{text:"  ‚Ä¢ RV Curve: Red marker crosses BASELINE",y:338},{text:"  ‚Ä¢ Spectrum: Black lines align with dashed reference lines",y:351}],K=m<500?8:10,k=m<500?9:11;N.forEach($=>{if(!$.text)return;const V=r.append("text").attr("x",m<500?15:20).attr("y",$.y).attr("text-anchor","start").attr("fill","rgba(255, 255, 255, 0.6)").attr("font-size",$.size?`${$.size*(K/10)}px`:`${K}px`).text($.text);$.bold&&V.attr("font-weight","bold").attr("fill","rgba(255, 255, 255, 0.8)").attr("font-size",`${k}px`)})},[n,C,e]),h.useEffect(()=>{if(!C||a.length===0||!c.current||!M.current)return;const m=[e,...a].filter(k=>k.pl_rvamp!==null&&k.pl_rvamp>0).sort((k,$)=>$.pl_rvamp-k.pl_rvamp);if(m.length<=1)return;const r=M.current.clientWidth,l=Math.max(400,r-40),f=Math.max(200,m.length*40),p={top:20,right:30,bottom:40,left:150},S=B(c.current);S.selectAll("*").remove(),S.attr("width",l).attr("height",f),S.append("rect").attr("width",l).attr("height",f).attr("fill","rgba(0, 0, 0, 0.2)");const d=dt(m,k=>k.pl_rvamp),o=mt().domain([.1,d*1.2]).range([p.left,l-p.right]),u=ht().domain(m.map(k=>k.pl_name.split(" ").pop()||k.pl_name)).range([p.top,f-p.bottom]).padding(.2);S.selectAll(".rv-bar").data(m).join("rect").attr("class","rv-bar").attr("x",p.left).attr("y",k=>u(k.pl_name.split(" ").pop()||k.pl_name)).attr("width",k=>o(k.pl_rvamp)-p.left).attr("height",u.bandwidth()).attr("fill",k=>k.pl_name===e.pl_name?"#00ff88":"#00ccff").attr("opacity",k=>k.pl_name===e.pl_name?1:.6),o(1)>=p.left&&o(1)<=l-p.right&&(S.append("line").attr("x1",o(1)).attr("x2",o(1)).attr("y1",p.top).attr("y2",f-p.bottom).attr("stroke","#ff6b6b").attr("stroke-width",2).attr("stroke-dasharray","4,4"),S.append("text").attr("x",o(1)+5).attr("y",p.top+15).attr("fill","#ff6b6b").attr("font-size","10px").text("1 m/s"));const N=S.append("g").attr("transform",`translate(0,${f-p.bottom})`).call(st(o).ticks(5,"~s").tickFormat(k=>`${k} m/s`));N.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),N.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)");const K=S.append("g").attr("transform",`translate(${p.left},0)`).call(rt(u));K.selectAll("text").attr("fill",k=>{var V;return((V=m.find(D=>(D.pl_name.split(" ").pop()||D.pl_name)===k))==null?void 0:V.pl_name)===e.pl_name?"#00ff88":"rgba(255, 255, 255, 0.7)"}).attr("font-weight",k=>{var V;return((V=m.find(D=>(D.pl_name.split(" ").pop()||D.pl_name)===k))==null?void 0:V.pl_name)===e.pl_name?"bold":"normal"}),K.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)")},[e,a,C,s]),!C)return t.jsxs("div",{className:"rv-no-data-container",children:[t.jsxs("div",{className:"rv-no-data-message",children:[t.jsx("h4",{className:"rv-no-data-title",children:s("pages.planet.rv.noData.title")}),t.jsx("p",{className:"rv-no-data-explanation",children:s("pages.planet.rv.noData.message",{method:e.discoverymethod||"unknown method"})})]}),v(),t.jsxs("div",{className:"rv-example",children:[t.jsx("p",{children:t.jsx("strong",{children:s("pages.planet.rv.noData.example")})}),t.jsxs("ul",{children:[t.jsx("li",{children:s("pages.planet.rv.noData.jupiterExample")}),t.jsx("li",{children:s("pages.planet.rv.noData.earthExample")}),t.jsx("li",{children:s("pages.planet.rv.noData.detectionLimit")})]})]})]});function v(){const m=[{key:"doppler",title:s("pages.planet.rv.explanation.dopplerTitle"),content:s("pages.planet.rv.explanation.dopplerContent")},{key:"wobble",title:s("pages.planet.rv.explanation.wobbleTitle"),content:s("pages.planet.rv.explanation.wobbleContent")},{key:"discovery",title:s("pages.planet.rv.explanation.discoveryTitle"),content:s("pages.planet.rv.explanation.discoveryContent")}];return t.jsx("div",{className:"rv-explanation-header",children:m.map(r=>t.jsxs("div",{className:"rv-explanation-section",children:[t.jsxs("button",{className:"rv-explanation-trigger",onClick:()=>x(i===r.key?null:r.key),children:[t.jsx("span",{children:r.title}),t.jsx("span",{className:`rv-explanation-icon ${i===r.key?"expanded":""}`,children:"‚Ä∫"})]}),i===r.key&&t.jsxs("div",{className:"rv-explanation-content",children:[r.content,r.key==="doppler"&&t.jsxs("div",{className:"rv-explanation-image",children:[t.jsx("img",{src:"/images/rv.png",alt:"Radial Velocity Detection Diagram",className:"rv-diagram-image"}),t.jsx("p",{className:"rv-image-caption",children:s("pages.planet.rv.explanation.dopplerImageCaption")})]})]})]},r.key))})}function y(){return t.jsxs("div",{className:"rv-technical-details",children:[t.jsxs("div",{className:"rv-detail-item",children:[t.jsx("div",{className:"rv-detail-label",children:s("pages.planet.rv.technical.amplitude")}),t.jsx("div",{className:"rv-detail-value",children:Ke(e.pl_rvamp)})]}),t.jsxs("div",{className:"rv-detail-item",children:[t.jsx("div",{className:"rv-detail-label",children:s("pages.planet.rv.technical.period")}),t.jsx("div",{className:"rv-detail-value",children:Number(e.pl_orbper)<365?`${Number(e.pl_orbper).toFixed(1)} days`:`${(Number(e.pl_orbper)/365.25).toFixed(2)} years`})]}),e.st_radv!==null&&t.jsxs("div",{className:"rv-detail-item",children:[t.jsx("div",{className:"rv-detail-label",children:s("pages.planet.rv.technical.baseline")}),t.jsxs("div",{className:"rv-detail-value",children:[Number(e.st_radv).toFixed(2)," km/s"]})]}),e.pl_orbeccen!==null&&t.jsxs("div",{className:"rv-detail-item",children:[t.jsx("div",{className:"rv-detail-label",children:s("pages.planet.rv.technical.eccentricity")}),t.jsx("div",{className:"rv-detail-value",children:Number(e.pl_orbeccen).toFixed(3)})]}),e.st_vsin!==null&&e.st_vsin>0&&t.jsxs("div",{className:"rv-detail-item",children:[t.jsx("div",{className:"rv-detail-label",children:s("pages.planet.rv.technical.stellarRotation")}),t.jsxs("div",{className:"rv-detail-value",children:[Number(e.st_vsin).toFixed(2)," km/s"]})]})]})}return t.jsxs("div",{className:"rv-section",children:[t.jsx("p",{className:"rv-intro",children:s("pages.planet.rv.intro")}),v(),t.jsxs("div",{className:"rv-curve-container",children:[t.jsx("h4",{className:"rv-curve-title",children:s("pages.planet.rv.curveTitle")}),t.jsx("div",{ref:R,className:"rv-curve-chart",children:t.jsx("svg",{ref:g})})]}),t.jsxs("div",{className:"rv-data-display",children:[t.jsxs("div",{className:"rv-data-item",children:[t.jsx("div",{className:"rv-data-label",children:s("pages.planet.rv.dataDisplay.currentRV")}),t.jsxs("div",{className:"rv-data-value rv-data-current",children:[((e.st_radv||0)*1e3+(e.pl_rvamp||0)*Math.sin(n)).toFixed(2),t.jsx("span",{className:"rv-data-unit",children:"m/s"})]})]}),t.jsxs("div",{className:"rv-data-item",children:[t.jsx("div",{className:"rv-data-label",children:s("pages.planet.rv.dataDisplay.amplitude")}),t.jsxs("div",{className:"rv-data-value",children:[Number(e.pl_rvamp||0).toFixed(2),t.jsx("span",{className:"rv-data-unit",children:"m/s"})]})]}),t.jsxs("div",{className:"rv-data-item",children:[t.jsx("div",{className:"rv-data-label",children:s("pages.planet.rv.dataDisplay.baseline")}),t.jsxs("div",{className:"rv-data-value",children:[(Number(e.st_radv||0)*1e3).toFixed(2),t.jsx("span",{className:"rv-data-unit",children:"m/s"})]})]})]}),t.jsxs("div",{className:"rv-visualizations-grid",children:[t.jsxs("div",{className:"rv-orbital-views-card",children:[t.jsx("h4",{className:"rv-viz-subtitle",children:s("pages.planet.rv.visualizations.orbitalMotion")}),t.jsxs("div",{className:"rv-orbital-views",children:[t.jsx("div",{className:"rv-orbital-diagram-container",children:t.jsx("div",{ref:_,className:"rv-orbital-diagram",children:t.jsx("svg",{ref:w})})}),t.jsx("div",{className:"rv-side-view-container",children:t.jsx("div",{ref:F,className:"rv-side-view",children:t.jsx("svg",{ref:j})})})]})]}),t.jsxs("div",{className:"rv-spectrum-card",children:[t.jsx("h4",{className:"rv-viz-subtitle",children:s("pages.planet.rv.visualizations.spectralDoppler")}),t.jsx("div",{ref:A,className:"rv-spectrum",children:t.jsx("svg",{ref:z})})]})]}),a.length>0&&t.jsxs("div",{className:"rv-comparison-container",children:[t.jsx("h4",{className:"rv-comparison-title",children:s("pages.planet.rv.comparisonTitle")}),t.jsx("p",{className:"rv-comparison-description",children:s("pages.planet.rv.comparisonDescription")}),t.jsx("div",{ref:M,className:"rv-comparison-chart",children:t.jsx("svg",{ref:c})}),t.jsxs("div",{className:"rv-comparison-legend",children:[t.jsxs("div",{className:"rv-comparison-legend-item",children:[t.jsx("div",{className:"rv-legend-dot current"}),t.jsx("span",{children:e.pl_name})]}),t.jsxs("div",{className:"rv-comparison-legend-item",children:[t.jsx("div",{className:"rv-legend-dot sibling"}),t.jsx("span",{children:"Sibling planets"})]}),t.jsxs("div",{className:"rv-comparison-legend-item",children:[t.jsx("div",{className:"rv-legend-dot threshold"}),t.jsx("span",{children:s("pages.planet.rv.detectionThreshold")})]})]})]}),y()]})}function De(){let e=0,a=0;for(;e===0;)e=Math.random();for(;a===0;)a=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*a)}function $t(e){if(e.pl_trandep!==null&&e.pl_trandep>0)return e.pl_trandep/100;if(e.pl_ratror!==null&&e.pl_ratror>0)return e.pl_ratror*e.pl_ratror;if(e.pl_rade!==null&&e.st_rad!==null){const s=e.pl_rade/109.1/e.st_rad;return s*s}return .01}function Ie(e){if(e.pl_trandur!==null&&e.pl_orbper!==null&&e.pl_trandur>0)return e.pl_trandur/24/e.pl_orbper;if(e.pl_imppar!==null&&e.pl_ratdor!==null){const a=e.pl_imppar,s=e.pl_ratdor;if(s>0){const i=2/s,x=Math.sqrt(Math.max(0,1-a*a));return i*x*.1}}return .08}function Le(e){return Math.min(.2,Math.max(.1,e*.15))}function St(e,a=1500){const s=[];let i=$t(e);i<5e-4?i*=12:i<.002?i*=8:i<.01?i*=4:i<.05&&(i*=2),i=Math.min(i,.25);const x=Ie(e),n=Le(x),b=.5,g=b-x/2,R=b+x/2,c=g,M=g+n,w=R-n,_=R,j=Math.max(5e-5,i*.03);for(let F=0;F<a;F++){const z=F/(a-1);let A=1;if(z>=c&&z<=_)if(z<M){const v=(z-c)/(M-c);A=1-i*Rt(v)}else if(z>w){const v=(z-w)/(_-w);A=1-i*(1-Rt(v))}else A=1-i;const T=De()*j,C=Et(A+T,1-i-.01,1.01);s.push({phase:z,flux:Number(C.toFixed(6)),fluxClean:Number(A.toFixed(6))})}return s}function He(e){const s=$t(e)*100;return s<.01?`${(s*1e3).toFixed(1)} ppm`:`${s.toFixed(3)}%`}function Oe(e){if(e.pl_trandur!==null){const a=e.pl_trandur;return a<1?`${(a*60).toFixed(0)} min`:a<24?`${a.toFixed(2)} h`:`${(a/24).toFixed(2)} days`}return"N/A"}function Ve(e){if(e.pl_orbper===null)return"N/A";const a=e.pl_orbper;return a<365?`${a.toFixed(2)} days`:`${(a/365.25).toFixed(2)} years`}function Mt(e){if(e.pl_rade===null)return e.pl_ratror!==null?`${e.pl_ratror.toFixed(2)} R‚òÖ`:"N/A";const a=e.pl_rade;return a<.5?`${a.toFixed(2)} R‚äï`:a<1.5?`${a.toFixed(2)} R‚äï`:a<10?`${a.toFixed(1)} R‚äï`:`${(a/109.1).toFixed(2)} R‚òâ`}function Be(e){return e.pl_imppar===null?"N/A":e.pl_imppar.toFixed(2)}function Ge(e){return e.pl_ratdor===null?"N/A":e.pl_ratdor.toFixed(2)}function Ue({planet:e,siblings:a=[]}){const{t:s}=O(),[i,x]=h.useState(null),[n,b]=h.useState(0),g=h.useRef(null),R=h.useRef(null),c=h.useRef(null),M=h.useRef(null),w=h.useRef(null),_=h.useRef(null),j=h.useRef(null),F=h.useRef(null),z=h.useRef(),A=e.is_transiting&&e.pl_trandep!==null&&e.pl_orbper!==null;if(h.useEffect(()=>{if(!A)return;const v=8e-4,y=()=>{b(m=>(m+v)%1),z.current=requestAnimationFrame(y)};return z.current=requestAnimationFrame(y),()=>{z.current&&cancelAnimationFrame(z.current)}},[A]),h.useEffect(()=>{if(!A||!g.current||!R.current)return;const v=R.current.clientWidth,y=Math.min(v-20,1200),m=380,r={top:20,right:30,bottom:80,left:70},l=B(g.current);l.selectAll("*").remove(),l.attr("width",y).attr("height",m);const f=St(e),p=Math.min(...f.map(L=>L.fluxClean)),S=1-p,d=p-S*.5,o=1+S*1.2,u=pt().domain([0,1]).range([r.left,y-r.right]),N=pt().domain([d,o]).range([m-r.bottom,r.top]),K=l.append("g");l.append("rect").attr("width",y).attr("height",m).attr("fill","rgba(0, 0, 0, 0.2)"),K.append("g").attr("class","grid").attr("transform",`translate(0,${m-r.bottom})`).call(st(u).ticks(5).tickSize(-280).tickFormat(()=>"")).selectAll("line").attr("stroke","rgba(255, 255, 255, 0.05)"),K.append("g").attr("class","grid").attr("transform",`translate(${r.left},0)`).call(rt(N).ticks(5).tickSize(-(y-r.left-r.right)).tickFormat(()=>"")).selectAll("line").attr("stroke","rgba(255, 255, 255, 0.05)");const k=.5-(e.pl_trandur&&e.pl_orbper?e.pl_trandur/24/e.pl_orbper/2:.04),$=.5+(e.pl_trandur&&e.pl_orbper?e.pl_trandur/24/e.pl_orbper/2:.04);K.append("rect").attr("x",u(k)).attr("y",r.top).attr("width",u($)-u(k)).attr("height",m-r.top-r.bottom).attr("fill","#00e5ff").attr("opacity",.05),K.append("line").attr("x1",r.left).attr("x2",y-r.right).attr("y1",N(1)).attr("y2",N(1)).attr("stroke","#ff9500").attr("stroke-width",2.5).attr("stroke-dasharray","4,4").attr("opacity",.8);const V=At().x(L=>u(L.phase)).y(L=>N(L.fluxClean)).curve(ie);K.append("path").datum(f).attr("fill","none").attr("stroke","#00e5ff").attr("stroke-width",3).attr("opacity",1).attr("d",V),K.selectAll(".point").data(f.filter((L,lt)=>lt%4===0)).enter().append("circle").attr("class","point").attr("cx",L=>u(L.phase)).attr("cy",L=>N(L.flux)).attr("r",1.5).attr("fill","#00e5ff").attr("opacity",.15);const D=K.append("g").attr("class","marker");D.append("line").attr("class","marker-line").attr("y1",r.top).attr("y2",m-r.bottom).attr("stroke","#ff9500").attr("stroke-width",1.5).attr("opacity",.8),D.append("circle").attr("class","marker-dot").attr("r",6).attr("fill","#ff9500").attr("stroke","#fff").attr("stroke-width",2);const G=16,I=r.left,H=m-r.bottom+10;l.append("rect").attr("x",I-5).attr("y",H-5).attr("width",340).attr("height",G+10).attr("fill","rgba(0, 0, 0, 0.6)").attr("stroke","rgba(255, 255, 255, 0.3)").attr("stroke-width",1).attr("rx",4),l.append("line").attr("x1",I).attr("x2",I+20).attr("y1",H+6).attr("y2",H+6).attr("stroke","#00e5ff").attr("stroke-width",2),l.append("text").attr("x",I+25).attr("y",H+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Model");const U=I+100;l.append("line").attr("x1",U).attr("x2",U+20).attr("y1",H+6).attr("y2",H+6).attr("stroke","#ff9500").attr("stroke-width",2).attr("stroke-dasharray","4,2"),l.append("text").attr("x",U+25).attr("y",H+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Baseline");const W=I+210;l.append("circle").attr("cx",W+10).attr("cy",H+6).attr("r",2).attr("fill","#00e5ff").attr("opacity",.25),l.append("text").attr("x",W+25).attr("y",H+9).attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size","10px").text("Data");const X=K.append("g").attr("transform",`translate(0,${m-r.bottom})`).call(st(u).ticks(5));X.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),X.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)"),l.append("text").attr("x",y/2).attr("y",m-5).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","12px").text(s("pages.planet.transit.xAxisLabel"));const Q=K.append("g").attr("transform",`translate(${r.left},0)`).call(rt(N).ticks(6).tickFormat(L=>`${Number(L).toFixed(3)}`));Q.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),Q.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)"),l.append("text").attr("transform","rotate(-90)").attr("x",-190).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","12px").text(s("pages.planet.transit.yAxisLabel"));const it=Math.floor(n*(f.length-1)),P=f[Math.min(it,f.length-1)];D.select(".marker-line").attr("x1",u(n)).attr("x2",u(n)),D.select(".marker-dot").attr("cx",u(n)).attr("cy",N(P.flux))},[n,A,e,s]),h.useEffect(()=>{if(!A||!w.current||!_.current)return;const v=250,y=v/2,m=v/2,r=v/2-20,l=B(w.current);l.selectAll("*").remove(),l.attr("width",v).attr("height",v),l.append("rect").attr("width",v).attr("height",v).attr("fill","rgba(0, 0, 0, 0.3)");const f=r*.7,p=n-.25,S=y+Math.cos(p*2*Math.PI)*f,d=m+Math.sin(p*2*Math.PI)*f;l.append("circle").attr("cx",y).attr("cy",m).attr("r",f).attr("fill","none").attr("stroke","rgba(255, 255, 255, 0.2)").attr("stroke-width",1).attr("stroke-dasharray","4,4");const o=35,u=[[y,m],[y-o/2,m+r],[y+o/2,m+r]],N=Math.abs(S-y)<o/2&&d>m;l.append("polygon").attr("points",u.map($=>$.join(",")).join(" ")).attr("fill",N?"rgba(255, 100, 100, 0.1)":"rgba(0, 229, 255, 0.05)").attr("stroke",N?"rgba(255, 100, 100, 0.3)":"rgba(0, 229, 255, 0.15)").attr("stroke-width",1);const k=l.append("defs").append("radialGradient").attr("id","transitStarGlow");k.append("stop").attr("offset","0%").attr("stop-color","#fff"),k.append("stop").attr("offset","50%").attr("stop-color","#ffdd44"),k.append("stop").attr("offset","100%").attr("stop-color","#ff8800").attr("stop-opacity",0),l.append("circle").attr("cx",y).attr("cy",m).attr("r",18).attr("fill","url(#transitStarGlow)"),l.append("circle").attr("cx",y).attr("cy",m).attr("r",12).attr("fill","#ffdd44"),l.append("circle").attr("cx",S).attr("cy",d).attr("r",5).attr("fill","#00e5ff").attr("stroke","#fff").attr("stroke-width",1),l.append("line").attr("x1",y).attr("x2",y).attr("y1",m+r-5).attr("y2",m+r+5).attr("stroke","rgba(255, 255, 255, 0.5)").attr("stroke-width",1),l.append("text").attr("x",y).attr("y",v-2).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.5)").attr("font-size","9px").text("To Earth"),l.append("text").attr("x",v/2).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","11px").text(s("pages.planet.transit.visualizations.topView"))},[n,A,s]),h.useEffect(()=>{if(!A||!j.current||!F.current)return;const v=250,y=80,m=y/2,r=180,l=B(j.current);l.selectAll("*").remove(),l.attr("width",v).attr("height",y),l.append("rect").attr("width",v).attr("height",y).attr("fill","rgba(0, 0, 0, 0.3)"),l.append("line").attr("x1",35).attr("x2",35+r).attr("y1",m).attr("y2",m).attr("stroke","rgba(255, 255, 255, 0.3)").attr("stroke-width",2);const p=l.append("defs").append("radialGradient").attr("id","transitStarGlowSide");p.append("stop").attr("offset","0%").attr("stop-color","#fff"),p.append("stop").attr("offset","50%").attr("stop-color","#ffdd44"),p.append("stop").attr("offset","100%").attr("stop-color","#ff8800").attr("stop-opacity",0),l.append("circle").attr("cx",v/2).attr("cy",m).attr("r",28).attr("fill","url(#transitStarGlowSide)"),l.append("circle").attr("cx",v/2).attr("cy",m).attr("r",22).attr("fill","#ffdd44");const S=n-.25,d=35+r/2+Math.cos(S*2*Math.PI)*70,o=e.pl_imppar||.3,u=m+o*10,N=Math.sin(S*2*Math.PI)>0;l.append("circle").attr("cx",d).attr("cy",u).attr("r",5).attr("fill",N?"#00e5ff":"#0088aa").attr("stroke","#fff").attr("stroke-width",1).attr("opacity",N?1:.5),l.append("text").attr("x",v/2).attr("y",15).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size","11px").text(s("pages.planet.transit.visualizations.sideView"))},[n,A,e,s]),h.useEffect(()=>{if(!A||a.length===0||!c.current||!M.current)return;const v=[e,...a].filter(N=>N.is_transiting&&N.pl_trandep!==null&&N.pl_trandep>0).sort((N,K)=>(K.pl_trandep||0)-(N.pl_trandep||0));if(v.length<=1)return;const y=M.current.clientWidth,m=Math.max(400,Math.min(y-40,900)),r=Math.max(200,v.length*40),l={top:20,right:20,bottom:40,left:120},f=B(c.current);f.selectAll("*").remove(),f.attr("width",m).attr("height",r),f.append("rect").attr("width",m).attr("height",r).attr("fill","rgba(0, 0, 0, 0.2)");const p=dt(v,N=>N.pl_trandep||.01),S=mt().domain([.001,p*1.2]).range([l.left,m-l.right]),d=ht().domain(v.map(N=>N.pl_name.split(" ").pop()||N.pl_name)).range([l.top,r-l.bottom]).padding(.2);f.selectAll(".transit-bar").data(v).join("rect").attr("class","transit-bar").attr("x",l.left).attr("y",N=>d(N.pl_name.split(" ").pop()||N.pl_name)).attr("width",N=>S(N.pl_trandep||.01)-l.left).attr("height",d.bandwidth()).attr("fill",N=>N.pl_name===e.pl_name?"#4caf50":"#00ccff").attr("opacity",N=>N.pl_name===e.pl_name?1:.6),S(.01)>=l.left&&S(.01)<=m-l.right&&(f.append("line").attr("x1",S(.01)).attr("x2",S(.01)).attr("y1",l.top).attr("y2",r-l.bottom).attr("stroke","#ff6b6b").attr("stroke-width",2).attr("stroke-dasharray","4,4"),f.append("text").attr("x",S(.01)+5).attr("y",l.top+15).attr("fill","#ff6b6b").attr("font-size","10px").text("0.01%"));const o=f.append("g").attr("transform",`translate(0,${r-l.bottom})`).call(st(S).ticks(5,"~s").tickFormat(N=>`${N}%`));o.selectAll("text").attr("fill","rgba(255, 255, 255, 0.7)"),o.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)");const u=f.append("g").attr("transform",`translate(${l.left},0)`).call(rt(d));u.selectAll("text").attr("fill",N=>{var k;return((k=v.find($=>($.pl_name.split(" ").pop()||$.pl_name)===N))==null?void 0:k.pl_name)===e.pl_name?"#4caf50":"rgba(255, 255, 255, 0.7)"}).attr("font-weight",N=>{var k;return((k=v.find($=>($.pl_name.split(" ").pop()||$.pl_name)===N))==null?void 0:k.pl_name)===e.pl_name?"bold":"normal"}),u.selectAll("line, path").attr("stroke","rgba(255, 255, 255, 0.3)")},[e,a,A]),!A)return t.jsxs("div",{className:"transit-no-data-container",children:[t.jsxs("div",{className:"transit-no-data-message",children:[t.jsx("h4",{className:"transit-no-data-title",children:s("pages.planet.transit.noData.title")}),t.jsx("p",{className:"transit-no-data-explanation",children:s("pages.planet.transit.noData.message",{method:e.discoverymethod||"unknown method"})})]}),T(),t.jsxs("div",{className:"transit-example",children:[t.jsx("p",{children:t.jsx("strong",{children:s("pages.planet.transit.noData.example")})}),t.jsxs("ul",{children:[t.jsx("li",{children:s("pages.planet.transit.noData.jupiterExample")}),t.jsx("li",{children:s("pages.planet.transit.noData.earthExample")}),t.jsx("li",{children:s("pages.planet.transit.noData.detectionLimit")})]})]})]});function T(){const v=[{key:"geometry",title:s("pages.planet.transit.explanation.geometryTitle"),content:s("pages.planet.transit.explanation.geometryContent")},{key:"depth",title:s("pages.planet.transit.explanation.depthTitle"),content:s("pages.planet.transit.explanation.depthContent")},{key:"timing",title:s("pages.planet.transit.explanation.timingTitle"),content:s("pages.planet.transit.explanation.timingContent")}];return t.jsx("div",{className:"transit-explanation-header",children:v.map(y=>t.jsxs("div",{className:"transit-explanation-section",children:[t.jsxs("button",{className:"transit-explanation-trigger",onClick:()=>x(i===y.key?null:y.key),children:[t.jsx("span",{children:y.title}),t.jsx("span",{className:`transit-explanation-icon ${i===y.key?"expanded":""}`,children:"‚Ä∫"})]}),i===y.key&&t.jsx("div",{className:"transit-explanation-content",children:y.content})]},y.key))})}function C(){return t.jsxs("div",{className:"transit-technical-details",children:[t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.depth")}),t.jsx("div",{className:"transit-detail-value",children:He(e)})]}),t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.duration")}),t.jsx("div",{className:"transit-detail-value",children:Oe(e)})]}),t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.period")}),t.jsx("div",{className:"transit-detail-value",children:Ve(e)})]}),e.pl_ratror!==null&&t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.radiusRatio")}),t.jsx("div",{className:"transit-detail-value",children:e.pl_ratror.toFixed(3)})]}),e.pl_ratdor!==null&&t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.semiMajorRatio")}),t.jsx("div",{className:"transit-detail-value",children:Ge(e)})]}),e.pl_imppar!==null&&t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.impactParameter")}),t.jsx("div",{className:"transit-detail-value",children:Be(e)})]}),t.jsxs("div",{className:"transit-detail-item",children:[t.jsx("div",{className:"transit-detail-label",children:s("pages.planet.transit.technical.planetRadius")}),t.jsx("div",{className:"transit-detail-value",children:Mt(e)})]})]})}return t.jsxs("div",{className:"transit-section",children:[t.jsx("p",{className:"transit-intro",children:s("pages.planet.transit.intro")}),T(),t.jsxs("div",{className:"transit-curve-container",children:[t.jsx("h4",{className:"transit-curve-title",children:s("pages.planet.transit.curveTitle")}),t.jsx("div",{ref:R,className:"transit-curve-chart",children:t.jsx("svg",{ref:g})})]}),t.jsxs("div",{className:"transit-data-display",children:[t.jsxs("div",{className:"transit-data-item",children:[t.jsx("div",{className:"transit-data-label",children:s("pages.planet.transit.dataDisplay.currentFlux")}),t.jsx("div",{className:"transit-data-value",children:(()=>{const v=St(e),y=Math.floor(n*(v.length-1));return v[Math.min(y,v.length-1)].flux.toFixed(4)})()})]}),t.jsxs("div",{className:"transit-data-item",children:[t.jsx("div",{className:"transit-data-label",children:s("pages.planet.transit.dataDisplay.transitDepth")}),t.jsxs("div",{className:"transit-data-value",children:[((e.pl_trandep||(e.pl_ratror?e.pl_ratror*e.pl_ratror*100:.01))*100).toFixed(2),"%"]})]}),t.jsxs("div",{className:"transit-data-item",children:[t.jsx("div",{className:"transit-data-label",children:s("pages.planet.transit.dataDisplay.planetRadius")}),t.jsx("div",{className:"transit-data-value",children:Mt(e)})]}),t.jsxs("div",{className:"transit-data-item",children:[t.jsx("div",{className:"transit-data-label",children:s("pages.planet.transit.dataDisplay.phase")}),t.jsx("div",{className:"transit-data-value",children:n.toFixed(2)})]})]}),t.jsxs("div",{className:"transit-visualizations-grid",children:[t.jsxs("div",{className:"transit-orbital-card",children:[t.jsx("h4",{className:"transit-viz-subtitle",children:s("pages.planet.transit.visualizations.orbitalGeometry")}),t.jsxs("div",{className:"transit-orbital-views",children:[t.jsx("div",{className:"transit-orbital-diagram-container",children:t.jsx("div",{ref:_,className:"transit-orbital-diagram",children:t.jsx("svg",{ref:w})})}),t.jsx("div",{className:"transit-side-view-container",children:t.jsx("div",{ref:F,className:"transit-side-view",children:t.jsx("svg",{ref:j})})})]})]}),t.jsxs("div",{className:"transit-legend-card",children:[t.jsx("h4",{className:"transit-viz-subtitle",children:s("pages.planet.transit.visualizations.whatWeLearn")}),t.jsxs("div",{className:"transit-legend-section",children:[t.jsx("div",{className:"transit-legend-title",children:s("pages.planet.transit.legend.duringTransit")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.duringTransitItem1")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.duringTransitItem2")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.duringTransitItem3")}),t.jsx("div",{className:"transit-legend-title",children:s("pages.planet.transit.legend.outsideTransit")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.outsideTransitItem1")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.outsideTransitItem2")}),t.jsx("div",{className:"transit-legend-title",children:s("pages.planet.transit.legend.whatWeLearn")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.whatWeLearnItem1")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.whatWeLearnItem2")}),t.jsx("div",{className:"transit-legend-item",children:s("pages.planet.transit.legend.whatWeLearnItem3")})]})]})]}),a.length>0&&t.jsxs("div",{className:"transit-comparison-container",children:[t.jsx("h4",{className:"transit-comparison-title",children:s("pages.planet.transit.comparisonTitle")}),t.jsx("p",{className:"transit-comparison-description",children:s("pages.planet.transit.comparisonDescription")}),t.jsx("div",{ref:M,className:"transit-comparison-chart",children:t.jsx("svg",{ref:c})}),t.jsxs("div",{className:"transit-comparison-legend",children:[t.jsxs("div",{className:"transit-comparison-legend-item",children:[t.jsx("div",{className:"transit-legend-dot current"}),t.jsx("span",{children:e.pl_name})]}),t.jsxs("div",{className:"transit-comparison-legend-item",children:[t.jsx("div",{className:"transit-legend-dot sibling"}),t.jsx("span",{children:"Sibling planets"})]}),t.jsxs("div",{className:"transit-comparison-legend-item",children:[t.jsx("div",{className:"transit-legend-dot threshold"}),t.jsx("span",{children:"Detection threshold"})]})]})]}),C()]})}const Y={WALKING_KMS:.0014,CAR_KMS:.03,JET_KMS:.25,VOYAGER_KMS:17,NEW_HORIZONS_KMS:16.26,PARKER_PROBE_KMS:192,LIGHT_1PCT_KMS:2998,LIGHT_10PCT_KMS:29979,LIGHT_SPEED_KMS:299792},We=9461e9,Tt=80,Ye=31557600,ct=2e3,qe=[{key:"walking",speedKms:Y.WALKING_KMS,icon:"üö∂",category:"human",color:"#888888"},{key:"car",speedKms:Y.CAR_KMS,icon:"üöó",category:"human",color:"#aaaaaa"},{key:"jet",speedKms:Y.JET_KMS,icon:"‚úàÔ∏è",category:"human",color:"#cccccc"},{key:"voyager",speedKms:Y.VOYAGER_KMS,icon:"üõ∞Ô∏è",category:"spacecraft",color:"#ff6b6b"},{key:"newHorizons",speedKms:Y.NEW_HORIZONS_KMS,icon:"üöÄ",category:"spacecraft",color:"#ffa06b"},{key:"parkerProbe",speedKms:Y.PARKER_PROBE_KMS,icon:"‚òÄÔ∏è",category:"spacecraft",color:"#ffcc00"},{key:"onePercentC",speedKms:Y.LIGHT_1PCT_KMS,icon:"‚ö°",category:"light",color:"#00ccff"},{key:"tenPercentC",speedKms:Y.LIGHT_10PCT_KMS,icon:"üí´",category:"light",color:"#00ffcc"},{key:"lightSpeed",speedKms:Y.LIGHT_SPEED_KMS,icon:"üåü",category:"light",color:"#00ff88"}];function Xe(e,a){return e*We/a/Ye}function nt(e){return e<1?`${(e*365.25).toFixed(1)} days`:e<1e3?`${e.toFixed(0)} years`:e<1e6?`${(e/1e3).toFixed(1)}k years`:e<1e9?`${(e/1e6).toFixed(1)}M years`:e<1e12?`${(e/1e9).toFixed(1)}B years`:`${(e/1e12).toFixed(1)}T years`}function Ze({distanceLy:e,compact:a=!1}){const{t:s}=O(),i=h.useRef(null),x=h.useRef(null),[n,b]=h.useState(null),[g,R]=h.useState(!1),c=h.useMemo(()=>qe.map(_=>{const j=Xe(e,_.speedKms),F=j<=Tt;return{..._,years:j,withinLifetime:F}}),[e]),M=h.useMemo(()=>{var _;return((_=c.find(j=>j.withinLifetime))==null?void 0:_.key)||null},[c]);h.useEffect(()=>{if(!i.current||!x.current||!e)return;const _=x.current.clientWidth,j=_<600,F=j?Math.max(300,c.length*35+80):a?300:400,z=j?{top:20,right:30,bottom:60,left:30}:{top:20,right:120,bottom:30,left:a?100:140},A=_-z.left-z.right,T=F-z.top-z.bottom,C=B(i.current);C.selectAll("*").remove(),C.attr("width",_).attr("height",F);const v=C.append("g").attr("transform",`translate(${z.left},${z.top})`),y=Math.max(...c.map(d=>d.speedKms)),m=Math.min(...c.map(d=>d.speedKms));let r,l;if(j?(r=ht().domain(c.map(d=>d.key)).range([0,A]).padding(.4),l=mt().domain([m*.5,y*2]).range([T,0])):(r=mt().domain([m*.5,y*2]).range([0,A]),l=ht().domain(c.map(d=>d.key)).range([0,T]).padding(.3)),j){const d=r;v.selectAll(".bar-track").data(c).join("rect").attr("class","bar-track").attr("x",o=>d(o.key)||0).attr("y",0).attr("width",d.bandwidth()).attr("height",T).attr("fill","rgba(255, 255, 255, 0.03)").attr("rx",4)}else{const d=l;v.selectAll(".bar-track").data(c).join("rect").attr("class","bar-track").attr("x",0).attr("y",o=>d(o.key)||0).attr("width",A).attr("height",d.bandwidth()).attr("fill","rgba(255, 255, 255, 0.03)").attr("rx",4)}let f;if(j){const d=r;f=v.selectAll(".speed-bar").data(c).join("rect").attr("class","speed-bar").attr("x",o=>d(o.key)||0).attr("width",d.bandwidth()).attr("fill",o=>o.color).attr("rx",4).attr("opacity",.8).attr("cursor","pointer").attr("y",T).attr("height",0)}else{const d=l;f=v.selectAll(".speed-bar").data(c).join("rect").attr("class","speed-bar").attr("x",0).attr("y",o=>d(o.key)||0).attr("height",d.bandwidth()).attr("fill",o=>o.color).attr("rx",4).attr("opacity",.8).attr("cursor","pointer").attr("width",0)}if(g)if(j){const d=l;f.attr("y",o=>d(o.speedKms)).attr("height",o=>T-d(o.speedKms))}else{const d=r;f.attr("width",o=>d(o.speedKms))}else if(j){const d=l;f.transition().duration(ct).delay((o,u)=>u*100).ease(yt).attr("y",o=>d(o.speedKms)).attr("height",o=>T-d(o.speedKms)).on("end",()=>R(!0))}else{const d=r;f.transition().duration(ct).delay((o,u)=>u*100).ease(yt).attr("width",o=>d(o.speedKms)).on("end",()=>R(!0))}if(f.on("mouseenter",function(d,o){B(this).attr("opacity",1),b(o.key)}).on("mouseleave",function(){B(this).attr("opacity",.8),b(null)}),j){const d=r;v.selectAll(".speed-icon").data(c).join("text").attr("class","speed-icon").attr("x",o=>(d(o.key)||0)+d.bandwidth()/2).attr("y",T+15).attr("text-anchor","middle").attr("font-size","14px").text(o=>o.icon),v.selectAll(".speed-label").data(c).join("text").attr("class","speed-label").attr("x",o=>(d(o.key)||0)+d.bandwidth()/2).attr("y",T+30).attr("text-anchor","middle").attr("fill","rgba(255, 255, 255, 0.6)").attr("font-size","7px").text(o=>s(`components.travelTime.speeds.${o.key}`))}else{const d=l;v.selectAll(".speed-icon").data(c).join("text").attr("class","speed-icon").attr("x",-35).attr("y",o=>(d(o.key)||0)+d.bandwidth()/2).attr("dy","0.35em").attr("text-anchor","middle").attr("font-size",a?"16px":"20px").text(o=>o.icon),v.selectAll(".speed-label").data(c).join("text").attr("class","speed-label").attr("x",-45).attr("y",o=>(d(o.key)||0)+d.bandwidth()/2).attr("dy","0.35em").attr("text-anchor","end").attr("fill","rgba(255, 255, 255, 0.7)").attr("font-size",a?"9px":"11px").text(o=>s(`components.travelTime.speeds.${o.key}`))}const p=v.selectAll(".time-label").data(c).join("text").attr("class","time-label").attr("fill","rgba(255, 255, 255, 0.9)").attr("font-size",j?"8px":a?"9px":"11px").attr("font-family","monospace").attr("opacity",0);if(j){const d=r,o=l;g?p.attr("x",u=>(d(u.key)||0)+d.bandwidth()/2).attr("y",u=>o(u.speedKms)-5).attr("text-anchor","middle").attr("opacity",1).text(u=>nt(u.years)):p.attr("x",u=>(d(u.key)||0)+d.bandwidth()/2).attr("y",u=>o(u.speedKms)-5).attr("text-anchor","middle").transition().duration(300).delay((u,N)=>ct+N*100).attr("opacity",1).text(u=>nt(u.years))}else{const d=r,o=l;g?p.attr("x",u=>d(u.speedKms)+8).attr("y",u=>(o(u.key)||0)+o.bandwidth()/2).attr("dy","0.35em").attr("opacity",1).text(u=>nt(u.years)):p.attr("y",u=>(o(u.key)||0)+o.bandwidth()/2).attr("dy","0.35em").transition().duration(300).delay((u,N)=>ct+N*100).attr("x",u=>d(u.speedKms)+8).attr("opacity",1).text(u=>nt(u.years))}const S=c.filter(d=>d.withinLifetime);if(S.length>0){const d=S[S.length-1];if(j){const u=l(d.speedKms)||0;v.append("line").attr("x1",-10).attr("x2",A+10).attr("y1",u).attr("y2",u).attr("stroke","#00ff88").attr("stroke-width",2).attr("stroke-dasharray","4,4").attr("opacity",.6),v.append("text").attr("x",-15).attr("y",u).attr("text-anchor","end").attr("dy","0.35em").attr("fill","#00ff88").attr("font-size","8px").text("‚úì Lifetime")}else{const u=r(d.speedKms)||0;v.append("line").attr("x1",u).attr("x2",u).attr("y1",-10).attr("y2",T+10).attr("stroke","#00ff88").attr("stroke-width",2).attr("stroke-dasharray","4,4").attr("opacity",.6),v.append("text").attr("x",u).attr("y",-15).attr("text-anchor","middle").attr("fill","#00ff88").attr("font-size","10px").text(s("components.travelTime.reachableInLifetime"))}}},[e,c,s,g,a]);const w=n?c.find(_=>_.key===n):null;return!e||e<=0?t.jsx("div",{className:"travel-time-section",children:t.jsx("p",{className:"travel-unreachable",children:s("components.travelTime.unknownDistance")})}):t.jsxs("div",{className:"travel-time-section",children:[t.jsxs("div",{className:"travel-time-header",children:[t.jsxs("div",{className:"travel-time-distance",children:[t.jsx("span",{className:"distance-value",children:e.toFixed(1)}),t.jsx("span",{className:"distance-label",children:s("components.travelTime.lightYearsAway")})]}),M&&t.jsxs("div",{className:"travel-time-reachable",children:[t.jsx("span",{className:"reachable-icon",children:"‚úì"}),t.jsx("span",{children:s("components.travelTime.reachableAt",{speed:s(`components.travelTime.speeds.${M}`)})})]})]}),t.jsx("div",{ref:x,className:"travel-time-chart",children:t.jsx("svg",{ref:i})}),w&&t.jsxs("div",{className:"travel-time-details",children:[t.jsx("div",{className:"detail-icon",children:w.icon}),t.jsxs("div",{className:"detail-info",children:[t.jsx("span",{className:"detail-name",children:s(`components.travelTime.speeds.${w.key}`)}),t.jsx("span",{className:"detail-time",children:nt(w.years)})]}),t.jsx("div",{className:"detail-stats",children:t.jsx("span",{className:`detail-badge ${w.withinLifetime?"reachable":""}`,children:w.withinLifetime?s("components.travelTime.withinLifetime"):s("components.travelTime.lifetimes",{count:Math.ceil(w.years/Tt)})})})]}),t.jsxs("button",{className:"travel-time-replay",onClick:()=>R(!1),children:["üîÑ ",s("components.travelTime.replayRace")]})]})}function Je({isOpen:e,onClose:a}){const{t:s}=O();return e?t.jsx("div",{className:"viz-dialog-overlay",onClick:a,children:t.jsxs("div",{className:"viz-dialog",onClick:i=>i.stopPropagation(),children:[t.jsx("button",{className:"viz-dialog-close",onClick:a,children:"√ó"}),t.jsx("h3",{className:"viz-dialog-title",children:s("pages.planet.visualization.title")}),t.jsxs("div",{className:"viz-dialog-content",children:[t.jsx("p",{children:s("pages.planet.visualization.intro")}),t.jsxs("div",{className:"viz-method-section",children:[t.jsx("h4",{children:s("pages.planet.visualization.density.title")}),t.jsx("p",{children:s("pages.planet.visualization.density.description")})]}),t.jsxs("div",{className:"viz-method-section",children:[t.jsx("h4",{children:s("pages.planet.visualization.insolation.title")}),t.jsx("p",{children:s("pages.planet.visualization.insolation.description")})]}),t.jsxs("div",{className:"viz-method-section",children:[t.jsx("h4",{children:s("pages.planet.visualization.starTemp.title")}),t.jsx("p",{children:s("pages.planet.visualization.starTemp.description")})]}),t.jsxs("div",{className:"viz-method-section",children:[t.jsx("h4",{children:s("pages.planet.visualization.planetType.title")}),t.jsx("p",{children:s("pages.planet.visualization.planetType.description")})]}),t.jsx("p",{className:"viz-disclaimer",children:s("pages.planet.visualization.disclaimer")})]})]})}):null}function q({title:e,children:a,className:s=""}){return t.jsxs("section",{className:`planet-section ${s}`,children:[e&&t.jsx("h2",{className:"planet-section-title",children:e}),t.jsx("div",{className:"planet-section-content",children:a})]})}function na(){const{t:e}=O(),{planetId:a}=Xt(),s=Zt(),{getPlanetBySlug:i,getPlanetsByHost:x,isLoading:n}=Jt(),[b,g]=h.useState(!1),R=h.useRef(null),c=a?i(a):void 0,M=h.useMemo(()=>c?x(c.hostname):[],[c,x]);h.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[a]);const w=()=>{if(R.current){const F=R.current.getBoundingClientRect().top+window.scrollY-120;window.scrollTo({top:F,behavior:"smooth"})}};return n?t.jsx("div",{className:"planet-page",children:t.jsxs("div",{className:"planet-loading",children:[t.jsx("div",{className:"spinner-orbit",children:t.jsx("div",{className:"spinner-planet"})}),t.jsx("p",{className:"spinner-text",children:e("pages.planet.loading")})]})}):c?t.jsxs("div",{className:"planet-page",children:[t.jsx("button",{className:"planet-back-button",onClick:()=>s(-1),children:e("pages.planet.back")}),t.jsxs("div",{className:"planet-hero",children:[t.jsx("div",{className:"planet-canvas-container",children:t.jsx(ce,{planet:c})}),t.jsx("button",{className:"viz-info-button",onClick:()=>g(!0),title:e("pages.planet.visualization.title"),children:t.jsx("span",{className:"viz-info-icon",children:"i"})}),t.jsx(Je,{isOpen:b,onClose:()=>g(!1)}),t.jsxs("div",{className:"planet-hero-text",children:[t.jsx("h1",{className:"planet-hero-title",children:c.pl_name}),t.jsx("p",{className:"planet-hero-subtitle",children:c.planet_type||e("pages.planet.exoplanet")}),t.jsxs("div",{className:"planet-hero-links",children:[t.jsxs("button",{className:"planet-hero-link",onClick:w,children:[e("pages.planet.viewStats")," ‚Üì"]}),c.hostname&&t.jsx(gt,{to:`/stars/${vt(c.hostname)}`,className:"planet-hero-link",children:e("pages.planet.viewSystem",{hostname:c.hostname})})]})]})]}),t.jsxs("div",{className:"planet-content",ref:R,children:[t.jsx(q,{title:e("pages.planet.sections.earthComparison"),className:"section-comparison",children:t.jsx(we,{planet:c})}),c.has_rv_data?t.jsx(q,{title:e("pages.planet.sections.radialVelocity"),className:"section-rv",children:t.jsx(Pe,{planet:c,siblings:M})}):c.is_transiting||c.pl_trandep!==null&&c.pl_orbper!==null?t.jsx(q,{title:e("pages.planet.sections.transitDetection"),className:"section-transit",children:t.jsx(Ue,{planet:c,siblings:M})}):null,t.jsxs("div",{className:"planet-section-row",children:[t.jsx(q,{title:e("pages.planet.sections.habitability"),className:"section-habitability",children:t.jsx(Te,{planet:c})}),t.jsx(q,{title:e("pages.planet.sections.temperature"),className:"section-temperature",children:t.jsx(ze,{planet:c})})]}),t.jsx(q,{title:e("pages.planet.sections.orbitalPosition"),className:"section-orbital",children:t.jsx(Ee,{planet:c,siblings:M})}),c.distance_ly&&c.distance_ly>0&&t.jsx(q,{title:e("pages.planet.sections.travelTime"),className:"section-travel",children:t.jsx(Ze,{distanceLy:c.distance_ly})}),t.jsx(q,{className:"section-details",children:t.jsx(ye,{planet:c})}),M.length>1&&t.jsx(q,{className:"section-siblings",children:t.jsx(Ce,{currentPlanet:c,siblings:M})})]})]}):t.jsx("div",{className:"planet-page",children:t.jsxs("div",{className:"planet-not-found",children:[t.jsx("h1",{children:e("pages.planet.notFound.title")}),t.jsx("p",{children:e("pages.planet.notFound.message",{planetId:a||""})}),t.jsx(gt,{to:"/planets",className:"planet-back-link",children:e("pages.planet.notFound.browseAll")})]})})}export{na as default};
