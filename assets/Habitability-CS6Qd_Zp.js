import{r as ie,j as T,u as Je,b as Ps,n as tr,L as Bs,a as Is,S as Gs}from"./index-cXPqB-ye.js";import{R as js,I as So,g as ga,h as ci,i as Vt,W as zs,j as Un,S as Ci,V as We,k as Ws,U as ui,l as ma,m as qt,M as _r,n as kt,o as Hs,p as ko,q as Vs,u as Di,C as lt,r as Xs,s as Ys,t as qs,v as Ks,w as Zs,x as Js,T as $s,y as va,z as Qs,D as el,P as Fi,B as Kr,A as tl,b as nl,d as rl}from"./react-three-fiber.esm-DFW69tPz.js";import{_ as fi,O as il}from"./OrbitControls-BmvKRAgT.js";const al=t=>typeof t=="object"&&typeof t.then=="function",Wn=[];function ol(t,e,i=(o,r)=>o===r){if(t===e)return!0;if(!t||!e)return!1;const o=t.length;if(e.length!==o)return!1;for(let r=0;r<o;r++)if(!i(t[r],e[r]))return!1;return!0}function sl(t,e=null,i=!1,o={}){e===null&&(e=[t]);for(const n of Wn)if(ol(e,n.keys,n.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(n,"error"))throw n.error;if(Object.prototype.hasOwnProperty.call(n,"response"))return o.lifespan&&o.lifespan>0&&(n.timeout&&clearTimeout(n.timeout),n.timeout=setTimeout(n.remove,o.lifespan)),n.response;if(!i)throw n.promise}const r={keys:e,equal:o.equal,remove:()=>{const n=Wn.indexOf(r);n!==-1&&Wn.splice(n,1)},promise:(al(t)?t:t(...e)).then(n=>{r.response=n,o.lifespan&&o.lifespan>0&&(r.timeout=setTimeout(r.remove,o.lifespan))}).catch(n=>r.error=n)};if(Wn.push(r),!i)throw r.promise}const ll=(t,e,i)=>sl(t,e,!1,i),Ao=parseInt(js.replace(/\D+/g,"")),To=Ao>=125?"uv1":"uv2",ya=new Un,Hn=new We;class Ri extends So{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],i=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],o=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(o),this.setAttribute("position",new ga(e,3)),this.setAttribute("uv",new ga(i,2))}applyMatrix4(e){const i=this.attributes.instanceStart,o=this.attributes.instanceEnd;return i!==void 0&&(i.applyMatrix4(e),o.applyMatrix4(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let i;e instanceof Float32Array?i=e:Array.isArray(e)&&(i=new Float32Array(e));const o=new ci(i,6,1);return this.setAttribute("instanceStart",new Vt(o,3,0)),this.setAttribute("instanceEnd",new Vt(o,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,i=3){let o;e instanceof Float32Array?o=e:Array.isArray(e)&&(o=new Float32Array(e));const r=new ci(o,i*2,1);return this.setAttribute("instanceColorStart",new Vt(r,i,0)),this.setAttribute("instanceColorEnd",new Vt(r,i,i)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new zs(e.geometry)),this}fromLineSegments(e){const i=e.geometry;return this.setPositions(i.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Un);const e=this.attributes.instanceStart,i=this.attributes.instanceEnd;e!==void 0&&i!==void 0&&(this.boundingBox.setFromBufferAttribute(e),ya.setFromBufferAttribute(i),this.boundingBox.union(ya))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Ci),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,i=this.attributes.instanceEnd;if(e!==void 0&&i!==void 0){const o=this.boundingSphere.center;this.boundingBox.getCenter(o);let r=0;for(let n=0,a=e.count;n<a;n++)Hn.fromBufferAttribute(e,n),r=Math.max(r,o.distanceToSquared(Hn)),Hn.fromBufferAttribute(i,n),r=Math.max(r,o.distanceToSquared(Hn));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class Uo extends Ri{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const i=e.length-3,o=new Float32Array(2*i);for(let r=0;r<i;r+=3)o[2*r]=e[r],o[2*r+1]=e[r+1],o[2*r+2]=e[r+2],o[2*r+3]=e[r+3],o[2*r+4]=e[r+4],o[2*r+5]=e[r+5];return super.setPositions(o),this}setColors(e,i=3){const o=e.length-i,r=new Float32Array(2*o);if(i===3)for(let n=0;n<o;n+=i)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5];else for(let n=0;n<o;n+=i)r[2*n]=e[n],r[2*n+1]=e[n+1],r[2*n+2]=e[n+2],r[2*n+3]=e[n+3],r[2*n+4]=e[n+4],r[2*n+5]=e[n+5],r[2*n+6]=e[n+6],r[2*n+7]=e[n+7];return super.setColors(r,i),this}fromLine(e){const i=e.geometry;return this.setPositions(i.attributes.position.array),this}}class Li extends Ws{constructor(e){super({type:"LineMaterial",uniforms:ui.clone(ui.merge([ma.common,ma.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new qt(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${Ao>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(i){this.uniforms.diffuse.value=i}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(i){i===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(i){this.uniforms.linewidth.value=i}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(i){!!i!="USE_DASH"in this.defines&&(this.needsUpdate=!0),i===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(i){this.uniforms.dashScale.value=i}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(i){this.uniforms.dashSize.value=i}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(i){this.uniforms.dashOffset.value=i}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(i){this.uniforms.gapSize.value=i}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(i){this.uniforms.opacity.value=i}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(i){this.uniforms.resolution.value.copy(i)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(i){!!i!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),i===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const Zr=new kt,ba=new We,xa=new We,Ne=new kt,Oe=new kt,at=new kt,Jr=new We,$r=new ko,Be=new Hs,_a=new We,Vn=new Un,Xn=new Ci,ot=new kt;let ct,Dt;function wa(t,e,i){return ot.set(0,0,-e,1).applyMatrix4(t.projectionMatrix),ot.multiplyScalar(1/ot.w),ot.x=Dt/i.width,ot.y=Dt/i.height,ot.applyMatrix4(t.projectionMatrixInverse),ot.multiplyScalar(1/ot.w),Math.abs(Math.max(ot.x,ot.y))}function cl(t,e){const i=t.matrixWorld,o=t.geometry,r=o.attributes.instanceStart,n=o.attributes.instanceEnd,a=Math.min(o.instanceCount,r.count);for(let s=0,l=a;s<l;s++){Be.start.fromBufferAttribute(r,s),Be.end.fromBufferAttribute(n,s),Be.applyMatrix4(i);const c=new We,u=new We;ct.distanceSqToSegment(Be.start,Be.end,u,c),u.distanceTo(c)<Dt*.5&&e.push({point:u,pointOnLine:c,distance:ct.origin.distanceTo(u),object:t,face:null,faceIndex:s,uv:null,[To]:null})}}function ul(t,e,i){const o=e.projectionMatrix,n=t.material.resolution,a=t.matrixWorld,s=t.geometry,l=s.attributes.instanceStart,c=s.attributes.instanceEnd,u=Math.min(s.instanceCount,l.count),f=-e.near;ct.at(1,at),at.w=1,at.applyMatrix4(e.matrixWorldInverse),at.applyMatrix4(o),at.multiplyScalar(1/at.w),at.x*=n.x/2,at.y*=n.y/2,at.z=0,Jr.copy(at),$r.multiplyMatrices(e.matrixWorldInverse,a);for(let h=0,d=u;h<d;h++){if(Ne.fromBufferAttribute(l,h),Oe.fromBufferAttribute(c,h),Ne.w=1,Oe.w=1,Ne.applyMatrix4($r),Oe.applyMatrix4($r),Ne.z>f&&Oe.z>f)continue;if(Ne.z>f){const m=Ne.z-Oe.z,y=(Ne.z-f)/m;Ne.lerp(Oe,y)}else if(Oe.z>f){const m=Oe.z-Ne.z,y=(Oe.z-f)/m;Oe.lerp(Ne,y)}Ne.applyMatrix4(o),Oe.applyMatrix4(o),Ne.multiplyScalar(1/Ne.w),Oe.multiplyScalar(1/Oe.w),Ne.x*=n.x/2,Ne.y*=n.y/2,Oe.x*=n.x/2,Oe.y*=n.y/2,Be.start.copy(Ne),Be.start.z=0,Be.end.copy(Oe),Be.end.z=0;const g=Be.closestPointToPointParameter(Jr,!0);Be.at(g,_a);const v=Vs.lerp(Ne.z,Oe.z,g),w=v>=-1&&v<=1,_=Jr.distanceTo(_a)<Dt*.5;if(w&&_){Be.start.fromBufferAttribute(l,h),Be.end.fromBufferAttribute(c,h),Be.start.applyMatrix4(a),Be.end.applyMatrix4(a);const m=new We,y=new We;ct.distanceSqToSegment(Be.start,Be.end,y,m),i.push({point:y,pointOnLine:m,distance:ct.origin.distanceTo(y),object:t,face:null,faceIndex:h,uv:null,[To]:null})}}}class Eo extends _r{constructor(e=new Ri,i=new Li({color:Math.random()*16777215})){super(e,i),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,i=e.attributes.instanceStart,o=e.attributes.instanceEnd,r=new Float32Array(2*i.count);for(let a=0,s=0,l=i.count;a<l;a++,s+=2)ba.fromBufferAttribute(i,a),xa.fromBufferAttribute(o,a),r[s]=s===0?0:r[s-1],r[s+1]=r[s]+ba.distanceTo(xa);const n=new ci(r,2,1);return e.setAttribute("instanceDistanceStart",new Vt(n,1,0)),e.setAttribute("instanceDistanceEnd",new Vt(n,1,1)),this}raycast(e,i){const o=this.material.worldUnits,r=e.camera;r===null&&!o&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const n=e.params.Line2!==void 0&&e.params.Line2.threshold||0;ct=e.ray;const a=this.matrixWorld,s=this.geometry,l=this.material;Dt=l.linewidth+n,s.boundingSphere===null&&s.computeBoundingSphere(),Xn.copy(s.boundingSphere).applyMatrix4(a);let c;if(o)c=Dt*.5;else{const f=Math.max(r.near,Xn.distanceToPoint(ct.origin));c=wa(r,f,l.resolution)}if(Xn.radius+=c,ct.intersectsSphere(Xn)===!1)return;s.boundingBox===null&&s.computeBoundingBox(),Vn.copy(s.boundingBox).applyMatrix4(a);let u;if(o)u=Dt*.5;else{const f=Math.max(r.near,Vn.distanceToPoint(ct.origin));u=wa(r,f,l.resolution)}Vn.expandByScalar(u),ct.intersectsBox(Vn)!==!1&&(o?cl(this,i):ul(this,r,i))}onBeforeRender(e){const i=this.material.uniforms;i&&i.resolution&&(e.getViewport(Zr),this.material.uniforms.resolution.value.set(Zr.z,Zr.w))}}class fl extends Eo{constructor(e=new Uo,i=new Li({color:Math.random()*16777215})){super(e,i),this.isLine2=!0,this.type="Line2"}}const nr=ie.forwardRef(function({points:e,color:i=16777215,vertexColors:o,linewidth:r,lineWidth:n,segments:a,dashed:s,...l},c){var u,f;const h=Di(w=>w.size),d=ie.useMemo(()=>a?new Eo:new fl,[a]),[p]=ie.useState(()=>new Li),g=(o==null||(u=o[0])==null?void 0:u.length)===4?4:3,v=ie.useMemo(()=>{const w=a?new Ri:new Uo,_=e.map(m=>{const y=Array.isArray(m);return m instanceof We||m instanceof kt?[m.x,m.y,m.z]:m instanceof qt?[m.x,m.y,0]:y&&m.length===3?[m[0],m[1],m[2]]:y&&m.length===2?[m[0],m[1],0]:m});if(w.setPositions(_.flat()),o){i=16777215;const m=o.map(y=>y instanceof lt?y.toArray():y);w.setColors(m.flat(),g)}return w},[e,a,o,g]);return ie.useLayoutEffect(()=>{d.computeLineDistances()},[e,d]),ie.useLayoutEffect(()=>{s?p.defines.USE_DASH="":delete p.defines.USE_DASH,p.needsUpdate=!0},[s,p]),ie.useEffect(()=>()=>{v.dispose(),p.dispose()},[v]),ie.createElement("primitive",fi({object:d,ref:c},l),ie.createElement("primitive",{object:v,attach:"geometry"}),ie.createElement("primitive",fi({object:p,attach:"material",color:i,vertexColors:!!o,resolution:[h.width,h.height],linewidth:(f=r??n)!==null&&f!==void 0?f:1,dashed:s,transparent:g===4},l)))});function hl(){var t=Object.create(null);function e(r,n){var a=r.id,s=r.name,l=r.dependencies;l===void 0&&(l=[]);var c=r.init;c===void 0&&(c=function(){});var u=r.getTransferables;if(u===void 0&&(u=null),!t[a])try{l=l.map(function(h){return h&&h.isWorkerModule&&(e(h,function(d){if(d instanceof Error)throw d}),h=t[h.id].value),h}),c=o("<"+s+">.init",c),u&&(u=o("<"+s+">.getTransferables",u));var f=null;typeof c=="function"?f=c.apply(void 0,l):console.error("worker module init function failed to rehydrate"),t[a]={id:a,value:f,getTransferables:u},n(f)}catch(h){h&&h.noLog||console.error(h),n(h)}}function i(r,n){var a,s=r.id,l=r.args;(!t[s]||typeof t[s].value!="function")&&n(new Error("Worker module "+s+": not found or its 'init' did not return a function"));try{var c=(a=t[s]).value.apply(a,l);c&&typeof c.then=="function"?c.then(u,function(f){return n(f instanceof Error?f:new Error(""+f))}):u(c)}catch(f){n(f)}function u(f){try{var h=t[s].getTransferables&&t[s].getTransferables(f);(!h||!Array.isArray(h)||!h.length)&&(h=void 0),n(f,h)}catch(d){console.error(d),n(d)}}}function o(r,n){var a=void 0;self.troikaDefine=function(l){return a=l};var s=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+` **/

troikaDefine(
`+n+`
)`],{type:"application/javascript"}));try{importScripts(s)}catch(l){console.error(l)}return URL.revokeObjectURL(s),delete self.troikaDefine,a}self.addEventListener("message",function(r){var n=r.data,a=n.messageId,s=n.action,l=n.data;try{s==="registerModule"&&e(l,function(c){c instanceof Error?postMessage({messageId:a,success:!1,error:c.message}):postMessage({messageId:a,success:!0,result:{isCallable:typeof c=="function"}})}),s==="callModule"&&i(l,function(c,u){c instanceof Error?postMessage({messageId:a,success:!1,error:c.message}):postMessage({messageId:a,success:!0,result:c},u||void 0)})}catch(c){postMessage({messageId:a,success:!1,error:c.stack})}})}function dl(t){var e=function(){for(var i=[],o=arguments.length;o--;)i[o]=arguments[o];return e._getInitResult().then(function(r){if(typeof r=="function")return r.apply(void 0,i);throw new Error("Worker module function was called but `init` did not return a callable function")})};return e._getInitResult=function(){var i=t.dependencies,o=t.init;i=Array.isArray(i)?i.map(function(n){return n&&(n=n.onMainThread||n,n._getInitResult&&(n=n._getInitResult())),n}):[];var r=Promise.all(i).then(function(n){return o.apply(null,n)});return e._getInitResult=function(){return r},r},e}var Mo=function(){var t=!1;if(typeof window<"u"&&typeof window.document<"u")try{var e=new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"})));e.terminate(),t=!0}catch(i){console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+i.message+"]")}return Mo=function(){return t},t},pl=0,gl=0,Qr=!1,yn=Object.create(null),bn=Object.create(null),hi=Object.create(null);function Qt(t){if((!t||typeof t.init!="function")&&!Qr)throw new Error("requires `options.init` function");var e=t.dependencies,i=t.init,o=t.getTransferables,r=t.workerId,n=dl(t);r==null&&(r="#default");var a="workerModule"+ ++pl,s=t.name||a,l=null;e=e&&e.map(function(u){return typeof u=="function"&&!u.workerModuleData&&(Qr=!0,u=Qt({workerId:r,name:"<"+s+"> function dependency: "+u.name,init:`function(){return (
`+rr(u)+`
)}`}),Qr=!1),u&&u.workerModuleData&&(u=u.workerModuleData),u});function c(){for(var u=[],f=arguments.length;f--;)u[f]=arguments[f];if(!Mo())return n.apply(void 0,u);if(!l){l=Sa(r,"registerModule",c.workerModuleData);var h=function(){l=null,bn[r].delete(h)};(bn[r]||(bn[r]=new Set)).add(h)}return l.then(function(d){var p=d.isCallable;if(p)return Sa(r,"callModule",{id:a,args:u});throw new Error("Worker module function was called but `init` did not return a callable function")})}return c.workerModuleData={isWorkerModule:!0,id:a,name:s,dependencies:e,init:rr(i),getTransferables:o&&rr(o)},c.onMainThread=n,c}function ml(t){bn[t]&&bn[t].forEach(function(e){e()}),yn[t]&&(yn[t].terminate(),delete yn[t])}function rr(t){var e=t.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function vl(t){var e=yn[t];if(!e){var i=rr(hl);e=yn[t]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+t.replace(/\*/g,"")+` **/

;(`+i+")()"],{type:"application/javascript"}))),e.onmessage=function(o){var r=o.data,n=r.messageId,a=hi[n];if(!a)throw new Error("WorkerModule response with empty or unknown messageId");delete hi[n],a(r)}}return e}function Sa(t,e,i){return new Promise(function(o,r){var n=++gl;hi[n]=function(a){a.success?o(a.result):r(new Error("Error in worker "+e+" call: "+a.error))},vl(t).postMessage({messageId:n,action:e,data:i})})}function Co(){var t=function(e){function i(B,I,b,E,R,L,C,W){var P=1-C;W.x=P*P*B+2*P*C*b+C*C*R,W.y=P*P*I+2*P*C*E+C*C*L}function o(B,I,b,E,R,L,C,W,P,j){var Z=1-P;j.x=Z*Z*Z*B+3*Z*Z*P*b+3*Z*P*P*R+P*P*P*C,j.y=Z*Z*Z*I+3*Z*Z*P*E+3*Z*P*P*L+P*P*P*W}function r(B,I){for(var b=/([MLQCZ])([^MLQCZ]*)/g,E,R,L,C,W;E=b.exec(B);){var P=E[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map(function(j){return parseFloat(j)});switch(E[1]){case"M":C=R=P[0],W=L=P[1];break;case"L":(P[0]!==C||P[1]!==W)&&I("L",C,W,C=P[0],W=P[1]);break;case"Q":{I("Q",C,W,C=P[2],W=P[3],P[0],P[1]);break}case"C":{I("C",C,W,C=P[4],W=P[5],P[0],P[1],P[2],P[3]);break}case"Z":(C!==R||W!==L)&&I("L",C,W,R,L);break}}}function n(B,I,b){b===void 0&&(b=16);var E={x:0,y:0};r(B,function(R,L,C,W,P,j,Z,ee,X){switch(R){case"L":I(L,C,W,P);break;case"Q":{for(var H=L,ye=C,de=1;de<b;de++)i(L,C,j,Z,W,P,de/(b-1),E),I(H,ye,E.x,E.y),H=E.x,ye=E.y;break}case"C":{for(var Q=L,ne=C,ue=1;ue<b;ue++)o(L,C,j,Z,ee,X,W,P,ue/(b-1),E),I(Q,ne,E.x,E.y),Q=E.x,ne=E.y;break}}})}var a="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",s="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",l=new WeakMap,c={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function u(B,I){var b=B.getContext?B.getContext("webgl",c):B,E=l.get(b);if(!E){let Z=function(Q){var ne=L[Q];if(!ne&&(ne=L[Q]=b.getExtension(Q),!ne))throw new Error(Q+" not supported");return ne},ee=function(Q,ne){var ue=b.createShader(ne);return b.shaderSource(ue,Q),b.compileShader(ue),ue},X=function(Q,ne,ue,Y){if(!C[Q]){var re={},te={},z=b.createProgram();b.attachShader(z,ee(ne,b.VERTEX_SHADER)),b.attachShader(z,ee(ue,b.FRAGMENT_SHADER)),b.linkProgram(z),C[Q]={program:z,transaction:function($){b.useProgram(z),$({setUniform:function(J,Se){for(var ae=[],se=arguments.length-2;se-- >0;)ae[se]=arguments[se+2];var he=te[Se]||(te[Se]=b.getUniformLocation(z,Se));b["uniform"+J].apply(b,[he].concat(ae))},setAttribute:function(J,Se,ae,se,he){var me=re[J];me||(me=re[J]={buf:b.createBuffer(),loc:b.getAttribLocation(z,J),data:null}),b.bindBuffer(b.ARRAY_BUFFER,me.buf),b.vertexAttribPointer(me.loc,Se,b.FLOAT,!1,0,0),b.enableVertexAttribArray(me.loc),R?b.vertexAttribDivisor(me.loc,se):Z("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(me.loc,se),he!==me.data&&(b.bufferData(b.ARRAY_BUFFER,he,ae),me.data=he)}})}}}C[Q].transaction(Y)},H=function(Q,ne){P++;try{b.activeTexture(b.TEXTURE0+P);var ue=W[Q];ue||(ue=W[Q]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,ue),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST)),b.bindTexture(b.TEXTURE_2D,ue),ne(ue,P)}finally{P--}},ye=function(Q,ne,ue){var Y=b.createFramebuffer();j.push(Y),b.bindFramebuffer(b.FRAMEBUFFER,Y),b.activeTexture(b.TEXTURE0+ne),b.bindTexture(b.TEXTURE_2D,Q),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,Q,0);try{ue(Y)}finally{b.deleteFramebuffer(Y),b.bindFramebuffer(b.FRAMEBUFFER,j[--j.length-1]||null)}},de=function(){L={},C={},W={},P=-1,j.length=0};var R=typeof WebGL2RenderingContext<"u"&&b instanceof WebGL2RenderingContext,L={},C={},W={},P=-1,j=[];b.canvas.addEventListener("webglcontextlost",function(Q){de(),Q.preventDefault()},!1),l.set(b,E={gl:b,isWebGL2:R,getExtension:Z,withProgram:X,withTexture:H,withTextureFramebuffer:ye,handleContextLoss:de})}I(E)}function f(B,I,b,E,R,L,C,W){C===void 0&&(C=15),W===void 0&&(W=null),u(B,function(P){var j=P.gl,Z=P.withProgram,ee=P.withTexture;ee("copy",function(X,H){j.texImage2D(j.TEXTURE_2D,0,j.RGBA,R,L,0,j.RGBA,j.UNSIGNED_BYTE,I),Z("copy",a,s,function(ye){var de=ye.setUniform,Q=ye.setAttribute;Q("aUV",2,j.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),de("1i","image",H),j.bindFramebuffer(j.FRAMEBUFFER,W||null),j.disable(j.BLEND),j.colorMask(C&8,C&4,C&2,C&1),j.viewport(b,E,R,L),j.scissor(b,E,R,L),j.drawArrays(j.TRIANGLES,0,3)})})})}function h(B,I,b){var E=B.width,R=B.height;u(B,function(L){var C=L.gl,W=new Uint8Array(E*R*4);C.readPixels(0,0,E,R,C.RGBA,C.UNSIGNED_BYTE,W),B.width=I,B.height=b,f(C,W,0,0,E,R)})}var d=Object.freeze({__proto__:null,withWebGLContext:u,renderImageData:f,resizeWebGLCanvasWithoutClearing:h});function p(B,I,b,E,R,L){L===void 0&&(L=1);var C=new Uint8Array(B*I),W=E[2]-E[0],P=E[3]-E[1],j=[];n(b,function(Q,ne,ue,Y){j.push({x1:Q,y1:ne,x2:ue,y2:Y,minX:Math.min(Q,ue),minY:Math.min(ne,Y),maxX:Math.max(Q,ue),maxY:Math.max(ne,Y)})}),j.sort(function(Q,ne){return Q.maxX-ne.maxX});for(var Z=0;Z<B;Z++)for(var ee=0;ee<I;ee++){var X=ye(E[0]+W*(Z+.5)/B,E[1]+P*(ee+.5)/I),H=Math.pow(1-Math.abs(X)/R,L)/2;X<0&&(H=1-H),H=Math.max(0,Math.min(255,Math.round(H*255))),C[ee*B+Z]=H}return C;function ye(Q,ne){for(var ue=1/0,Y=1/0,re=j.length;re--;){var te=j[re];if(te.maxX+Y<=Q)break;if(Q+Y>te.minX&&ne-Y<te.maxY&&ne+Y>te.minY){var z=w(Q,ne,te.x1,te.y1,te.x2,te.y2);z<ue&&(ue=z,Y=Math.sqrt(ue))}}return de(Q,ne)&&(Y=-Y),Y}function de(Q,ne){for(var ue=0,Y=j.length;Y--;){var re=j[Y];if(re.maxX<=Q)break;var te=re.y1>ne!=re.y2>ne&&Q<(re.x2-re.x1)*(ne-re.y1)/(re.y2-re.y1)+re.x1;te&&(ue+=re.y1<re.y2?1:-1)}return ue!==0}}function g(B,I,b,E,R,L,C,W,P,j){L===void 0&&(L=1),W===void 0&&(W=0),P===void 0&&(P=0),j===void 0&&(j=0),v(B,I,b,E,R,L,C,null,W,P,j)}function v(B,I,b,E,R,L,C,W,P,j,Z){L===void 0&&(L=1),P===void 0&&(P=0),j===void 0&&(j=0),Z===void 0&&(Z=0);for(var ee=p(B,I,b,E,R,L),X=new Uint8Array(ee.length*4),H=0;H<ee.length;H++)X[H*4+Z]=ee[H];f(C,X,P,j,B,I,1<<3-Z,W)}function w(B,I,b,E,R,L){var C=R-b,W=L-E,P=C*C+W*W,j=P?Math.max(0,Math.min(1,((B-b)*C+(I-E)*W)/P)):0,Z=B-(b+j*C),ee=I-(E+j*W);return Z*Z+ee*ee}var _=Object.freeze({__proto__:null,generate:p,generateIntoCanvas:g,generateIntoFramebuffer:v}),m="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",y="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",S="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",D=new Float32Array([0,0,2,0,0,2]),A=null,M=!1,O={},F=new WeakMap;function N(B){if(!M&&!V(B))throw new Error("WebGL generation not supported")}function x(B,I,b,E,R,L,C){if(L===void 0&&(L=1),C===void 0&&(C=null),!C&&(C=A,!C)){var W=typeof OffscreenCanvas=="function"?new OffscreenCanvas(1,1):typeof document<"u"?document.createElement("canvas"):null;if(!W)throw new Error("OffscreenCanvas or DOM canvas not supported");C=A=W.getContext("webgl",{depth:!1})}N(C);var P=new Uint8Array(B*I*4);u(C,function(X){var H=X.gl,ye=X.withTexture,de=X.withTextureFramebuffer;ye("readable",function(Q,ne){H.texImage2D(H.TEXTURE_2D,0,H.RGBA,B,I,0,H.RGBA,H.UNSIGNED_BYTE,null),de(Q,ne,function(ue){U(B,I,b,E,R,L,H,ue,0,0,0),H.readPixels(0,0,B,I,H.RGBA,H.UNSIGNED_BYTE,P)})})});for(var j=new Uint8Array(B*I),Z=0,ee=0;Z<P.length;Z+=4)j[ee++]=P[Z];return j}function k(B,I,b,E,R,L,C,W,P,j){L===void 0&&(L=1),W===void 0&&(W=0),P===void 0&&(P=0),j===void 0&&(j=0),U(B,I,b,E,R,L,C,null,W,P,j)}function U(B,I,b,E,R,L,C,W,P,j,Z){L===void 0&&(L=1),P===void 0&&(P=0),j===void 0&&(j=0),Z===void 0&&(Z=0),N(C);var ee=[];n(b,function(X,H,ye,de){ee.push(X,H,ye,de)}),ee=new Float32Array(ee),u(C,function(X){var H=X.gl,ye=X.isWebGL2,de=X.getExtension,Q=X.withProgram,ne=X.withTexture,ue=X.withTextureFramebuffer,Y=X.handleContextLoss;if(ne("rawDistances",function(re,te){(B!==re._lastWidth||I!==re._lastHeight)&&H.texImage2D(H.TEXTURE_2D,0,H.RGBA,re._lastWidth=B,re._lastHeight=I,0,H.RGBA,H.UNSIGNED_BYTE,null),Q("main",m,y,function(z){var ge=z.setAttribute,$=z.setUniform,oe=!ye&&de("ANGLE_instanced_arrays"),J=!ye&&de("EXT_blend_minmax");ge("aUV",2,H.STATIC_DRAW,0,D),ge("aLineSegment",4,H.DYNAMIC_DRAW,1,ee),$.apply(void 0,["4f","uGlyphBounds"].concat(E)),$("1f","uMaxDistance",R),$("1f","uExponent",L),ue(re,te,function(Se){H.enable(H.BLEND),H.colorMask(!0,!0,!0,!0),H.viewport(0,0,B,I),H.scissor(0,0,B,I),H.blendFunc(H.ONE,H.ONE),H.blendEquationSeparate(H.FUNC_ADD,ye?H.MAX:J.MAX_EXT),H.clear(H.COLOR_BUFFER_BIT),ye?H.drawArraysInstanced(H.TRIANGLES,0,3,ee.length/4):oe.drawArraysInstancedANGLE(H.TRIANGLES,0,3,ee.length/4)})}),Q("post",a,S,function(z){z.setAttribute("aUV",2,H.STATIC_DRAW,0,D),z.setUniform("1i","tex",te),H.bindFramebuffer(H.FRAMEBUFFER,W),H.disable(H.BLEND),H.colorMask(Z===0,Z===1,Z===2,Z===3),H.viewport(P,j,B,I),H.scissor(P,j,B,I),H.drawArrays(H.TRIANGLES,0,3)})}),H.isContextLost())throw Y(),new Error("webgl context lost")})}function V(B){var I=!B||B===A?O:B.canvas||B,b=F.get(I);if(b===void 0){M=!0;var E=null;try{var R=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],L=x(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,B);b=L&&R.length===L.length&&L.every(function(C,W){return C===R[W]}),b||(E="bad trial run results",console.info(R,L))}catch(C){b=!1,E=C.message}E&&console.warn("WebGL SDF generation not supported:",E),M=!1,F.set(I,b)}return b}var G=Object.freeze({__proto__:null,generate:x,generateIntoCanvas:k,generateIntoFramebuffer:U,isSupported:V});function q(B,I,b,E,R,L){R===void 0&&(R=Math.max(E[2]-E[0],E[3]-E[1])/2),L===void 0&&(L=1);try{return x.apply(G,arguments)}catch(C){return console.info("WebGL SDF generation failed, falling back to JS",C),p.apply(_,arguments)}}function K(B,I,b,E,R,L,C,W,P,j){R===void 0&&(R=Math.max(E[2]-E[0],E[3]-E[1])/2),L===void 0&&(L=1),W===void 0&&(W=0),P===void 0&&(P=0),j===void 0&&(j=0);try{return k.apply(G,arguments)}catch(Z){return console.info("WebGL SDF generation failed, falling back to JS",Z),g.apply(_,arguments)}}return e.forEachPathCommand=r,e.generate=q,e.generateIntoCanvas=K,e.javascript=_,e.pathToLineSegments=n,e.webgl=G,e.webglUtils=d,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}function yl(){var t=function(e){var i={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},o={},r={};o.L=1,r[1]="L",Object.keys(i).forEach(function(Y,re){o[Y]=1<<re+1,r[o[Y]]=Y}),Object.freeze(o);var n=o.LRI|o.RLI|o.FSI,a=o.L|o.R|o.AL,s=o.B|o.S|o.WS|o.ON|o.FSI|o.LRI|o.RLI|o.PDI,l=o.BN|o.RLE|o.LRE|o.RLO|o.LRO|o.PDF,c=o.S|o.WS|o.B|n|o.PDI|l,u=null;function f(){if(!u){u=new Map;var Y=function(te){if(i.hasOwnProperty(te)){var z=0;i[te].split(",").forEach(function(ge){var $=ge.split("+"),oe=$[0],J=$[1];oe=parseInt(oe,36),J=J?parseInt(J,36):0,u.set(z+=oe,o[te]);for(var Se=0;Se<J;Se++)u.set(++z,o[te])})}};for(var re in i)Y(re)}}function h(Y){return f(),u.get(Y.codePointAt(0))||o.L}function d(Y){return r[h(Y)]}var p={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function g(Y,re){var te=36,z=0,ge=new Map,$=re&&new Map,oe;return Y.split(",").forEach(function J(Se){if(Se.indexOf("+")!==-1)for(var ae=+Se;ae--;)J(oe);else{oe=Se;var se=Se.split(">"),he=se[0],me=se[1];he=String.fromCodePoint(z+=parseInt(he,te)),me=String.fromCodePoint(z+=parseInt(me,te)),ge.set(he,me),re&&$.set(me,he)}}),{map:ge,reverseMap:$}}var v,w,_;function m(){if(!v){var Y=g(p.pairs,!0),re=Y.map,te=Y.reverseMap;v=re,w=te,_=g(p.canonical,!1).map}}function y(Y){return m(),v.get(Y)||null}function S(Y){return m(),w.get(Y)||null}function D(Y){return m(),_.get(Y)||null}var A=o.L,M=o.R,O=o.EN,F=o.ES,N=o.ET,x=o.AN,k=o.CS,U=o.B,V=o.S,G=o.ON,q=o.BN,K=o.NSM,B=o.AL,I=o.LRO,b=o.RLO,E=o.LRE,R=o.RLE,L=o.PDF,C=o.LRI,W=o.RLI,P=o.FSI,j=o.PDI;function Z(Y,re){for(var te=125,z=new Uint32Array(Y.length),ge=0;ge<Y.length;ge++)z[ge]=h(Y[ge]);var $=new Map;function oe(Ve,et){var Xe=z[Ve];z[Ve]=et,$.set(Xe,$.get(Xe)-1),Xe&s&&$.set(s,$.get(s)-1),$.set(et,($.get(et)||0)+1),et&s&&$.set(s,($.get(s)||0)+1)}for(var J=new Uint8Array(Y.length),Se=new Map,ae=[],se=null,he=0;he<Y.length;he++)se||ae.push(se={start:he,end:Y.length-1,level:re==="rtl"?1:re==="ltr"?0:da(he,!1)}),z[he]&U&&(se.end=he,se=null);for(var me=R|E|b|I|n|j|L|U,Te=function(Ve){return Ve+(Ve&1?1:2)},De=function(Ve){return Ve+(Ve&1?2:1)},be=0;be<ae.length;be++){se=ae[be];var xe=[{_level:se.level,_override:0,_isolate:0}],fe=void 0,Fe=0,Ee=0,He=0;$.clear();for(var Ue=se.start;Ue<=se.end;Ue++){var pe=z[Ue];if(fe=xe[xe.length-1],$.set(pe,($.get(pe)||0)+1),pe&s&&$.set(s,($.get(s)||0)+1),pe&me)if(pe&(R|E)){J[Ue]=fe._level;var ke=(pe===R?De:Te)(fe._level);ke<=te&&!Fe&&!Ee?xe.push({_level:ke,_override:0,_isolate:0}):Fe||Ee++}else if(pe&(b|I)){J[Ue]=fe._level;var yt=(pe===b?De:Te)(fe._level);yt<=te&&!Fe&&!Ee?xe.push({_level:yt,_override:pe&b?M:A,_isolate:0}):Fe||Ee++}else if(pe&n){pe&P&&(pe=da(Ue+1,!0)===1?W:C),J[Ue]=fe._level,fe._override&&oe(Ue,fe._override);var Ae=(pe===W?De:Te)(fe._level);Ae<=te&&Fe===0&&Ee===0?(He++,xe.push({_level:Ae,_override:0,_isolate:1,_isolInitIndex:Ue})):Fe++}else if(pe&j){if(Fe>0)Fe--;else if(He>0){for(Ee=0;!xe[xe.length-1]._isolate;)xe.pop();var _e=xe[xe.length-1]._isolInitIndex;_e!=null&&(Se.set(_e,Ue),Se.set(Ue,_e)),xe.pop(),He--}fe=xe[xe.length-1],J[Ue]=fe._level,fe._override&&oe(Ue,fe._override)}else pe&L?(Fe===0&&(Ee>0?Ee--:!fe._isolate&&xe.length>1&&(xe.pop(),fe=xe[xe.length-1])),J[Ue]=fe._level):pe&U&&(J[Ue]=se.level);else J[Ue]=fe._level,fe._override&&pe!==q&&oe(Ue,fe._override)}for(var Re=[],Me=null,ve=se.start;ve<=se.end;ve++){var Ce=z[ve];if(!(Ce&l)){var je=J[ve],Ie=Ce&n,Le=Ce===j;Me&&je===Me._level?(Me._end=ve,Me._endsWithIsolInit=Ie):Re.push(Me={_start:ve,_end:ve,_level:je,_startsWithPDI:Le,_endsWithIsolInit:Ie})}}for(var $e=[],bt=0;bt<Re.length;bt++){var dt=Re[bt];if(!dt._startsWithPDI||dt._startsWithPDI&&!Se.has(dt._start)){for(var xt=[Me=dt],At=void 0;Me&&Me._endsWithIsolInit&&(At=Se.get(Me._end))!=null;)for(var pt=bt+1;pt<Re.length;pt++)if(Re[pt]._start===At){xt.push(Me=Re[pt]);break}for(var ze=[],Tt=0;Tt<xt.length;Tt++)for(var Yi=xt[Tt],Mr=Yi._start;Mr<=Yi._end;Mr++)ze.push(Mr);for(var Ds=J[ze[0]],qi=se.level,Cn=ze[0]-1;Cn>=0;Cn--)if(!(z[Cn]&l)){qi=J[Cn];break}var Cr=ze[ze.length-1],Fs=J[Cr],Ki=se.level;if(!(z[Cr]&n)){for(var Dn=Cr+1;Dn<=se.end;Dn++)if(!(z[Dn]&l)){Ki=J[Dn];break}}$e.push({_seqIndices:ze,_sosType:Math.max(qi,Ds)%2?M:A,_eosType:Math.max(Ki,Fs)%2?M:A})}}for(var Dr=0;Dr<$e.length;Dr++){var Fr=$e[Dr],le=Fr._seqIndices,en=Fr._sosType,Rs=Fr._eosType,It=J[le[0]]&1?M:A;if($.get(K))for(var Fn=0;Fn<le.length;Fn++){var Zi=le[Fn];if(z[Zi]&K){for(var Rr=en,Rn=Fn-1;Rn>=0;Rn--)if(!(z[le[Rn]]&l)){Rr=z[le[Rn]];break}oe(Zi,Rr&(n|j)?G:Rr)}}if($.get(O))for(var Ln=0;Ln<le.length;Ln++){var Ji=le[Ln];if(z[Ji]&O)for(var Nn=Ln-1;Nn>=-1;Nn--){var $i=Nn===-1?en:z[le[Nn]];if($i&a){$i===B&&oe(Ji,x);break}}}if($.get(B))for(var Lr=0;Lr<le.length;Lr++){var Qi=le[Lr];z[Qi]&B&&oe(Qi,M)}if($.get(F)||$.get(k))for(var tn=1;tn<le.length-1;tn++){var Nr=le[tn];if(z[Nr]&(F|k)){for(var Gt=0,Or=0,Pr=tn-1;Pr>=0&&(Gt=z[le[Pr]],!!(Gt&l));Pr--);for(var Br=tn+1;Br<le.length&&(Or=z[le[Br]],!!(Or&l));Br++);Gt===Or&&(z[Nr]===F?Gt===O:Gt&(O|x))&&oe(Nr,Gt)}}if($.get(O))for(var it=0;it<le.length;it++){var Ls=le[it];if(z[Ls]&O){for(var On=it-1;On>=0&&z[le[On]]&(N|l);On--)oe(le[On],O);for(it++;it<le.length&&z[le[it]]&(N|l|O);it++)z[le[it]]!==O&&oe(le[it],O)}}if($.get(N)||$.get(F)||$.get(k))for(var nn=0;nn<le.length;nn++){var ea=le[nn];if(z[ea]&(N|F|k)){oe(ea,G);for(var Pn=nn-1;Pn>=0&&z[le[Pn]]&l;Pn--)oe(le[Pn],G);for(var Bn=nn+1;Bn<le.length&&z[le[Bn]]&l;Bn++)oe(le[Bn],G)}}if($.get(O))for(var Ir=0,ta=en;Ir<le.length;Ir++){var na=le[Ir],Gr=z[na];Gr&O?ta===A&&oe(na,A):Gr&a&&(ta=Gr)}if($.get(s)){var rn=M|O|x,ra=rn|A,In=[];{for(var jt=[],zt=0;zt<le.length;zt++)if(z[le[zt]]&s){var an=Y[le[zt]],ia=void 0;if(y(an)!==null)if(jt.length<63)jt.push({char:an,seqIndex:zt});else break;else if((ia=S(an))!==null)for(var on=jt.length-1;on>=0;on--){var jr=jt[on].char;if(jr===ia||jr===S(D(an))||y(D(jr))===an){In.push([jt[on].seqIndex,zt]),jt.length=on;break}}}In.sort(function(Ve,et){return Ve[0]-et[0]})}for(var zr=0;zr<In.length;zr++){for(var aa=In[zr],Gn=aa[0],Wr=aa[1],oa=!1,Qe=0,Hr=Gn+1;Hr<Wr;Hr++){var sa=le[Hr];if(z[sa]&ra){oa=!0;var la=z[sa]&rn?M:A;if(la===It){Qe=la;break}}}if(oa&&!Qe){Qe=en;for(var Vr=Gn-1;Vr>=0;Vr--){var ca=le[Vr];if(z[ca]&ra){var ua=z[ca]&rn?M:A;ua!==It?Qe=ua:Qe=It;break}}}if(Qe){if(z[le[Gn]]=z[le[Wr]]=Qe,Qe!==It){for(var sn=Gn+1;sn<le.length;sn++)if(!(z[le[sn]]&l)){h(Y[le[sn]])&K&&(z[le[sn]]=Qe);break}}if(Qe!==It){for(var ln=Wr+1;ln<le.length;ln++)if(!(z[le[ln]]&l)){h(Y[le[ln]])&K&&(z[le[ln]]=Qe);break}}}}for(var _t=0;_t<le.length;_t++)if(z[le[_t]]&s){for(var fa=_t,Xr=_t,Yr=en,cn=_t-1;cn>=0;cn--)if(z[le[cn]]&l)fa=cn;else{Yr=z[le[cn]]&rn?M:A;break}for(var ha=Rs,un=_t+1;un<le.length;un++)if(z[le[un]]&(s|l))Xr=un;else{ha=z[le[un]]&rn?M:A;break}for(var qr=fa;qr<=Xr;qr++)z[le[qr]]=Yr===ha?Yr:It;_t=Xr}}}for(var Ke=se.start;Ke<=se.end;Ke++){var Ns=J[Ke],jn=z[Ke];if(Ns&1?jn&(A|O|x)&&J[Ke]++:jn&M?J[Ke]++:jn&(x|O)&&(J[Ke]+=2),jn&l&&(J[Ke]=Ke===0?se.level:J[Ke-1]),Ke===se.end||h(Y[Ke])&(V|U))for(var zn=Ke;zn>=0&&h(Y[zn])&c;zn--)J[zn]=se.level}}return{levels:J,paragraphs:ae};function da(Ve,et){for(var Xe=Ve;Xe<Y.length;Xe++){var wt=z[Xe];if(wt&(M|B))return 1;if(wt&(U|A)||et&&wt===j)return 0;if(wt&n){var pa=Os(Xe);Xe=pa===-1?Y.length:pa}}return 0}function Os(Ve){for(var et=1,Xe=Ve+1;Xe<Y.length;Xe++){var wt=z[Xe];if(wt&U)break;if(wt&j){if(--et===0)return Xe}else wt&n&&et++}return-1}}var ee="14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",X;function H(){if(!X){var Y=g(ee,!0),re=Y.map,te=Y.reverseMap;te.forEach(function(z,ge){re.set(ge,z)}),X=re}}function ye(Y){return H(),X.get(Y)||null}function de(Y,re,te,z){var ge=Y.length;te=Math.max(0,te==null?0:+te),z=Math.min(ge-1,z==null?ge-1:+z);for(var $=new Map,oe=te;oe<=z;oe++)if(re[oe]&1){var J=ye(Y[oe]);J!==null&&$.set(oe,J)}return $}function Q(Y,re,te,z){var ge=Y.length;te=Math.max(0,te==null?0:+te),z=Math.min(ge-1,z==null?ge-1:+z);var $=[];return re.paragraphs.forEach(function(oe){var J=Math.max(te,oe.start),Se=Math.min(z,oe.end);if(J<Se){for(var ae=re.levels.slice(J,Se+1),se=Se;se>=J&&h(Y[se])&c;se--)ae[se]=oe.level;for(var he=oe.level,me=1/0,Te=0;Te<ae.length;Te++){var De=ae[Te];De>he&&(he=De),De<me&&(me=De|1)}for(var be=he;be>=me;be--)for(var xe=0;xe<ae.length;xe++)if(ae[xe]>=be){for(var fe=xe;xe+1<ae.length&&ae[xe+1]>=be;)xe++;xe>fe&&$.push([fe+J,xe+J])}}}),$}function ne(Y,re,te,z){var ge=ue(Y,re,te,z),$=[].concat(Y);return ge.forEach(function(oe,J){$[J]=(re.levels[oe]&1?ye(Y[oe]):null)||Y[oe]}),$.join("")}function ue(Y,re,te,z){for(var ge=Q(Y,re,te,z),$=[],oe=0;oe<Y.length;oe++)$[oe]=oe;return ge.forEach(function(J){for(var Se=J[0],ae=J[1],se=$.slice(Se,ae+1),he=se.length;he--;)$[ae-he]=se[he]}),$}return e.closingToOpeningBracket=S,e.getBidiCharType=h,e.getBidiCharTypeName=d,e.getCanonicalBracket=D,e.getEmbeddingLevels=Z,e.getMirroredCharacter=ye,e.getMirroredCharactersMap=de,e.getReorderSegments=Q,e.getReorderedIndices=ue,e.getReorderedString=ne,e.openingToClosingBracket=y,Object.defineProperty(e,"__esModule",{value:!0}),e}({});return t}const Do=/\bvoid\s+main\s*\(\s*\)\s*{/g;function di(t){const e=/^[ \t]*#include +<([\w\d./]+)>/gm;function i(o,r){let n=Ks[r];return n?di(n):o}return t.replace(e,i)}const Pe=[];for(let t=0;t<256;t++)Pe[t]=(t<16?"0":"")+t.toString(16);function bl(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(Pe[t&255]+Pe[t>>8&255]+Pe[t>>16&255]+Pe[t>>24&255]+"-"+Pe[e&255]+Pe[e>>8&255]+"-"+Pe[e>>16&15|64]+Pe[e>>24&255]+"-"+Pe[i&63|128]+Pe[i>>8&255]+"-"+Pe[i>>16&255]+Pe[i>>24&255]+Pe[o&255]+Pe[o>>8&255]+Pe[o>>16&255]+Pe[o>>24&255]).toUpperCase()}const Ut=Object.assign||function(){let t=arguments[0];for(let e=1,i=arguments.length;e<i;e++){let o=arguments[e];if(o)for(let r in o)Object.prototype.hasOwnProperty.call(o,r)&&(t[r]=o[r])}return t},xl=Date.now(),ka=new WeakMap,Aa=new Map;let _l=1e10;function pi(t,e){const i=Al(e);let o=ka.get(t);if(o||ka.set(t,o=Object.create(null)),o[i])return new o[i];const r=`_onBeforeCompile${i}`,n=function(c,u){t.onBeforeCompile.call(this,c,u);const f=this.customProgramCacheKey()+"|"+c.vertexShader+"|"+c.fragmentShader;let h=Aa[f];if(!h){const d=wl(this,c,e,i);h=Aa[f]=d}c.vertexShader=h.vertexShader,c.fragmentShader=h.fragmentShader,Ut(c.uniforms,this.uniforms),e.timeUniform&&(c.uniforms[e.timeUniform]={get value(){return Date.now()-xl}}),this[r]&&this[r](c)},a=function(){return s(e.chained?t:t.clone())},s=function(c){const u=Object.create(c,l);return Object.defineProperty(u,"baseMaterial",{value:t}),Object.defineProperty(u,"id",{value:_l++}),u.uuid=bl(),u.uniforms=Ut({},c.uniforms,e.uniforms),u.defines=Ut({},c.defines,e.defines),u.defines[`TROIKA_DERIVED_MATERIAL_${i}`]="",u.extensions=Ut({},c.extensions,e.extensions),u._listeners=void 0,u},l={constructor:{value:a},isDerivedMaterial:{value:!0},type:{get:()=>t.type,set:c=>{t.type=c}},isDerivedFrom:{writable:!0,configurable:!0,value:function(c){const u=this.baseMaterial;return c===u||u.isDerivedMaterial&&u.isDerivedFrom(c)||!1}},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return t.customProgramCacheKey()+"|"+i}},onBeforeCompile:{get(){return n},set(c){this[r]=c}},copy:{writable:!0,configurable:!0,value:function(c){return t.copy.call(this,c),!t.isShaderMaterial&&!t.isDerivedMaterial&&(Ut(this.extensions,c.extensions),Ut(this.defines,c.defines),Ut(this.uniforms,ui.clone(c.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const c=new t.constructor;return s(c).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let c=this._depthMaterial;return c||(c=this._depthMaterial=pi(t.isDerivedMaterial?t.getDepthMaterial():new Ys({depthPacking:qs}),e),c.defines.IS_DEPTH_MATERIAL="",c.uniforms=this.uniforms),c}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let c=this._distanceMaterial;return c||(c=this._distanceMaterial=pi(t.isDerivedMaterial?t.getDistanceMaterial():new Xs,e),c.defines.IS_DISTANCE_MATERIAL="",c.uniforms=this.uniforms),c}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:c,_distanceMaterial:u}=this;c&&c.dispose(),u&&u.dispose(),t.dispose.call(this)}}};return o[i]=a,new a}function wl(t,{vertexShader:e,fragmentShader:i},o,r){let{vertexDefs:n,vertexMainIntro:a,vertexMainOutro:s,vertexTransform:l,fragmentDefs:c,fragmentMainIntro:u,fragmentMainOutro:f,fragmentColorTransform:h,customRewriter:d,timeUniform:p}=o;if(n=n||"",a=a||"",s=s||"",c=c||"",u=u||"",f=f||"",(l||d)&&(e=di(e)),(h||d)&&(i=i.replace(/^[ \t]*#include <((?:tonemapping|encodings|colorspace|fog|premultiplied_alpha|dithering)_fragment)>/gm,`
//!BEGIN_POST_CHUNK $1
$&
//!END_POST_CHUNK
`),i=di(i)),d){let g=d({vertexShader:e,fragmentShader:i});e=g.vertexShader,i=g.fragmentShader}if(h){let g=[];i=i.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,v=>(g.push(v),"")),f=`${h}
${g.join(`
`)}
${f}`}if(p){const g=`
uniform float ${p};
`;n=g+n,c=g+c}return l&&(e=`vec3 troika_position_${r};
vec3 troika_normal_${r};
vec2 troika_uv_${r};
${e}
`,n=`${n}
void troikaVertexTransform${r}(inout vec3 position, inout vec3 normal, inout vec2 uv) {
  ${l}
}
`,a=`
troika_position_${r} = vec3(position);
troika_normal_${r} = vec3(normal);
troika_uv_${r} = vec2(uv);
troikaVertexTransform${r}(troika_position_${r}, troika_normal_${r}, troika_uv_${r});
${a}
`,e=e.replace(/\b(position|normal|uv)\b/g,(g,v,w,_)=>/\battribute\s+vec[23]\s+$/.test(_.substr(0,w))?v:`troika_${v}_${r}`),t.map&&t.map.channel>0||(e=e.replace(/\bMAP_UV\b/g,`troika_uv_${r}`))),e=Ta(e,r,n,a,s),i=Ta(i,r,c,u,f),{vertexShader:e,fragmentShader:i}}function Ta(t,e,i,o,r){return(o||r||i)&&(t=t.replace(Do,`
${i}
void troikaOrigMain${e}() {`),t+=`
void main() {
  ${o}
  troikaOrigMain${e}();
  ${r}
}`),t}function Sl(t,e){return t==="uniforms"?void 0:typeof e=="function"?e.toString():e}let kl=0;const Ua=new Map;function Al(t){const e=JSON.stringify(t,Sl);let i=Ua.get(e);return i==null&&Ua.set(e,i=++kl),i}/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/function Tl(){return typeof window>"u"&&(self.window=self),function(t){var e={parse:function(r){var n=e._bin,a=new Uint8Array(r);if(n.readASCII(a,0,4)=="ttcf"){var s=4;n.readUshort(a,s),s+=2,n.readUshort(a,s),s+=2;var l=n.readUint(a,s);s+=4;for(var c=[],u=0;u<l;u++){var f=n.readUint(a,s);s+=4,c.push(e._readFont(a,f))}return c}return[e._readFont(a,0)]},_readFont:function(r,n){var a=e._bin,s=n;a.readFixed(r,n),n+=4;var l=a.readUshort(r,n);n+=2,a.readUshort(r,n),n+=2,a.readUshort(r,n),n+=2,a.readUshort(r,n),n+=2;for(var c=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],u={_data:r,_offset:s},f={},h=0;h<l;h++){var d=a.readASCII(r,n,4);n+=4,a.readUint(r,n),n+=4;var p=a.readUint(r,n);n+=4;var g=a.readUint(r,n);n+=4,f[d]={offset:p,length:g}}for(h=0;h<c.length;h++){var v=c[h];f[v]&&(u[v.trim()]=e[v.trim()].parse(r,f[v].offset,f[v].length,u))}return u},_tabOffset:function(r,n,a){for(var s=e._bin,l=s.readUshort(r,a+4),c=a+12,u=0;u<l;u++){var f=s.readASCII(r,c,4);c+=4,s.readUint(r,c),c+=4;var h=s.readUint(r,c);if(c+=4,s.readUint(r,c),c+=4,f==n)return h}return 0}};e._bin={readFixed:function(r,n){return(r[n]<<8|r[n+1])+(r[n+2]<<8|r[n+3])/65540},readF2dot14:function(r,n){return e._bin.readShort(r,n)/16384},readInt:function(r,n){return e._bin._view(r).getInt32(n)},readInt8:function(r,n){return e._bin._view(r).getInt8(n)},readShort:function(r,n){return e._bin._view(r).getInt16(n)},readUshort:function(r,n){return e._bin._view(r).getUint16(n)},readUshorts:function(r,n,a){for(var s=[],l=0;l<a;l++)s.push(e._bin.readUshort(r,n+2*l));return s},readUint:function(r,n){return e._bin._view(r).getUint32(n)},readUint64:function(r,n){return 4294967296*e._bin.readUint(r,n)+e._bin.readUint(r,n+4)},readASCII:function(r,n,a){for(var s="",l=0;l<a;l++)s+=String.fromCharCode(r[n+l]);return s},readUnicode:function(r,n,a){for(var s="",l=0;l<a;l++){var c=r[n++]<<8|r[n++];s+=String.fromCharCode(c)}return s},_tdec:typeof window<"u"&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,n,a){var s=e._bin._tdec;return s&&n==0&&a==r.length?s.decode(r):e._bin.readASCII(r,n,a)},readBytes:function(r,n,a){for(var s=[],l=0;l<a;l++)s.push(r[n+l]);return s},readASCIIArray:function(r,n,a){for(var s=[],l=0;l<a;l++)s.push(String.fromCharCode(r[n+l]));return s},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},e._lctf={},e._lctf.parse=function(r,n,a,s,l){var c=e._bin,u={},f=n;c.readFixed(r,n),n+=4;var h=c.readUshort(r,n);n+=2;var d=c.readUshort(r,n);n+=2;var p=c.readUshort(r,n);return n+=2,u.scriptList=e._lctf.readScriptList(r,f+h),u.featureList=e._lctf.readFeatureList(r,f+d),u.lookupList=e._lctf.readLookupList(r,f+p,l),u},e._lctf.readLookupList=function(r,n,a){var s=e._bin,l=n,c=[],u=s.readUshort(r,n);n+=2;for(var f=0;f<u;f++){var h=s.readUshort(r,n);n+=2;var d=e._lctf.readLookupTable(r,l+h,a);c.push(d)}return c},e._lctf.readLookupTable=function(r,n,a){var s=e._bin,l=n,c={tabs:[]};c.ltype=s.readUshort(r,n),n+=2,c.flag=s.readUshort(r,n),n+=2;var u=s.readUshort(r,n);n+=2;for(var f=c.ltype,h=0;h<u;h++){var d=s.readUshort(r,n);n+=2;var p=a(r,f,l+d,c);c.tabs.push(p)}return c},e._lctf.numOfOnes=function(r){for(var n=0,a=0;a<32;a++)r>>>a&1&&n++;return n},e._lctf.readClassDef=function(r,n){var a=e._bin,s=[],l=a.readUshort(r,n);if(n+=2,l==1){var c=a.readUshort(r,n);n+=2;var u=a.readUshort(r,n);n+=2;for(var f=0;f<u;f++)s.push(c+f),s.push(c+f),s.push(a.readUshort(r,n)),n+=2}if(l==2){var h=a.readUshort(r,n);for(n+=2,f=0;f<h;f++)s.push(a.readUshort(r,n)),n+=2,s.push(a.readUshort(r,n)),n+=2,s.push(a.readUshort(r,n)),n+=2}return s},e._lctf.getInterval=function(r,n){for(var a=0;a<r.length;a+=3){var s=r[a],l=r[a+1];if(r[a+2],s<=n&&n<=l)return a}return-1},e._lctf.readCoverage=function(r,n){var a=e._bin,s={};s.fmt=a.readUshort(r,n),n+=2;var l=a.readUshort(r,n);return n+=2,s.fmt==1&&(s.tab=a.readUshorts(r,n,l)),s.fmt==2&&(s.tab=a.readUshorts(r,n,3*l)),s},e._lctf.coverageIndex=function(r,n){var a=r.tab;if(r.fmt==1)return a.indexOf(n);if(r.fmt==2){var s=e._lctf.getInterval(a,n);if(s!=-1)return a[s+2]+(n-a[s])}return-1},e._lctf.readFeatureList=function(r,n){var a=e._bin,s=n,l=[],c=a.readUshort(r,n);n+=2;for(var u=0;u<c;u++){var f=a.readASCII(r,n,4);n+=4;var h=a.readUshort(r,n);n+=2;var d=e._lctf.readFeatureTable(r,s+h);d.tag=f.trim(),l.push(d)}return l},e._lctf.readFeatureTable=function(r,n){var a=e._bin,s=n,l={},c=a.readUshort(r,n);n+=2,c>0&&(l.featureParams=s+c);var u=a.readUshort(r,n);n+=2,l.tab=[];for(var f=0;f<u;f++)l.tab.push(a.readUshort(r,n+2*f));return l},e._lctf.readScriptList=function(r,n){var a=e._bin,s=n,l={},c=a.readUshort(r,n);n+=2;for(var u=0;u<c;u++){var f=a.readASCII(r,n,4);n+=4;var h=a.readUshort(r,n);n+=2,l[f.trim()]=e._lctf.readScriptTable(r,s+h)}return l},e._lctf.readScriptTable=function(r,n){var a=e._bin,s=n,l={},c=a.readUshort(r,n);n+=2,c>0&&(l.default=e._lctf.readLangSysTable(r,s+c));var u=a.readUshort(r,n);n+=2;for(var f=0;f<u;f++){var h=a.readASCII(r,n,4);n+=4;var d=a.readUshort(r,n);n+=2,l[h.trim()]=e._lctf.readLangSysTable(r,s+d)}return l},e._lctf.readLangSysTable=function(r,n){var a=e._bin,s={};a.readUshort(r,n),n+=2,s.reqFeature=a.readUshort(r,n),n+=2;var l=a.readUshort(r,n);return n+=2,s.features=a.readUshorts(r,n,l),s},e.CFF={},e.CFF.parse=function(r,n,a){var s=e._bin;(r=new Uint8Array(r.buffer,n,a))[n=0],r[++n],r[++n],r[++n],n++;var l=[];n=e.CFF.readIndex(r,n,l);for(var c=[],u=0;u<l.length-1;u++)c.push(s.readASCII(r,n+l[u],l[u+1]-l[u]));n+=l[l.length-1];var f=[];n=e.CFF.readIndex(r,n,f);var h=[];for(u=0;u<f.length-1;u++)h.push(e.CFF.readDict(r,n+f[u],n+f[u+1]));n+=f[f.length-1];var d=h[0],p=[];n=e.CFF.readIndex(r,n,p);var g=[];for(u=0;u<p.length-1;u++)g.push(s.readASCII(r,n+p[u],p[u+1]-p[u]));if(n+=p[p.length-1],e.CFF.readSubrs(r,n,d),d.CharStrings){n=d.CharStrings,p=[],n=e.CFF.readIndex(r,n,p);var v=[];for(u=0;u<p.length-1;u++)v.push(s.readBytes(r,n+p[u],p[u+1]-p[u]));d.CharStrings=v}if(d.ROS){n=d.FDArray;var w=[];for(n=e.CFF.readIndex(r,n,w),d.FDArray=[],u=0;u<w.length-1;u++){var _=e.CFF.readDict(r,n+w[u],n+w[u+1]);e.CFF._readFDict(r,_,g),d.FDArray.push(_)}n+=w[w.length-1],n=d.FDSelect,d.FDSelect=[];var m=r[n];if(n++,m!=3)throw m;var y=s.readUshort(r,n);for(n+=2,u=0;u<y+1;u++)d.FDSelect.push(s.readUshort(r,n),r[n+2]),n+=3}return d.Encoding&&(d.Encoding=e.CFF.readEncoding(r,d.Encoding,d.CharStrings.length)),d.charset&&(d.charset=e.CFF.readCharset(r,d.charset,d.CharStrings.length)),e.CFF._readFDict(r,d,g),d},e.CFF._readFDict=function(r,n,a){var s;for(var l in n.Private&&(s=n.Private[1],n.Private=e.CFF.readDict(r,s,s+n.Private[0]),n.Private.Subrs&&e.CFF.readSubrs(r,s+n.Private.Subrs,n.Private)),n)["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(l)!=-1&&(n[l]=a[n[l]-426+35])},e.CFF.readSubrs=function(r,n,a){var s=e._bin,l=[];n=e.CFF.readIndex(r,n,l);var c,u=l.length;c=u<1240?107:u<33900?1131:32768,a.Bias=c,a.Subrs=[];for(var f=0;f<l.length-1;f++)a.Subrs.push(s.readBytes(r,n+l[f],l[f+1]-l[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,n){for(var a=0;a<r.charset.length;a++)if(r.charset[a]==n)return a;return-1},e.CFF.glyphBySE=function(r,n){return n<0||n>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[n])},e.CFF.readEncoding=function(r,n,a){e._bin;var s=[".notdef"],l=r[n];if(n++,l!=0)throw"error: unknown encoding format: "+l;var c=r[n];n++;for(var u=0;u<c;u++)s.push(r[n+u]);return s},e.CFF.readCharset=function(r,n,a){var s=e._bin,l=[".notdef"],c=r[n];if(n++,c==0)for(var u=0;u<a;u++){var f=s.readUshort(r,n);n+=2,l.push(f)}else{if(c!=1&&c!=2)throw"error: format: "+c;for(;l.length<a;){f=s.readUshort(r,n),n+=2;var h=0;for(c==1?(h=r[n],n++):(h=s.readUshort(r,n),n+=2),u=0;u<=h;u++)l.push(f),f++}}return l},e.CFF.readIndex=function(r,n,a){var s=e._bin,l=s.readUshort(r,n)+1,c=r[n+=2];if(n++,c==1)for(var u=0;u<l;u++)a.push(r[n+u]);else if(c==2)for(u=0;u<l;u++)a.push(s.readUshort(r,n+2*u));else if(c==3)for(u=0;u<l;u++)a.push(16777215&s.readUint(r,n+3*u-1));else if(l!=1)throw"unsupported offset size: "+c+", count: "+l;return(n+=l*c)-1},e.CFF.getCharString=function(r,n,a){var s=e._bin,l=r[n],c=r[n+1];r[n+2],r[n+3],r[n+4];var u=1,f=null,h=null;l<=20&&(f=l,u=1),l==12&&(f=100*l+c,u=2),21<=l&&l<=27&&(f=l,u=1),l==28&&(h=s.readShort(r,n+1),u=3),29<=l&&l<=31&&(f=l,u=1),32<=l&&l<=246&&(h=l-139,u=1),247<=l&&l<=250&&(h=256*(l-247)+c+108,u=2),251<=l&&l<=254&&(h=256*-(l-251)-c-108,u=2),l==255&&(h=s.readInt(r,n+1)/65535,u=5),a.val=h??"o"+f,a.size=u},e.CFF.readCharString=function(r,n,a){for(var s=n+a,l=e._bin,c=[];n<s;){var u=r[n],f=r[n+1];r[n+2],r[n+3],r[n+4];var h=1,d=null,p=null;u<=20&&(d=u,h=1),u==12&&(d=100*u+f,h=2),u!=19&&u!=20||(d=u,h=2),21<=u&&u<=27&&(d=u,h=1),u==28&&(p=l.readShort(r,n+1),h=3),29<=u&&u<=31&&(d=u,h=1),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+f+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-f-108,h=2),u==255&&(p=l.readInt(r,n+1)/65535,h=5),c.push(p??"o"+d),n+=h}return c},e.CFF.readDict=function(r,n,a){for(var s=e._bin,l={},c=[];n<a;){var u=r[n],f=r[n+1];r[n+2],r[n+3],r[n+4];var h=1,d=null,p=null;if(u==28&&(p=s.readShort(r,n+1),h=3),u==29&&(p=s.readInt(r,n+1),h=5),32<=u&&u<=246&&(p=u-139,h=1),247<=u&&u<=250&&(p=256*(u-247)+f+108,h=2),251<=u&&u<=254&&(p=256*-(u-251)-f-108,h=2),u==255)throw p=s.readInt(r,n+1)/65535,h=5,"unknown number";if(u==30){var g=[];for(h=1;;){var v=r[n+h];h++;var w=v>>4,_=15&v;if(w!=15&&g.push(w),_!=15&&g.push(_),_==15)break}for(var m="",y=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],S=0;S<g.length;S++)m+=y[g[S]];p=parseFloat(m)}u<=21&&(d=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][u],h=1,u==12&&(d=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],h=2)),d!=null?(l[d]=c.length==1?c[0]:c,c=[]):c.push(p),n+=h}return l},e.cmap={},e.cmap.parse=function(r,n,a){r=new Uint8Array(r.buffer,n,a),n=0;var s=e._bin,l={};s.readUshort(r,n),n+=2;var c=s.readUshort(r,n);n+=2;var u=[];l.tables=[];for(var f=0;f<c;f++){var h=s.readUshort(r,n);n+=2;var d=s.readUshort(r,n);n+=2;var p=s.readUint(r,n);n+=4;var g="p"+h+"e"+d,v=u.indexOf(p);if(v==-1){var w;v=l.tables.length,u.push(p);var _=s.readUshort(r,p);_==0?w=e.cmap.parse0(r,p):_==4?w=e.cmap.parse4(r,p):_==6?w=e.cmap.parse6(r,p):_==12?w=e.cmap.parse12(r,p):console.debug("unknown format: "+_,h,d,p),l.tables.push(w)}if(l[g]!=null)throw"multiple tables for one platform+encoding";l[g]=v}return l},e.cmap.parse0=function(r,n){var a=e._bin,s={};s.format=a.readUshort(r,n),n+=2;var l=a.readUshort(r,n);n+=2,a.readUshort(r,n),n+=2,s.map=[];for(var c=0;c<l-6;c++)s.map.push(r[n+c]);return s},e.cmap.parse4=function(r,n){var a=e._bin,s=n,l={};l.format=a.readUshort(r,n),n+=2;var c=a.readUshort(r,n);n+=2,a.readUshort(r,n),n+=2;var u=a.readUshort(r,n);n+=2;var f=u/2;l.searchRange=a.readUshort(r,n),n+=2,l.entrySelector=a.readUshort(r,n),n+=2,l.rangeShift=a.readUshort(r,n),n+=2,l.endCount=a.readUshorts(r,n,f),n+=2*f,n+=2,l.startCount=a.readUshorts(r,n,f),n+=2*f,l.idDelta=[];for(var h=0;h<f;h++)l.idDelta.push(a.readShort(r,n)),n+=2;for(l.idRangeOffset=a.readUshorts(r,n,f),n+=2*f,l.glyphIdArray=[];n<s+c;)l.glyphIdArray.push(a.readUshort(r,n)),n+=2;return l},e.cmap.parse6=function(r,n){var a=e._bin,s={};s.format=a.readUshort(r,n),n+=2,a.readUshort(r,n),n+=2,a.readUshort(r,n),n+=2,s.firstCode=a.readUshort(r,n),n+=2;var l=a.readUshort(r,n);n+=2,s.glyphIdArray=[];for(var c=0;c<l;c++)s.glyphIdArray.push(a.readUshort(r,n)),n+=2;return s},e.cmap.parse12=function(r,n){var a=e._bin,s={};s.format=a.readUshort(r,n),n+=2,n+=2,a.readUint(r,n),n+=4,a.readUint(r,n),n+=4;var l=a.readUint(r,n);n+=4,s.groups=[];for(var c=0;c<l;c++){var u=n+12*c,f=a.readUint(r,u+0),h=a.readUint(r,u+4),d=a.readUint(r,u+8);s.groups.push([f,h,d])}return s},e.glyf={},e.glyf.parse=function(r,n,a,s){for(var l=[],c=0;c<s.maxp.numGlyphs;c++)l.push(null);return l},e.glyf._parseGlyf=function(r,n){var a=e._bin,s=r._data,l=e._tabOffset(s,"glyf",r._offset)+r.loca[n];if(r.loca[n]==r.loca[n+1])return null;var c={};if(c.noc=a.readShort(s,l),l+=2,c.xMin=a.readShort(s,l),l+=2,c.yMin=a.readShort(s,l),l+=2,c.xMax=a.readShort(s,l),l+=2,c.yMax=a.readShort(s,l),l+=2,c.xMin>=c.xMax||c.yMin>=c.yMax)return null;if(c.noc>0){c.endPts=[];for(var u=0;u<c.noc;u++)c.endPts.push(a.readUshort(s,l)),l+=2;var f=a.readUshort(s,l);if(l+=2,s.length-l<f)return null;c.instructions=a.readBytes(s,l,f),l+=f;var h=c.endPts[c.noc-1]+1;for(c.flags=[],u=0;u<h;u++){var d=s[l];if(l++,c.flags.push(d),(8&d)!=0){var p=s[l];l++;for(var g=0;g<p;g++)c.flags.push(d),u++}}for(c.xs=[],u=0;u<h;u++){var v=(2&c.flags[u])!=0,w=(16&c.flags[u])!=0;v?(c.xs.push(w?s[l]:-s[l]),l++):w?c.xs.push(0):(c.xs.push(a.readShort(s,l)),l+=2)}for(c.ys=[],u=0;u<h;u++)v=(4&c.flags[u])!=0,w=(32&c.flags[u])!=0,v?(c.ys.push(w?s[l]:-s[l]),l++):w?c.ys.push(0):(c.ys.push(a.readShort(s,l)),l+=2);var _=0,m=0;for(u=0;u<h;u++)_+=c.xs[u],m+=c.ys[u],c.xs[u]=_,c.ys[u]=m}else{var y;c.parts=[];do{y=a.readUshort(s,l),l+=2;var S={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(c.parts.push(S),S.glyphIndex=a.readUshort(s,l),l+=2,1&y){var D=a.readShort(s,l);l+=2;var A=a.readShort(s,l);l+=2}else D=a.readInt8(s,l),l++,A=a.readInt8(s,l),l++;2&y?(S.m.tx=D,S.m.ty=A):(S.p1=D,S.p2=A),8&y?(S.m.a=S.m.d=a.readF2dot14(s,l),l+=2):64&y?(S.m.a=a.readF2dot14(s,l),l+=2,S.m.d=a.readF2dot14(s,l),l+=2):128&y&&(S.m.a=a.readF2dot14(s,l),l+=2,S.m.b=a.readF2dot14(s,l),l+=2,S.m.c=a.readF2dot14(s,l),l+=2,S.m.d=a.readF2dot14(s,l),l+=2)}while(32&y);if(256&y){var M=a.readUshort(s,l);for(l+=2,c.instr=[],u=0;u<M;u++)c.instr.push(s[l]),l++}}return c},e.GDEF={},e.GDEF.parse=function(r,n,a,s){var l=n;n+=4;var c=e._bin.readUshort(r,n);return{glyphClassDef:c===0?null:e._lctf.readClassDef(r,l+c)}},e.GPOS={},e.GPOS.parse=function(r,n,a,s){return e._lctf.parse(r,n,a,s,e.GPOS.subt)},e.GPOS.subt=function(r,n,a,s){var l=e._bin,c=a,u={};if(u.fmt=l.readUshort(r,a),a+=2,n==1||n==2||n==3||n==7||n==8&&u.fmt<=2){var f=l.readUshort(r,a);a+=2,u.coverage=e._lctf.readCoverage(r,f+c)}if(n==1&&u.fmt==1){var h=l.readUshort(r,a);a+=2,h!=0&&(u.pos=e.GPOS.readValueRecord(r,a,h))}else if(n==2&&u.fmt>=1&&u.fmt<=2){h=l.readUshort(r,a),a+=2;var d=l.readUshort(r,a);a+=2;var p=e._lctf.numOfOnes(h),g=e._lctf.numOfOnes(d);if(u.fmt==1){u.pairsets=[];var v=l.readUshort(r,a);a+=2;for(var w=0;w<v;w++){var _=c+l.readUshort(r,a);a+=2;var m=l.readUshort(r,_);_+=2;for(var y=[],S=0;S<m;S++){var D=l.readUshort(r,_);_+=2,h!=0&&(x=e.GPOS.readValueRecord(r,_,h),_+=2*p),d!=0&&(k=e.GPOS.readValueRecord(r,_,d),_+=2*g),y.push({gid2:D,val1:x,val2:k})}u.pairsets.push(y)}}if(u.fmt==2){var A=l.readUshort(r,a);a+=2;var M=l.readUshort(r,a);a+=2;var O=l.readUshort(r,a);a+=2;var F=l.readUshort(r,a);for(a+=2,u.classDef1=e._lctf.readClassDef(r,c+A),u.classDef2=e._lctf.readClassDef(r,c+M),u.matrix=[],w=0;w<O;w++){var N=[];for(S=0;S<F;S++){var x=null,k=null;h!=0&&(x=e.GPOS.readValueRecord(r,a,h),a+=2*p),d!=0&&(k=e.GPOS.readValueRecord(r,a,d),a+=2*g),N.push({val1:x,val2:k})}u.matrix.push(N)}}}else if(n==4&&u.fmt==1)u.markCoverage=e._lctf.readCoverage(r,l.readUshort(r,a)+c),u.baseCoverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+c),u.markClassCount=l.readUshort(r,a+4),u.markArray=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+c),u.baseArray=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+c,u.markClassCount);else if(n==6&&u.fmt==1)u.mark1Coverage=e._lctf.readCoverage(r,l.readUshort(r,a)+c),u.mark2Coverage=e._lctf.readCoverage(r,l.readUshort(r,a+2)+c),u.markClassCount=l.readUshort(r,a+4),u.mark1Array=e.GPOS.readMarkArray(r,l.readUshort(r,a+6)+c),u.mark2Array=e.GPOS.readBaseArray(r,l.readUshort(r,a+8)+c,u.markClassCount);else{if(n==9&&u.fmt==1){var U=l.readUshort(r,a);a+=2;var V=l.readUint(r,a);if(a+=4,s.ltype==9)s.ltype=U;else if(s.ltype!=U)throw"invalid extension substitution";return e.GPOS.subt(r,s.ltype,c+V)}console.debug("unsupported GPOS table LookupType",n,"format",u.fmt)}return u},e.GPOS.readValueRecord=function(r,n,a){var s=e._bin,l=[];return l.push(1&a?s.readShort(r,n):0),n+=1&a?2:0,l.push(2&a?s.readShort(r,n):0),n+=2&a?2:0,l.push(4&a?s.readShort(r,n):0),n+=4&a?2:0,l.push(8&a?s.readShort(r,n):0),n+=8&a?2:0,l},e.GPOS.readBaseArray=function(r,n,a){var s=e._bin,l=[],c=n,u=s.readUshort(r,n);n+=2;for(var f=0;f<u;f++){for(var h=[],d=0;d<a;d++)h.push(e.GPOS.readAnchorRecord(r,c+s.readUshort(r,n))),n+=2;l.push(h)}return l},e.GPOS.readMarkArray=function(r,n){var a=e._bin,s=[],l=n,c=a.readUshort(r,n);n+=2;for(var u=0;u<c;u++){var f=e.GPOS.readAnchorRecord(r,a.readUshort(r,n+2)+l);f.markClass=a.readUshort(r,n),s.push(f),n+=4}return s},e.GPOS.readAnchorRecord=function(r,n){var a=e._bin,s={};return s.fmt=a.readUshort(r,n),s.x=a.readShort(r,n+2),s.y=a.readShort(r,n+4),s},e.GSUB={},e.GSUB.parse=function(r,n,a,s){return e._lctf.parse(r,n,a,s,e.GSUB.subt)},e.GSUB.subt=function(r,n,a,s){var l=e._bin,c=a,u={};if(u.fmt=l.readUshort(r,a),a+=2,n!=1&&n!=2&&n!=4&&n!=5&&n!=6)return null;if(n==1||n==2||n==4||n==5&&u.fmt<=2||n==6&&u.fmt<=2){var f=l.readUshort(r,a);a+=2,u.coverage=e._lctf.readCoverage(r,c+f)}if(n==1&&u.fmt>=1&&u.fmt<=2){if(u.fmt==1)u.delta=l.readShort(r,a),a+=2;else if(u.fmt==2){var h=l.readUshort(r,a);a+=2,u.newg=l.readUshorts(r,a,h),a+=2*u.newg.length}}else if(n==2&&u.fmt==1){h=l.readUshort(r,a),a+=2,u.seqs=[];for(var d=0;d<h;d++){var p=l.readUshort(r,a)+c;a+=2;var g=l.readUshort(r,p);u.seqs.push(l.readUshorts(r,p+2,g))}}else if(n==4)for(u.vals=[],h=l.readUshort(r,a),a+=2,d=0;d<h;d++){var v=l.readUshort(r,a);a+=2,u.vals.push(e.GSUB.readLigatureSet(r,c+v))}else if(n==5&&u.fmt==2){if(u.fmt==2){var w=l.readUshort(r,a);a+=2,u.cDef=e._lctf.readClassDef(r,c+w),u.scset=[];var _=l.readUshort(r,a);for(a+=2,d=0;d<_;d++){var m=l.readUshort(r,a);a+=2,u.scset.push(m==0?null:e.GSUB.readSubClassSet(r,c+m))}}}else if(n==6&&u.fmt==3){if(u.fmt==3){for(d=0;d<3;d++){h=l.readUshort(r,a),a+=2;for(var y=[],S=0;S<h;S++)y.push(e._lctf.readCoverage(r,c+l.readUshort(r,a+2*S)));a+=2*h,d==0&&(u.backCvg=y),d==1&&(u.inptCvg=y),d==2&&(u.ahedCvg=y)}h=l.readUshort(r,a),a+=2,u.lookupRec=e.GSUB.readSubstLookupRecords(r,a,h)}}else{if(n==7&&u.fmt==1){var D=l.readUshort(r,a);a+=2;var A=l.readUint(r,a);if(a+=4,s.ltype==9)s.ltype=D;else if(s.ltype!=D)throw"invalid extension substitution";return e.GSUB.subt(r,s.ltype,c+A)}console.debug("unsupported GSUB table LookupType",n,"format",u.fmt)}return u},e.GSUB.readSubClassSet=function(r,n){var a=e._bin.readUshort,s=n,l=[],c=a(r,n);n+=2;for(var u=0;u<c;u++){var f=a(r,n);n+=2,l.push(e.GSUB.readSubClassRule(r,s+f))}return l},e.GSUB.readSubClassRule=function(r,n){var a=e._bin.readUshort,s={},l=a(r,n),c=a(r,n+=2);n+=2,s.input=[];for(var u=0;u<l-1;u++)s.input.push(a(r,n)),n+=2;return s.substLookupRecords=e.GSUB.readSubstLookupRecords(r,n,c),s},e.GSUB.readSubstLookupRecords=function(r,n,a){for(var s=e._bin.readUshort,l=[],c=0;c<a;c++)l.push(s(r,n),s(r,n+2)),n+=4;return l},e.GSUB.readChainSubClassSet=function(r,n){var a=e._bin,s=n,l=[],c=a.readUshort(r,n);n+=2;for(var u=0;u<c;u++){var f=a.readUshort(r,n);n+=2,l.push(e.GSUB.readChainSubClassRule(r,s+f))}return l},e.GSUB.readChainSubClassRule=function(r,n){for(var a=e._bin,s={},l=["backtrack","input","lookahead"],c=0;c<l.length;c++){var u=a.readUshort(r,n);n+=2,c==1&&u--,s[l[c]]=a.readUshorts(r,n,u),n+=2*s[l[c]].length}return u=a.readUshort(r,n),n+=2,s.subst=a.readUshorts(r,n,2*u),n+=2*s.subst.length,s},e.GSUB.readLigatureSet=function(r,n){var a=e._bin,s=n,l=[],c=a.readUshort(r,n);n+=2;for(var u=0;u<c;u++){var f=a.readUshort(r,n);n+=2,l.push(e.GSUB.readLigature(r,s+f))}return l},e.GSUB.readLigature=function(r,n){var a=e._bin,s={chain:[]};s.nglyph=a.readUshort(r,n),n+=2;var l=a.readUshort(r,n);n+=2;for(var c=0;c<l-1;c++)s.chain.push(a.readUshort(r,n)),n+=2;return s},e.head={},e.head.parse=function(r,n,a){var s=e._bin,l={};return s.readFixed(r,n),n+=4,l.fontRevision=s.readFixed(r,n),n+=4,s.readUint(r,n),n+=4,s.readUint(r,n),n+=4,l.flags=s.readUshort(r,n),n+=2,l.unitsPerEm=s.readUshort(r,n),n+=2,l.created=s.readUint64(r,n),n+=8,l.modified=s.readUint64(r,n),n+=8,l.xMin=s.readShort(r,n),n+=2,l.yMin=s.readShort(r,n),n+=2,l.xMax=s.readShort(r,n),n+=2,l.yMax=s.readShort(r,n),n+=2,l.macStyle=s.readUshort(r,n),n+=2,l.lowestRecPPEM=s.readUshort(r,n),n+=2,l.fontDirectionHint=s.readShort(r,n),n+=2,l.indexToLocFormat=s.readShort(r,n),n+=2,l.glyphDataFormat=s.readShort(r,n),n+=2,l},e.hhea={},e.hhea.parse=function(r,n,a){var s=e._bin,l={};return s.readFixed(r,n),n+=4,l.ascender=s.readShort(r,n),n+=2,l.descender=s.readShort(r,n),n+=2,l.lineGap=s.readShort(r,n),n+=2,l.advanceWidthMax=s.readUshort(r,n),n+=2,l.minLeftSideBearing=s.readShort(r,n),n+=2,l.minRightSideBearing=s.readShort(r,n),n+=2,l.xMaxExtent=s.readShort(r,n),n+=2,l.caretSlopeRise=s.readShort(r,n),n+=2,l.caretSlopeRun=s.readShort(r,n),n+=2,l.caretOffset=s.readShort(r,n),n+=2,n+=8,l.metricDataFormat=s.readShort(r,n),n+=2,l.numberOfHMetrics=s.readUshort(r,n),n+=2,l},e.hmtx={},e.hmtx.parse=function(r,n,a,s){for(var l=e._bin,c={aWidth:[],lsBearing:[]},u=0,f=0,h=0;h<s.maxp.numGlyphs;h++)h<s.hhea.numberOfHMetrics&&(u=l.readUshort(r,n),n+=2,f=l.readShort(r,n),n+=2),c.aWidth.push(u),c.lsBearing.push(f);return c},e.kern={},e.kern.parse=function(r,n,a,s){var l=e._bin,c=l.readUshort(r,n);if(n+=2,c==1)return e.kern.parseV1(r,n-2,a,s);var u=l.readUshort(r,n);n+=2;for(var f={glyph1:[],rval:[]},h=0;h<u;h++){n+=2,a=l.readUshort(r,n),n+=2;var d=l.readUshort(r,n);n+=2;var p=d>>>8;if((p&=15)!=0)throw"unknown kern table format: "+p;n=e.kern.readFormat0(r,n,f)}return f},e.kern.parseV1=function(r,n,a,s){var l=e._bin;l.readFixed(r,n),n+=4;var c=l.readUint(r,n);n+=4;for(var u={glyph1:[],rval:[]},f=0;f<c;f++){l.readUint(r,n),n+=4;var h=l.readUshort(r,n);n+=2,l.readUshort(r,n),n+=2;var d=h>>>8;if((d&=15)!=0)throw"unknown kern table format: "+d;n=e.kern.readFormat0(r,n,u)}return u},e.kern.readFormat0=function(r,n,a){var s=e._bin,l=-1,c=s.readUshort(r,n);n+=2,s.readUshort(r,n),n+=2,s.readUshort(r,n),n+=2,s.readUshort(r,n),n+=2;for(var u=0;u<c;u++){var f=s.readUshort(r,n);n+=2;var h=s.readUshort(r,n);n+=2;var d=s.readShort(r,n);n+=2,f!=l&&(a.glyph1.push(f),a.rval.push({glyph2:[],vals:[]}));var p=a.rval[a.rval.length-1];p.glyph2.push(h),p.vals.push(d),l=f}return n},e.loca={},e.loca.parse=function(r,n,a,s){var l=e._bin,c=[],u=s.head.indexToLocFormat,f=s.maxp.numGlyphs+1;if(u==0)for(var h=0;h<f;h++)c.push(l.readUshort(r,n+(h<<1))<<1);if(u==1)for(h=0;h<f;h++)c.push(l.readUint(r,n+(h<<2)));return c},e.maxp={},e.maxp.parse=function(r,n,a){var s=e._bin,l={},c=s.readUint(r,n);return n+=4,l.numGlyphs=s.readUshort(r,n),n+=2,c==65536&&(l.maxPoints=s.readUshort(r,n),n+=2,l.maxContours=s.readUshort(r,n),n+=2,l.maxCompositePoints=s.readUshort(r,n),n+=2,l.maxCompositeContours=s.readUshort(r,n),n+=2,l.maxZones=s.readUshort(r,n),n+=2,l.maxTwilightPoints=s.readUshort(r,n),n+=2,l.maxStorage=s.readUshort(r,n),n+=2,l.maxFunctionDefs=s.readUshort(r,n),n+=2,l.maxInstructionDefs=s.readUshort(r,n),n+=2,l.maxStackElements=s.readUshort(r,n),n+=2,l.maxSizeOfInstructions=s.readUshort(r,n),n+=2,l.maxComponentElements=s.readUshort(r,n),n+=2,l.maxComponentDepth=s.readUshort(r,n),n+=2),l},e.name={},e.name.parse=function(r,n,a){var s=e._bin,l={};s.readUshort(r,n),n+=2;var c=s.readUshort(r,n);n+=2,s.readUshort(r,n);for(var u,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],h=n+=2,d=0;d<c;d++){var p=s.readUshort(r,n);n+=2;var g=s.readUshort(r,n);n+=2;var v=s.readUshort(r,n);n+=2;var w=s.readUshort(r,n);n+=2;var _=s.readUshort(r,n);n+=2;var m=s.readUshort(r,n);n+=2;var y,S=f[w],D=h+12*c+m;if(p==0)y=s.readUnicode(r,D,_/2);else if(p==3&&g==0)y=s.readUnicode(r,D,_/2);else if(g==0)y=s.readASCII(r,D,_);else if(g==1)y=s.readUnicode(r,D,_/2);else if(g==3)y=s.readUnicode(r,D,_/2);else{if(p!=1)throw"unknown encoding "+g+", platformID: "+p;y=s.readASCII(r,D,_),console.debug("reading unknown MAC encoding "+g+" as ASCII")}var A="p"+p+","+v.toString(16);l[A]==null&&(l[A]={}),l[A][S!==void 0?S:w]=y,l[A]._lang=v}for(var M in l)if(l[M].postScriptName!=null&&l[M]._lang==1033)return l[M];for(var M in l)if(l[M].postScriptName!=null&&l[M]._lang==0)return l[M];for(var M in l)if(l[M].postScriptName!=null&&l[M]._lang==3084)return l[M];for(var M in l)if(l[M].postScriptName!=null)return l[M];for(var M in l){u=M;break}return console.debug("returning name table with languageID "+l[u]._lang),l[u]},e["OS/2"]={},e["OS/2"].parse=function(r,n,a){var s=e._bin.readUshort(r,n);n+=2;var l={};if(s==0)e["OS/2"].version0(r,n,l);else if(s==1)e["OS/2"].version1(r,n,l);else if(s==2||s==3||s==4)e["OS/2"].version2(r,n,l);else{if(s!=5)throw"unknown OS/2 table version: "+s;e["OS/2"].version5(r,n,l)}return l},e["OS/2"].version0=function(r,n,a){var s=e._bin;return a.xAvgCharWidth=s.readShort(r,n),n+=2,a.usWeightClass=s.readUshort(r,n),n+=2,a.usWidthClass=s.readUshort(r,n),n+=2,a.fsType=s.readUshort(r,n),n+=2,a.ySubscriptXSize=s.readShort(r,n),n+=2,a.ySubscriptYSize=s.readShort(r,n),n+=2,a.ySubscriptXOffset=s.readShort(r,n),n+=2,a.ySubscriptYOffset=s.readShort(r,n),n+=2,a.ySuperscriptXSize=s.readShort(r,n),n+=2,a.ySuperscriptYSize=s.readShort(r,n),n+=2,a.ySuperscriptXOffset=s.readShort(r,n),n+=2,a.ySuperscriptYOffset=s.readShort(r,n),n+=2,a.yStrikeoutSize=s.readShort(r,n),n+=2,a.yStrikeoutPosition=s.readShort(r,n),n+=2,a.sFamilyClass=s.readShort(r,n),n+=2,a.panose=s.readBytes(r,n,10),n+=10,a.ulUnicodeRange1=s.readUint(r,n),n+=4,a.ulUnicodeRange2=s.readUint(r,n),n+=4,a.ulUnicodeRange3=s.readUint(r,n),n+=4,a.ulUnicodeRange4=s.readUint(r,n),n+=4,a.achVendID=[s.readInt8(r,n),s.readInt8(r,n+1),s.readInt8(r,n+2),s.readInt8(r,n+3)],n+=4,a.fsSelection=s.readUshort(r,n),n+=2,a.usFirstCharIndex=s.readUshort(r,n),n+=2,a.usLastCharIndex=s.readUshort(r,n),n+=2,a.sTypoAscender=s.readShort(r,n),n+=2,a.sTypoDescender=s.readShort(r,n),n+=2,a.sTypoLineGap=s.readShort(r,n),n+=2,a.usWinAscent=s.readUshort(r,n),n+=2,a.usWinDescent=s.readUshort(r,n),n+=2},e["OS/2"].version1=function(r,n,a){var s=e._bin;return n=e["OS/2"].version0(r,n,a),a.ulCodePageRange1=s.readUint(r,n),n+=4,a.ulCodePageRange2=s.readUint(r,n),n+=4},e["OS/2"].version2=function(r,n,a){var s=e._bin;return n=e["OS/2"].version1(r,n,a),a.sxHeight=s.readShort(r,n),n+=2,a.sCapHeight=s.readShort(r,n),n+=2,a.usDefault=s.readUshort(r,n),n+=2,a.usBreak=s.readUshort(r,n),n+=2,a.usMaxContext=s.readUshort(r,n),n+=2},e["OS/2"].version5=function(r,n,a){var s=e._bin;return n=e["OS/2"].version2(r,n,a),a.usLowerOpticalPointSize=s.readUshort(r,n),n+=2,a.usUpperOpticalPointSize=s.readUshort(r,n),n+=2},e.post={},e.post.parse=function(r,n,a){var s=e._bin,l={};return l.version=s.readFixed(r,n),n+=4,l.italicAngle=s.readFixed(r,n),n+=4,l.underlinePosition=s.readShort(r,n),n+=2,l.underlineThickness=s.readShort(r,n),n+=2,l},e==null&&(e={}),e.U==null&&(e.U={}),e.U.codeToGlyph=function(r,n){var a=r.cmap,s=-1;if(a.p0e4!=null?s=a.p0e4:a.p3e1!=null?s=a.p3e1:a.p1e0!=null?s=a.p1e0:a.p0e3!=null&&(s=a.p0e3),s==-1)throw"no familiar platform and encoding!";var l=a.tables[s];if(l.format==0)return n>=l.map.length?0:l.map[n];if(l.format==4){for(var c=-1,u=0;u<l.endCount.length;u++)if(n<=l.endCount[u]){c=u;break}return c==-1||l.startCount[c]>n?0:65535&(l.idRangeOffset[c]!=0?l.glyphIdArray[n-l.startCount[c]+(l.idRangeOffset[c]>>1)-(l.idRangeOffset.length-c)]:n+l.idDelta[c])}if(l.format==12){if(n>l.groups[l.groups.length-1][1])return 0;for(u=0;u<l.groups.length;u++){var f=l.groups[u];if(f[0]<=n&&n<=f[1])return f[2]+(n-f[0])}return 0}throw"unknown cmap table format "+l.format},e.U.glyphToPath=function(r,n){var a={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[n]){var s=r.SVG.entries[n];return s==null?a:(typeof s=="string"&&(s=e.SVG.toPath(s),r.SVG.entries[n]=s),s)}if(r.CFF){var l={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},c=r.CFF,u=r.CFF.Private;if(c.ROS){for(var f=0;c.FDSelect[f+2]<=n;)f+=2;u=c.FDArray[c.FDSelect[f+1]].Private}e.U._drawCFF(r.CFF.CharStrings[n],l,c,u,a)}else r.glyf&&e.U._drawGlyf(n,r,a);return a},e.U._drawGlyf=function(r,n,a){var s=n.glyf[r];s==null&&(s=n.glyf[r]=e.glyf._parseGlyf(n,r)),s!=null&&(s.noc>-1?e.U._simpleGlyph(s,a):e.U._compoGlyph(s,n,a))},e.U._simpleGlyph=function(r,n){for(var a=0;a<r.noc;a++){for(var s=a==0?0:r.endPts[a-1]+1,l=r.endPts[a],c=s;c<=l;c++){var u=c==s?l:c-1,f=c==l?s:c+1,h=1&r.flags[c],d=1&r.flags[u],p=1&r.flags[f],g=r.xs[c],v=r.ys[c];if(c==s)if(h){if(!d){e.U.P.moveTo(n,g,v);continue}e.U.P.moveTo(n,r.xs[u],r.ys[u])}else d?e.U.P.moveTo(n,r.xs[u],r.ys[u]):e.U.P.moveTo(n,(r.xs[u]+g)/2,(r.ys[u]+v)/2);h?d&&e.U.P.lineTo(n,g,v):p?e.U.P.qcurveTo(n,g,v,r.xs[f],r.ys[f]):e.U.P.qcurveTo(n,g,v,(g+r.xs[f])/2,(v+r.ys[f])/2)}e.U.P.closePath(n)}},e.U._compoGlyph=function(r,n,a){for(var s=0;s<r.parts.length;s++){var l={cmds:[],crds:[]},c=r.parts[s];e.U._drawGlyf(c.glyphIndex,n,l);for(var u=c.m,f=0;f<l.crds.length;f+=2){var h=l.crds[f],d=l.crds[f+1];a.crds.push(h*u.a+d*u.b+u.tx),a.crds.push(h*u.c+d*u.d+u.ty)}for(f=0;f<l.cmds.length;f++)a.cmds.push(l.cmds[f])}},e.U._getGlyphClass=function(r,n){var a=e._lctf.getInterval(n,r);return a==-1?0:n[a+2]},e.U._applySubs=function(r,n,a,s){for(var l=r.length-n-1,c=0;c<a.tabs.length;c++)if(a.tabs[c]!=null){var u,f=a.tabs[c];if(!f.coverage||(u=e._lctf.coverageIndex(f.coverage,r[n]))!=-1){if(a.ltype==1)r[n],f.fmt==1?r[n]=r[n]+f.delta:r[n]=f.newg[u];else if(a.ltype==4)for(var h=f.vals[u],d=0;d<h.length;d++){var p=h[d],g=p.chain.length;if(!(g>l)){for(var v=!0,w=0,_=0;_<g;_++){for(;r[n+w+(1+_)]==-1;)w++;p.chain[_]!=r[n+w+(1+_)]&&(v=!1)}if(v){for(r[n]=p.nglyph,_=0;_<g+w;_++)r[n+_+1]=-1;break}}}else if(a.ltype==5&&f.fmt==2)for(var m=e._lctf.getInterval(f.cDef,r[n]),y=f.cDef[m+2],S=f.scset[y],D=0;D<S.length;D++){var A=S[D],M=A.input;if(!(M.length>l)){for(v=!0,_=0;_<M.length;_++){var O=e._lctf.getInterval(f.cDef,r[n+1+_]);if(m==-1&&f.cDef[O+2]!=M[_]){v=!1;break}}if(v){var F=A.substLookupRecords;for(d=0;d<F.length;d+=2)F[d],F[d+1]}}}else if(a.ltype==6&&f.fmt==3){if(!e.U._glsCovered(r,f.backCvg,n-f.backCvg.length)||!e.U._glsCovered(r,f.inptCvg,n)||!e.U._glsCovered(r,f.ahedCvg,n+f.inptCvg.length))continue;var N=f.lookupRec;for(D=0;D<N.length;D+=2){m=N[D];var x=s[N[D+1]];e.U._applySubs(r,n+m,x,s)}}}}},e.U._glsCovered=function(r,n,a){for(var s=0;s<n.length;s++)if(e._lctf.coverageIndex(n[s],r[a+s])==-1)return!1;return!0},e.U.glyphsToPath=function(r,n,a){for(var s={cmds:[],crds:[]},l=0,c=0;c<n.length;c++){var u=n[c];if(u!=-1){for(var f=c<n.length-1&&n[c+1]!=-1?n[c+1]:0,h=e.U.glyphToPath(r,u),d=0;d<h.crds.length;d+=2)s.crds.push(h.crds[d]+l),s.crds.push(h.crds[d+1]);for(a&&s.cmds.push(a),d=0;d<h.cmds.length;d++)s.cmds.push(h.cmds[d]);a&&s.cmds.push("X"),l+=r.hmtx.aWidth[u],c<n.length-1&&(l+=e.U.getPairAdjustment(r,u,f))}}return s},e.U.P={},e.U.P.moveTo=function(r,n,a){r.cmds.push("M"),r.crds.push(n,a)},e.U.P.lineTo=function(r,n,a){r.cmds.push("L"),r.crds.push(n,a)},e.U.P.curveTo=function(r,n,a,s,l,c,u){r.cmds.push("C"),r.crds.push(n,a,s,l,c,u)},e.U.P.qcurveTo=function(r,n,a,s,l){r.cmds.push("Q"),r.crds.push(n,a,s,l)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,n,a,s,l){for(var c=n.stack,u=n.nStems,f=n.haveWidth,h=n.width,d=n.open,p=0,g=n.x,v=n.y,w=0,_=0,m=0,y=0,S=0,D=0,A=0,M=0,O=0,F=0,N={val:0,size:0};p<r.length;){e.CFF.getCharString(r,p,N);var x=N.val;if(p+=N.size,x=="o1"||x=="o18")c.length%2!=0&&!f&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(x=="o3"||x=="o23")c.length%2!=0&&!f&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,f=!0;else if(x=="o4")c.length>1&&!f&&(h=c.shift()+s.nominalWidthX,f=!0),d&&e.U.P.closePath(l),v+=c.pop(),e.U.P.moveTo(l,g,v),d=!0;else if(x=="o5")for(;c.length>0;)g+=c.shift(),v+=c.shift(),e.U.P.lineTo(l,g,v);else if(x=="o6"||x=="o7")for(var k=c.length,U=x=="o6",V=0;V<k;V++){var G=c.shift();U?g+=G:v+=G,U=!U,e.U.P.lineTo(l,g,v)}else if(x=="o8"||x=="o24"){k=c.length;for(var q=0;q+6<=k;)w=g+c.shift(),_=v+c.shift(),m=w+c.shift(),y=_+c.shift(),g=m+c.shift(),v=y+c.shift(),e.U.P.curveTo(l,w,_,m,y,g,v),q+=6;x=="o24"&&(g+=c.shift(),v+=c.shift(),e.U.P.lineTo(l,g,v))}else{if(x=="o11")break;if(x=="o1234"||x=="o1235"||x=="o1236"||x=="o1237")x=="o1234"&&(_=v,m=(w=g+c.shift())+c.shift(),F=y=_+c.shift(),D=y,M=v,g=(A=(S=(O=m+c.shift())+c.shift())+c.shift())+c.shift(),e.U.P.curveTo(l,w,_,m,y,O,F),e.U.P.curveTo(l,S,D,A,M,g,v)),x=="o1235"&&(w=g+c.shift(),_=v+c.shift(),m=w+c.shift(),y=_+c.shift(),O=m+c.shift(),F=y+c.shift(),S=O+c.shift(),D=F+c.shift(),A=S+c.shift(),M=D+c.shift(),g=A+c.shift(),v=M+c.shift(),c.shift(),e.U.P.curveTo(l,w,_,m,y,O,F),e.U.P.curveTo(l,S,D,A,M,g,v)),x=="o1236"&&(w=g+c.shift(),_=v+c.shift(),m=w+c.shift(),F=y=_+c.shift(),D=y,A=(S=(O=m+c.shift())+c.shift())+c.shift(),M=D+c.shift(),g=A+c.shift(),e.U.P.curveTo(l,w,_,m,y,O,F),e.U.P.curveTo(l,S,D,A,M,g,v)),x=="o1237"&&(w=g+c.shift(),_=v+c.shift(),m=w+c.shift(),y=_+c.shift(),O=m+c.shift(),F=y+c.shift(),S=O+c.shift(),D=F+c.shift(),A=S+c.shift(),M=D+c.shift(),Math.abs(A-g)>Math.abs(M-v)?g=A+c.shift():v=M+c.shift(),e.U.P.curveTo(l,w,_,m,y,O,F),e.U.P.curveTo(l,S,D,A,M,g,v));else if(x=="o14"){if(c.length>0&&!f&&(h=c.shift()+a.nominalWidthX,f=!0),c.length==4){var K=c.shift(),B=c.shift(),I=c.shift(),b=c.shift(),E=e.CFF.glyphBySE(a,I),R=e.CFF.glyphBySE(a,b);e.U._drawCFF(a.CharStrings[E],n,a,s,l),n.x=K,n.y=B,e.U._drawCFF(a.CharStrings[R],n,a,s,l)}d&&(e.U.P.closePath(l),d=!1)}else if(x=="o19"||x=="o20")c.length%2!=0&&!f&&(h=c.shift()+s.nominalWidthX),u+=c.length>>1,c.length=0,f=!0,p+=u+7>>3;else if(x=="o21")c.length>2&&!f&&(h=c.shift()+s.nominalWidthX,f=!0),v+=c.pop(),g+=c.pop(),d&&e.U.P.closePath(l),e.U.P.moveTo(l,g,v),d=!0;else if(x=="o22")c.length>1&&!f&&(h=c.shift()+s.nominalWidthX,f=!0),g+=c.pop(),d&&e.U.P.closePath(l),e.U.P.moveTo(l,g,v),d=!0;else if(x=="o25"){for(;c.length>6;)g+=c.shift(),v+=c.shift(),e.U.P.lineTo(l,g,v);w=g+c.shift(),_=v+c.shift(),m=w+c.shift(),y=_+c.shift(),g=m+c.shift(),v=y+c.shift(),e.U.P.curveTo(l,w,_,m,y,g,v)}else if(x=="o26")for(c.length%2&&(g+=c.shift());c.length>0;)w=g,_=v+c.shift(),g=m=w+c.shift(),v=(y=_+c.shift())+c.shift(),e.U.P.curveTo(l,w,_,m,y,g,v);else if(x=="o27")for(c.length%2&&(v+=c.shift());c.length>0;)_=v,m=(w=g+c.shift())+c.shift(),y=_+c.shift(),g=m+c.shift(),v=y,e.U.P.curveTo(l,w,_,m,y,g,v);else if(x=="o10"||x=="o29"){var L=x=="o10"?s:a;if(c.length==0)console.debug("error: empty stack");else{var C=c.pop(),W=L.Subrs[C+L.Bias];n.x=g,n.y=v,n.nStems=u,n.haveWidth=f,n.width=h,n.open=d,e.U._drawCFF(W,n,a,s,l),g=n.x,v=n.y,u=n.nStems,f=n.haveWidth,h=n.width,d=n.open}}else if(x=="o30"||x=="o31"){var P=c.length,j=(q=0,x=="o31");for(q+=P-(k=-3&P);q<k;)j?(_=v,m=(w=g+c.shift())+c.shift(),v=(y=_+c.shift())+c.shift(),k-q==5?(g=m+c.shift(),q++):g=m,j=!1):(w=g,_=v+c.shift(),m=w+c.shift(),y=_+c.shift(),g=m+c.shift(),k-q==5?(v=y+c.shift(),q++):v=y,j=!0),e.U.P.curveTo(l,w,_,m,y,g,v),q+=4}else{if((x+"").charAt(0)=="o")throw console.debug("Unknown operation: "+x,r),x;c.push(x)}}}n.x=g,n.y=v,n.nStems=u,n.haveWidth=f,n.width=h,n.open=d};var i=e,o={Typr:i};return t.Typr=i,t.default=o,Object.defineProperty(t,"__esModule",{value:!0}),t}({}).Typr}/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/function Ul(){return function(t){var e=Uint8Array,i=Uint16Array,o=Uint32Array,r=new e([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),n=new e([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),a=new e([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),s=function(x,k){for(var U=new i(31),V=0;V<31;++V)U[V]=k+=1<<x[V-1];var G=new o(U[30]);for(V=1;V<30;++V)for(var q=U[V];q<U[V+1];++q)G[q]=q-U[V]<<5|V;return[U,G]},l=s(r,2),c=l[0],u=l[1];c[28]=258,u[258]=28;for(var f=s(n,0)[0],h=new i(32768),d=0;d<32768;++d){var p=(43690&d)>>>1|(21845&d)<<1;p=(61680&(p=(52428&p)>>>2|(13107&p)<<2))>>>4|(3855&p)<<4,h[d]=((65280&p)>>>8|(255&p)<<8)>>>1}var g=function(x,k,U){for(var V=x.length,G=0,q=new i(k);G<V;++G)++q[x[G]-1];var K,B=new i(k);for(G=0;G<k;++G)B[G]=B[G-1]+q[G-1]<<1;{K=new i(1<<k);var I=15-k;for(G=0;G<V;++G)if(x[G])for(var b=G<<4|x[G],E=k-x[G],R=B[x[G]-1]++<<E,L=R|(1<<E)-1;R<=L;++R)K[h[R]>>>I]=b}return K},v=new e(288);for(d=0;d<144;++d)v[d]=8;for(d=144;d<256;++d)v[d]=9;for(d=256;d<280;++d)v[d]=7;for(d=280;d<288;++d)v[d]=8;var w=new e(32);for(d=0;d<32;++d)w[d]=5;var _=g(v,9),m=g(w,5),y=function(x){for(var k=x[0],U=1;U<x.length;++U)x[U]>k&&(k=x[U]);return k},S=function(x,k,U){var V=k/8|0;return(x[V]|x[V+1]<<8)>>(7&k)&U},D=function(x,k){var U=k/8|0;return(x[U]|x[U+1]<<8|x[U+2]<<16)>>(7&k)},A=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],M=function(x,k,U){var V=new Error(k||A[x]);if(V.code=x,Error.captureStackTrace&&Error.captureStackTrace(V,M),!U)throw V;return V},O=function(x,k,U){var V=x.length;if(!V||U&&!U.l&&V<5)return k||new e(0);var G=!k||U,q=!U||U.i;U||(U={}),k||(k=new e(3*V));var K,B=function(fe){var Fe=k.length;if(fe>Fe){var Ee=new e(Math.max(2*Fe,fe));Ee.set(k),k=Ee}},I=U.f||0,b=U.p||0,E=U.b||0,R=U.l,L=U.d,C=U.m,W=U.n,P=8*V;do{if(!R){U.f=I=S(x,b,1);var j=S(x,b+1,3);if(b+=3,!j){var Z=x[(te=((K=b)/8|0)+(7&K&&1)+4)-4]|x[te-3]<<8,ee=te+Z;if(ee>V){q&&M(0);break}G&&B(E+Z),k.set(x.subarray(te,ee),E),U.b=E+=Z,U.p=b=8*ee;continue}if(j==1)R=_,L=m,C=9,W=5;else if(j==2){var X=S(x,b,31)+257,H=S(x,b+10,15)+4,ye=X+S(x,b+5,31)+1;b+=14;for(var de=new e(ye),Q=new e(19),ne=0;ne<H;++ne)Q[a[ne]]=S(x,b+3*ne,7);b+=3*H;var ue=y(Q),Y=(1<<ue)-1,re=g(Q,ue);for(ne=0;ne<ye;){var te,z=re[S(x,b,Y)];if(b+=15&z,(te=z>>>4)<16)de[ne++]=te;else{var ge=0,$=0;for(te==16?($=3+S(x,b,3),b+=2,ge=de[ne-1]):te==17?($=3+S(x,b,7),b+=3):te==18&&($=11+S(x,b,127),b+=7);$--;)de[ne++]=ge}}var oe=de.subarray(0,X),J=de.subarray(X);C=y(oe),W=y(J),R=g(oe,C),L=g(J,W)}else M(1);if(b>P){q&&M(0);break}}G&&B(E+131072);for(var Se=(1<<C)-1,ae=(1<<W)-1,se=b;;se=b){var he=(ge=R[D(x,b)&Se])>>>4;if((b+=15&ge)>P){q&&M(0);break}if(ge||M(2),he<256)k[E++]=he;else{if(he==256){se=b,R=null;break}var me=he-254;if(he>264){var Te=r[ne=he-257];me=S(x,b,(1<<Te)-1)+c[ne],b+=Te}var De=L[D(x,b)&ae],be=De>>>4;if(De||M(3),b+=15&De,J=f[be],be>3&&(Te=n[be],J+=D(x,b)&(1<<Te)-1,b+=Te),b>P){q&&M(0);break}G&&B(E+131072);for(var xe=E+me;E<xe;E+=4)k[E]=k[E-J],k[E+1]=k[E+1-J],k[E+2]=k[E+2-J],k[E+3]=k[E+3-J];E=xe}}U.l=R,U.p=se,U.b=E,R&&(I=1,U.m=C,U.d=L,U.n=W)}while(!I);return E==k.length?k:function(fe,Fe,Ee){(Ee==null||Ee>fe.length)&&(Ee=fe.length);var He=new(fe instanceof i?i:fe instanceof o?o:e)(Ee-Fe);return He.set(fe.subarray(Fe,Ee)),He}(k,0,E)},F=new e(0),N=typeof TextDecoder<"u"&&new TextDecoder;try{N.decode(F,{stream:!0})}catch{}return t.convert_streams=function(x){var k=new DataView(x),U=0;function V(){var X=k.getUint16(U);return U+=2,X}function G(){var X=k.getUint32(U);return U+=4,X}function q(X){Z.setUint16(ee,X),ee+=2}function K(X){Z.setUint32(ee,X),ee+=4}for(var B={signature:G(),flavor:G(),length:G(),numTables:V(),reserved:V(),totalSfntSize:G(),majorVersion:V(),minorVersion:V(),metaOffset:G(),metaLength:G(),metaOrigLength:G(),privOffset:G(),privLength:G()},I=0;Math.pow(2,I)<=B.numTables;)I++;I--;for(var b=16*Math.pow(2,I),E=16*B.numTables-b,R=12,L=[],C=0;C<B.numTables;C++)L.push({tag:G(),offset:G(),compLength:G(),origLength:G(),origChecksum:G()}),R+=16;var W,P=new Uint8Array(12+16*L.length+L.reduce(function(X,H){return X+H.origLength+4},0)),j=P.buffer,Z=new DataView(j),ee=0;return K(B.flavor),q(B.numTables),q(b),q(I),q(E),L.forEach(function(X){K(X.tag),K(X.origChecksum),K(R),K(X.origLength),X.outOffset=R,(R+=X.origLength)%4!=0&&(R+=4-R%4)}),L.forEach(function(X){var H,ye=x.slice(X.offset,X.offset+X.compLength);if(X.compLength!=X.origLength){var de=new Uint8Array(X.origLength);H=new Uint8Array(ye,2),O(H,de)}else de=new Uint8Array(ye);P.set(de,X.outOffset);var Q=0;(R=X.outOffset+X.origLength)%4!=0&&(Q=4-R%4),P.set(new Uint8Array(Q).buffer,X.outOffset+X.origLength),W=R+Q}),j.slice(0,W)},Object.defineProperty(t,"__esModule",{value:!0}),t}({}).convert_streams}function El(t,e){const i={M:2,L:2,Q:4,C:6,Z:0},o={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},r=1,n=2,a=4,s=8,l=16,c=32;let u;function f(A){if(!u){const M={R:n,L:r,D:a,C:l,U:c,T:s};u=new Map;for(let O in o){let F=0;o[O].split(",").forEach(N=>{let[x,k]=N.split("+");x=parseInt(x,36),k=k?parseInt(k,36):0,u.set(F+=x,M[O]);for(let U=k;U--;)u.set(++F,M[O])})}}return u.get(A)||c}const h=1,d=2,p=3,g=4,v=[null,"isol","init","fina","medi"];function w(A){const M=new Uint8Array(A.length);let O=c,F=h,N=-1;for(let x=0;x<A.length;x++){const k=A.codePointAt(x);let U=f(k)|0,V=h;U&s||(O&(r|a|l)?U&(n|a|l)?(V=p,(F===h||F===p)&&M[N]++):U&(r|c)&&(F===d||F===g)&&M[N]--:O&(n|c)&&(F===d||F===g)&&M[N]--,F=M[x]=V,O=U,N=x,k>65535&&x++)}return M}function _(A,M){const O=[];for(let N=0;N<M.length;N++){const x=M.codePointAt(N);x>65535&&N++,O.push(t.U.codeToGlyph(A,x))}const F=A.GSUB;if(F){const{lookupList:N,featureList:x}=F;let k;const U=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,V=[];x.forEach(G=>{if(U.test(G.tag))for(let q=0;q<G.tab.length;q++){if(V[G.tab[q]])continue;V[G.tab[q]]=!0;const K=N[G.tab[q]],B=/^(isol|init|fina|medi)$/.test(G.tag);B&&!k&&(k=w(M));for(let I=0;I<O.length;I++)(!k||!B||v[k[I]]===G.tag)&&t.U._applySubs(O,I,K,N)}})}return O}function m(A,M){const O=new Int16Array(M.length*3);let F=0;for(;F<M.length;F++){const U=M[F];if(U===-1)continue;O[F*3+2]=A.hmtx.aWidth[U];const V=A.GPOS;if(V){const G=V.lookupList;for(let q=0;q<G.length;q++){const K=G[q];for(let B=0;B<K.tabs.length;B++){const I=K.tabs[B];if(K.ltype===1){if(t._lctf.coverageIndex(I.coverage,U)!==-1&&I.pos){k(I.pos,F);break}}else if(K.ltype===2){let b=null,E=N();if(E!==-1){const R=t._lctf.coverageIndex(I.coverage,M[E]);if(R!==-1){if(I.fmt===1){const L=I.pairsets[R];for(let C=0;C<L.length;C++)L[C].gid2===U&&(b=L[C])}else if(I.fmt===2){const L=t.U._getGlyphClass(M[E],I.classDef1),C=t.U._getGlyphClass(U,I.classDef2);b=I.matrix[L][C]}if(b){b.val1&&k(b.val1,E),b.val2&&k(b.val2,F);break}}}}else if(K.ltype===4){const b=t._lctf.coverageIndex(I.markCoverage,U);if(b!==-1){const E=N(x),R=E===-1?-1:t._lctf.coverageIndex(I.baseCoverage,M[E]);if(R!==-1){const L=I.markArray[b],C=I.baseArray[R][L.markClass];O[F*3]=C.x-L.x+O[E*3]-O[E*3+2],O[F*3+1]=C.y-L.y+O[E*3+1];break}}}else if(K.ltype===6){const b=t._lctf.coverageIndex(I.mark1Coverage,U);if(b!==-1){const E=N();if(E!==-1){const R=M[E];if(y(A,R)===3){const L=t._lctf.coverageIndex(I.mark2Coverage,R);if(L!==-1){const C=I.mark1Array[b],W=I.mark2Array[L][C.markClass];O[F*3]=W.x-C.x+O[E*3]-O[E*3+2],O[F*3+1]=W.y-C.y+O[E*3+1];break}}}}}}}}else if(A.kern&&!A.cff){const G=N();if(G!==-1){const q=A.kern.glyph1.indexOf(M[G]);if(q!==-1){const K=A.kern.rval[q].glyph2.indexOf(U);K!==-1&&(O[G*3+2]+=A.kern.rval[q].vals[K])}}}}return O;function N(U){for(let V=F-1;V>=0;V--)if(M[V]!==-1&&(!U||U(M[V])))return V;return-1}function x(U){return y(A,U)===1}function k(U,V){for(let G=0;G<3;G++)O[V*3+G]+=U[G]||0}}function y(A,M){const O=A.GDEF&&A.GDEF.glyphClassDef;return O?t.U._getGlyphClass(M,O):0}function S(...A){for(let M=0;M<A.length;M++)if(typeof A[M]=="number")return A[M]}function D(A){const M=Object.create(null),O=A["OS/2"],F=A.hhea,N=A.head.unitsPerEm,x=S(O&&O.sTypoAscender,F&&F.ascender,N),k={unitsPerEm:N,ascender:x,descender:S(O&&O.sTypoDescender,F&&F.descender,0),capHeight:S(O&&O.sCapHeight,x),xHeight:S(O&&O.sxHeight,x),lineGap:S(O&&O.sTypoLineGap,F&&F.lineGap),supportsCodePoint(U){return t.U.codeToGlyph(A,U)>0},forEachGlyph(U,V,G,q){let K=0;const B=1/k.unitsPerEm*V,I=_(A,U);let b=0;const E=m(A,I);return I.forEach((R,L)=>{if(R!==-1){let C=M[R];if(!C){const{cmds:W,crds:P}=t.U.glyphToPath(A,R);let j="",Z=0;for(let de=0,Q=W.length;de<Q;de++){const ne=i[W[de]];j+=W[de];for(let ue=1;ue<=ne;ue++)j+=(ue>1?",":"")+P[Z++]}let ee,X,H,ye;if(P.length){ee=X=1/0,H=ye=-1/0;for(let de=0,Q=P.length;de<Q;de+=2){let ne=P[de],ue=P[de+1];ne<ee&&(ee=ne),ue<X&&(X=ue),ne>H&&(H=ne),ue>ye&&(ye=ue)}}else ee=H=X=ye=0;C=M[R]={index:R,advanceWidth:A.hmtx.aWidth[R],xMin:ee,yMin:X,xMax:H,yMax:ye,path:j}}q.call(null,C,K+E[L*3]*B,E[L*3+1]*B,b),K+=E[L*3+2]*B,G&&(K+=G*V)}b+=U.codePointAt(b)>65535?2:1}),K}};return k}return function(M){const O=new Uint8Array(M,0,4),F=t._bin.readASCII(O,0,4);if(F==="wOFF")M=e(M);else if(F==="wOF2")throw new Error("woff2 fonts not supported");return D(t.parse(M)[0])}}const Ml=Qt({name:"Typr Font Parser",dependencies:[Tl,Ul,El],init(t,e,i){const o=t(),r=e();return i(o,r)}});/*!
Custom bundle of @unicode-font-resolver/client v1.0.2 (https://github.com/lojjic/unicode-font-resolver)
for use in Troika text rendering. 
Original MIT license applies
*/function Cl(){return function(t){var e=function(){this.buckets=new Map};e.prototype.add=function(m){var y=m>>5;this.buckets.set(y,(this.buckets.get(y)||0)|1<<(31&m))},e.prototype.has=function(m){var y=this.buckets.get(m>>5);return y!==void 0&&(y&1<<(31&m))!=0},e.prototype.serialize=function(){var m=[];return this.buckets.forEach(function(y,S){m.push((+S).toString(36)+":"+y.toString(36))}),m.join(",")},e.prototype.deserialize=function(m){var y=this;this.buckets.clear(),m.split(",").forEach(function(S){var D=S.split(":");y.buckets.set(parseInt(D[0],36),parseInt(D[1],36))})};var i=Math.pow(2,8),o=i-1,r=~o;function n(m){var y=function(D){return D&r}(m).toString(16),S=function(D){return(D&r)+i-1}(m).toString(16);return"codepoint-index/plane"+(m>>16)+"/"+y+"-"+S+".json"}function a(m,y){var S=m&o,D=y.codePointAt(S/6|0);return((D=(D||48)-48)&1<<S%6)!=0}function s(m,y){var S;(S=m,S.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map(function(D){return D.split("-").map(function(A){return parseInt(A.trim(),16)})})).forEach(function(D){var A=D[0],M=D[1];M===void 0&&(M=A),y(A,M)})}function l(m,y){s(m,function(S,D){for(var A=S;A<=D;A++)y(A)})}var c={},u={},f=new WeakMap,h="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(m){var y=f.get(m);return y||(y=new e,l(m.ranges,function(S){return y.add(S)}),f.set(m,y)),y}var p,g=new Map;function v(m,y,S){return m[y]?y:m[S]?S:function(D){for(var A in D)return A}(m)}function w(m,y){var S=y;if(!m.includes(S)){S=1/0;for(var D=0;D<m.length;D++)Math.abs(m[D]-y)<Math.abs(S-y)&&(S=m[D])}return S}function _(m){return p||(p=new Set,l("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",function(y){p.add(y)})),p.has(m)}return t.CodePointSet=e,t.clearCache=function(){c={},u={}},t.getFontsForString=function(m,y){y===void 0&&(y={});var S,D=y.lang;D===void 0&&(D=new RegExp("\\p{Script=Hangul}","u").test(S=m)?"ko":new RegExp("\\p{Script=Hiragana}|\\p{Script=Katakana}","u").test(S)?"ja":"en");var A=y.category;A===void 0&&(A="sans-serif");var M=y.style;M===void 0&&(M="normal");var O=y.weight;O===void 0&&(O=400);var F=(y.dataUrl||h).replace(/\/$/g,""),N=new Map,x=new Uint8Array(m.length),k={},U={},V=new Array(m.length),G=new Map,q=!1;function K(b){var E=g.get(b);return E||(E=fetch(F+"/"+b).then(function(R){if(!R.ok)throw new Error(R.statusText);return R.json().then(function(L){if(!Array.isArray(L)||L[0]!==1)throw new Error("Incorrect schema version; need 1, got "+L[0]);return L[1]})}).catch(function(R){if(F!==h)return q||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+F+'", trying default CDN. '+R.message),q=!0),F=h,g.delete(b),K(b);throw R}),g.set(b,E)),E}for(var B=function(b){var E=m.codePointAt(b),R=n(E);V[b]=R,c[R]||G.has(R)||G.set(R,K(R).then(function(L){c[R]=L})),E>65535&&(b++,I=b)},I=0;I<m.length;I++)B(I);return Promise.all(G.values()).then(function(){G.clear();for(var b=function(R){var L=m.codePointAt(R),C=null,W=c[V[R]],P=void 0;for(var j in W){var Z=U[j];if(Z===void 0&&(Z=U[j]=new RegExp(j).test(D||"en")),Z){for(var ee in P=j,W[j])if(a(L,W[j][ee])){C=ee;break}break}}if(!C){e:for(var X in W)if(X!==P){for(var H in W[X])if(a(L,W[X][H])){C=H;break e}}}C||(console.debug("No font coverage for U+"+L.toString(16)),C="latin"),V[R]=C,u[C]||G.has(C)||G.set(C,K("font-meta/"+C+".json").then(function(ye){u[C]=ye})),L>65535&&(R++,E=R)},E=0;E<m.length;E++)b(E);return Promise.all(G.values())}).then(function(){for(var b,E=null,R=0;R<m.length;R++){var L=m.codePointAt(R);if(E&&(_(L)||d(E).has(L)))x[R]=x[R-1];else{E=u[V[R]];var C=k[E.id];if(!C){var W=E.typeforms,P=v(W,A,"sans-serif"),j=v(W[P],M,"normal"),Z=w((b=W[P])===null||b===void 0?void 0:b[j],O);C=k[E.id]=F+"/font-files/"+E.id+"/"+P+"."+j+"."+Z+".woff"}var ee=N.get(C);ee==null&&(ee=N.size,N.set(C,ee)),x[R]=ee}L>65535&&(R++,x[R]=x[R-1])}return{fontUrls:Array.from(N.keys()),chars:x}})},Object.defineProperty(t,"__esModule",{value:!0}),t}({})}function Dl(t,e){const i=Object.create(null),o=Object.create(null);function r(a,s){const l=c=>{console.error(`Failure loading font ${a}`,c)};try{const c=new XMLHttpRequest;c.open("get",a,!0),c.responseType="arraybuffer",c.onload=function(){if(c.status>=400)l(new Error(c.statusText));else if(c.status>0)try{const u=t(c.response);u.src=a,s(u)}catch(u){l(u)}},c.onerror=l,c.send()}catch(c){l(c)}}function n(a,s){let l=i[a];l?s(l):o[a]?o[a].push(s):(o[a]=[s],r(a,c=>{c.src=a,i[a]=c,o[a].forEach(u=>u(c)),delete o[a]}))}return function(a,s,{lang:l,fonts:c=[],style:u="normal",weight:f="normal",unicodeFontsURL:h}={}){const d=new Uint8Array(a.length),p=[];a.length||_();const g=new Map,v=[];if(u!=="italic"&&(u="normal"),typeof f!="number"&&(f=f==="bold"?700:400),c&&!Array.isArray(c)&&(c=[c]),c=c.slice().filter(y=>!y.lang||y.lang.test(l)).reverse(),c.length){let A=0;(function M(O=0){for(let F=O,N=a.length;F<N;F++){const x=a.codePointAt(F);if(A===1&&p[d[F-1]].supportsCodePoint(x)||F>0&&/\s/.test(a[F]))d[F]=d[F-1],A===2&&(v[v.length-1][1]=F);else for(let k=d[F],U=c.length;k<=U;k++)if(k===U){const V=A===2?v[v.length-1]:v[v.length]=[F,F];V[1]=F,A=2}else{d[F]=k;const{src:V,unicodeRange:G}=c[k];if(!G||m(x,G)){const q=i[V];if(!q){n(V,()=>{M(F)});return}if(q.supportsCodePoint(x)){let K=g.get(q);typeof K!="number"&&(K=p.length,p.push(q),g.set(q,K)),d[F]=K,A=1;break}}}x>65535&&F+1<N&&(d[F+1]=d[F],F++,A===2&&(v[v.length-1][1]=F))}w()})()}else v.push([0,a.length-1]),w();function w(){if(v.length){const y=v.map(S=>a.substring(S[0],S[1]+1)).join(`
`);e.getFontsForString(y,{lang:l||void 0,style:u,weight:f,dataUrl:h}).then(({fontUrls:S,chars:D})=>{const A=p.length;let M=0;v.forEach(F=>{for(let N=0,x=F[1]-F[0];N<=x;N++)d[F[0]+N]=D[M++]+A;M++});let O=0;S.forEach((F,N)=>{n(F,x=>{p[N+A]=x,++O===S.length&&_()})})})}else _()}function _(){s({chars:d,fonts:p})}function m(y,S){for(let D=0;D<S.length;D++){const[A,M=A]=S[D];if(A<=y&&y<=M)return!0}return!1}}}const Fl=Qt({name:"FontResolver",dependencies:[Dl,Ml,Cl],init(t,e,i){return t(e,i())}});function Rl(t,e){const o=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,r="[^\\S\\u00A0]",n=new RegExp(`${r}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function a({text:p,lang:g,fonts:v,style:w,weight:_,preResolvedFonts:m,unicodeFontsURL:y},S){const D=({chars:A,fonts:M})=>{let O,F;const N=[];for(let x=0;x<A.length;x++)A[x]!==F?(F=A[x],N.push(O={start:x,end:x,fontObj:M[A[x]]})):O.end=x;S(N)};m?D(m):t(p,D,{lang:g,fonts:v,style:w,weight:_,unicodeFontsURL:y})}function s({text:p="",font:g,lang:v,sdfGlyphSize:w=64,fontSize:_=400,fontWeight:m=1,fontStyle:y="normal",letterSpacing:S=0,lineHeight:D="normal",maxWidth:A=1/0,direction:M,textAlign:O="left",textIndent:F=0,whiteSpace:N="normal",overflowWrap:x="normal",anchorX:k=0,anchorY:U=0,metricsOnly:V=!1,unicodeFontsURL:G,preResolvedFonts:q=null,includeCaretPositions:K=!1,chunkedBoundsSize:B=8192,colorRanges:I=null},b){const E=f(),R={fontLoad:0,typesetting:0};p.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),p=p.replace(/\r\n/g,`
`).replace(/\r/g,`
`)),_=+_,S=+S,A=+A,D=D||"normal",F=+F,a({text:p,lang:v,style:y,weight:m,fonts:typeof g=="string"?[{src:g}]:g,unicodeFontsURL:G,preResolvedFonts:q},L=>{R.fontLoad=f()-E;const C=isFinite(A);let W=null,P=null,j=null,Z=null,ee=null,X=null,H=null,ye=null,de=0,Q=0,ne=N!=="nowrap";const ue=new Map,Y=f();let re=F,te=0,z=new h;const ge=[z];L.forEach(ae=>{const{fontObj:se}=ae,{ascender:he,descender:me,unitsPerEm:Te,lineGap:De,capHeight:be,xHeight:xe}=se;let fe=ue.get(se);if(!fe){const pe=_/Te,ke=D==="normal"?(he-me+De)*pe:D*_,yt=(ke-(he-me)*pe)/2,Ae=Math.min(ke,(he-me)*pe),_e=(he+me)/2*pe+Ae/2;fe={index:ue.size,src:se.src,fontObj:se,fontSizeMult:pe,unitsPerEm:Te,ascender:he*pe,descender:me*pe,capHeight:be*pe,xHeight:xe*pe,lineHeight:ke,baseline:-yt-he*pe,caretTop:_e,caretBottom:_e-Ae},ue.set(se,fe)}const{fontSizeMult:Fe}=fe,Ee=p.slice(ae.start,ae.end+1);let He,Ue;se.forEachGlyph(Ee,_,S,(pe,ke,yt,Ae)=>{ke+=te,Ae+=ae.start,He=ke,Ue=pe;const _e=p.charAt(Ae),Re=pe.advanceWidth*Fe,Me=z.count;let ve;if("isEmpty"in pe||(pe.isWhitespace=!!_e&&new RegExp(r).test(_e),pe.canBreakAfter=!!_e&&n.test(_e),pe.isEmpty=pe.xMin===pe.xMax||pe.yMin===pe.yMax||o.test(_e)),!pe.isWhitespace&&!pe.isEmpty&&Q++,ne&&C&&!pe.isWhitespace&&ke+Re+re>A&&Me){if(z.glyphAt(Me-1).glyphObj.canBreakAfter)ve=new h,re=-ke;else for(let je=Me;je--;)if(je===0&&x==="break-word"){ve=new h,re=-ke;break}else if(z.glyphAt(je).glyphObj.canBreakAfter){ve=z.splitAt(je+1);const Ie=ve.glyphAt(0).x;re-=Ie;for(let Le=ve.count;Le--;)ve.glyphAt(Le).x-=Ie;break}ve&&(z.isSoftWrapped=!0,z=ve,ge.push(z),de=A)}let Ce=z.glyphAt(z.count);Ce.glyphObj=pe,Ce.x=ke+re,Ce.y=yt,Ce.width=Re,Ce.charIndex=Ae,Ce.fontData=fe,_e===`
`&&(z=new h,ge.push(z),re=-(ke+Re+S*_)+F)}),te=He+Ue.advanceWidth*Fe+S*_});let $=0;ge.forEach(ae=>{let se=!0;for(let he=ae.count;he--;){const me=ae.glyphAt(he);se&&!me.glyphObj.isWhitespace&&(ae.width=me.x+me.width,ae.width>de&&(de=ae.width),se=!1);let{lineHeight:Te,capHeight:De,xHeight:be,baseline:xe}=me.fontData;Te>ae.lineHeight&&(ae.lineHeight=Te);const fe=xe-ae.baseline;fe<0&&(ae.baseline+=fe,ae.cap+=fe,ae.ex+=fe),ae.cap=Math.max(ae.cap,ae.baseline+De),ae.ex=Math.max(ae.ex,ae.baseline+be)}ae.baseline-=$,ae.cap-=$,ae.ex-=$,$+=ae.lineHeight});let oe=0,J=0;if(k&&(typeof k=="number"?oe=-k:typeof k=="string"&&(oe=-de*(k==="left"?0:k==="center"?.5:k==="right"?1:c(k)))),U&&(typeof U=="number"?J=-U:typeof U=="string"&&(J=U==="top"?0:U==="top-baseline"?-ge[0].baseline:U==="top-cap"?-ge[0].cap:U==="top-ex"?-ge[0].ex:U==="middle"?$/2:U==="bottom"?$:U==="bottom-baseline"?-ge[ge.length-1].baseline:c(U)*$)),!V){const ae=e.getEmbeddingLevels(p,M);W=new Uint16Array(Q),P=new Uint8Array(Q),j=new Float32Array(Q*2),Z={},H=[1/0,1/0,-1/0,-1/0],ye=[],K&&(X=new Float32Array(p.length*4)),I&&(ee=new Uint8Array(Q*3));let se=0,he=-1,me=-1,Te,De;if(ge.forEach((be,xe)=>{let{count:fe,width:Fe}=be;if(fe>0){let Ee=0;for(let Ae=fe;Ae--&&be.glyphAt(Ae).glyphObj.isWhitespace;)Ee++;let He=0,Ue=0;if(O==="center")He=(de-Fe)/2;else if(O==="right")He=de-Fe;else if(O==="justify"&&be.isSoftWrapped){let Ae=0;for(let _e=fe-Ee;_e--;)be.glyphAt(_e).glyphObj.isWhitespace&&Ae++;Ue=(de-Fe)/Ae}if(Ue||He){let Ae=0;for(let _e=0;_e<fe;_e++){let Re=be.glyphAt(_e);const Me=Re.glyphObj;Re.x+=He+Ae,Ue!==0&&Me.isWhitespace&&_e<fe-Ee&&(Ae+=Ue,Re.width+=Ue)}}const pe=e.getReorderSegments(p,ae,be.glyphAt(0).charIndex,be.glyphAt(be.count-1).charIndex);for(let Ae=0;Ae<pe.length;Ae++){const[_e,Re]=pe[Ae];let Me=1/0,ve=-1/0;for(let Ce=0;Ce<fe;Ce++)if(be.glyphAt(Ce).charIndex>=_e){let je=Ce,Ie=Ce;for(;Ie<fe;Ie++){let Le=be.glyphAt(Ie);if(Le.charIndex>Re)break;Ie<fe-Ee&&(Me=Math.min(Me,Le.x),ve=Math.max(ve,Le.x+Le.width))}for(let Le=je;Le<Ie;Le++){const $e=be.glyphAt(Le);$e.x=ve-($e.x+$e.width-Me)}break}}let ke;const yt=Ae=>ke=Ae;for(let Ae=0;Ae<fe;Ae++){const _e=be.glyphAt(Ae);ke=_e.glyphObj;const Re=ke.index,Me=ae.levels[_e.charIndex]&1;if(Me){const ve=e.getMirroredCharacter(p[_e.charIndex]);ve&&_e.fontData.fontObj.forEachGlyph(ve,0,0,yt)}if(K){const{charIndex:ve,fontData:Ce}=_e,je=_e.x+oe,Ie=_e.x+_e.width+oe;X[ve*4]=Me?Ie:je,X[ve*4+1]=Me?je:Ie,X[ve*4+2]=be.baseline+Ce.caretBottom+J,X[ve*4+3]=be.baseline+Ce.caretTop+J;const Le=ve-he;Le>1&&u(X,he,Le),he=ve}if(I){const{charIndex:ve}=_e;for(;ve>me;)me++,I.hasOwnProperty(me)&&(De=I[me])}if(!ke.isWhitespace&&!ke.isEmpty){const ve=se++,{fontSizeMult:Ce,src:je,index:Ie}=_e.fontData,Le=Z[je]||(Z[je]={});Le[Re]||(Le[Re]={path:ke.path,pathBounds:[ke.xMin,ke.yMin,ke.xMax,ke.yMax]});const $e=_e.x+oe,bt=_e.y+be.baseline+J;j[ve*2]=$e,j[ve*2+1]=bt;const dt=$e+ke.xMin*Ce,xt=bt+ke.yMin*Ce,At=$e+ke.xMax*Ce,pt=bt+ke.yMax*Ce;dt<H[0]&&(H[0]=dt),xt<H[1]&&(H[1]=xt),At>H[2]&&(H[2]=At),pt>H[3]&&(H[3]=pt),ve%B===0&&(Te={start:ve,end:ve,rect:[1/0,1/0,-1/0,-1/0]},ye.push(Te)),Te.end++;const ze=Te.rect;if(dt<ze[0]&&(ze[0]=dt),xt<ze[1]&&(ze[1]=xt),At>ze[2]&&(ze[2]=At),pt>ze[3]&&(ze[3]=pt),W[ve]=Re,P[ve]=Ie,I){const Tt=ve*3;ee[Tt]=De>>16&255,ee[Tt+1]=De>>8&255,ee[Tt+2]=De&255}}}}}),X){const be=p.length-he;be>1&&u(X,he,be)}}const Se=[];ue.forEach(({index:ae,src:se,unitsPerEm:he,ascender:me,descender:Te,lineHeight:De,capHeight:be,xHeight:xe})=>{Se[ae]={src:se,unitsPerEm:he,ascender:me,descender:Te,lineHeight:De,capHeight:be,xHeight:xe}}),R.typesetting=f()-Y,b({glyphIds:W,glyphFontIndices:P,glyphPositions:j,glyphData:Z,fontData:Se,caretPositions:X,glyphColors:ee,chunkedBounds:ye,fontSize:_,topBaseline:J+ge[0].baseline,blockBounds:[oe,J-$,oe+de,J],visibleBounds:H,timings:R})})}function l(p,g){s({...p,metricsOnly:!0},v=>{const[w,_,m,y]=v.blockBounds;g({width:m-w,height:y-_})})}function c(p){let g=p.match(/^([\d.]+)%$/),v=g?parseFloat(g[1]):NaN;return isNaN(v)?0:v/100}function u(p,g,v){const w=p[g*4],_=p[g*4+1],m=p[g*4+2],y=p[g*4+3],S=(_-w)/v;for(let D=0;D<v;D++){const A=(g+D)*4;p[A]=w+S*D,p[A+1]=w+S*(D+1),p[A+2]=m,p[A+3]=y}}function f(){return(self.performance||Date).now()}function h(){this.data=[]}const d=["glyphObj","x","y","width","charIndex","fontData"];return h.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/d.length)},glyphAt(p){let g=h.flyweight;return g.data=this.data,g.index=p,g},splitAt(p){let g=new h;return g.data=this.data.splice(p*d.length),g}},h.flyweight=d.reduce((p,g,v,w)=>(Object.defineProperty(p,g,{get(){return this.data[this.index*d.length+v]},set(_){this.data[this.index*d.length+v]=_}}),p),{data:null,index:0}),{typeset:s,measure:l}}const Ft=()=>(self.performance||Date).now(),wr=Co();let Ea;function Ll(t,e,i,o,r,n,a,s,l,c,u=!0){return u?Ol(t,e,i,o,r,n,a,s,l,c).then(null,f=>(Ea||(console.warn("WebGL SDF generation failed, falling back to JS",f),Ea=!0),Ca(t,e,i,o,r,n,a,s,l,c))):Ca(t,e,i,o,r,n,a,s,l,c)}const ir=[],Nl=5;let gi=0;function Fo(){const t=Ft();for(;ir.length&&Ft()-t<Nl;)ir.shift()();gi=ir.length?setTimeout(Fo,0):0}const Ol=(...t)=>new Promise((e,i)=>{ir.push(()=>{const o=Ft();try{wr.webgl.generateIntoCanvas(...t),e({timing:Ft()-o})}catch(r){i(r)}}),gi||(gi=setTimeout(Fo,0))}),Pl=4,Bl=2e3,Ma={};let Il=0;function Ca(t,e,i,o,r,n,a,s,l,c){const u="TroikaTextSDFGenerator_JS_"+Il++%Pl;let f=Ma[u];return f||(f=Ma[u]={workerModule:Qt({name:u,workerId:u,dependencies:[Co,Ft],init(h,d){const p=h().javascript.generate;return function(...g){const v=d();return{textureData:p(...g),timing:d()-v}}},getTransferables(h){return[h.textureData.buffer]}}),requests:0,idleTimer:null}),f.requests++,clearTimeout(f.idleTimer),f.workerModule(t,e,i,o,r,n).then(({textureData:h,timing:d})=>{const p=Ft(),g=new Uint8Array(h.length*4);for(let v=0;v<h.length;v++)g[v*4+c]=h[v];return wr.webglUtils.renderImageData(a,g,s,l,t,e,1<<3-c),d+=Ft()-p,--f.requests===0&&(f.idleTimer=setTimeout(()=>{ml(u)},Bl)),{timing:d}})}function Gl(t){t._warm||(wr.webgl.isSupported(t),t._warm=!0)}const jl=wr.webglUtils.resizeWebGLCanvasWithoutClearing,dn={unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},zl=new lt;function Wt(){return(self.performance||Date).now()}const Da=Object.create(null);function Ro(t,e){t=Vl({},t);const i=Wt(),o=[];if(t.font&&o.push({label:"user",src:Xl(t.font)}),t.font=o,t.text=""+t.text,t.sdfGlyphSize=t.sdfGlyphSize||dn.sdfGlyphSize,t.unicodeFontsURL=t.unicodeFontsURL||dn.unicodeFontsURL,t.colorRanges!=null){let h={};for(let d in t.colorRanges)if(t.colorRanges.hasOwnProperty(d)){let p=t.colorRanges[d];typeof p!="number"&&(p=zl.set(p).getHex()),h[d]=p}t.colorRanges=h}Object.freeze(t);const{textureWidth:r,sdfExponent:n}=dn,{sdfGlyphSize:a}=t,s=r/a*4;let l=Da[a];if(!l){const h=document.createElement("canvas");h.width=r,h.height=a*256/s,l=Da[a]={glyphCount:0,sdfGlyphSize:a,sdfCanvas:h,sdfTexture:new $s(h,void 0,void 0,void 0,va,va),contextLost:!1,glyphsByFont:new Map},l.sdfTexture.generateMipmaps=!1,Wl(l)}const{sdfTexture:c,sdfCanvas:u}=l;Oo(t).then(h=>{const{glyphIds:d,glyphFontIndices:p,fontData:g,glyphPositions:v,fontSize:w,timings:_}=h,m=[],y=new Float32Array(d.length*4);let S=0,D=0;const A=Wt(),M=g.map(k=>{let U=l.glyphsByFont.get(k.src);return U||l.glyphsByFont.set(k.src,U=new Map),U});d.forEach((k,U)=>{const V=p[U],{src:G,unitsPerEm:q}=g[V];let K=M[V].get(k);if(!K){const{path:R,pathBounds:L}=h.glyphData[G][k],C=Math.max(L[2]-L[0],L[3]-L[1])/a*(dn.sdfMargin*a+.5),W=l.glyphCount++,P=[L[0]-C,L[1]-C,L[2]+C,L[3]+C];M[V].set(k,K={path:R,atlasIndex:W,sdfViewBox:P}),m.push(K)}const{sdfViewBox:B}=K,I=v[D++],b=v[D++],E=w/q;y[S++]=I+B[0]*E,y[S++]=b+B[1]*E,y[S++]=I+B[2]*E,y[S++]=b+B[3]*E,d[U]=K.atlasIndex}),_.quads=(_.quads||0)+(Wt()-A);const O=Wt();_.sdf={};const F=u.height,N=Math.ceil(l.glyphCount/s),x=Math.pow(2,Math.ceil(Math.log2(N*a)));x>F&&(console.info(`Increasing SDF texture size ${F}->${x}`),jl(u,r,x),c.dispose()),Promise.all(m.map(k=>Lo(k,l,t.gpuAccelerateSDF).then(({timing:U})=>{_.sdf[k.atlasIndex]=U}))).then(()=>{m.length&&!l.contextLost&&(No(l),c.needsUpdate=!0),_.sdfTotal=Wt()-O,_.total=Wt()-i,e(Object.freeze({parameters:t,sdfTexture:c,sdfGlyphSize:a,sdfExponent:n,glyphBounds:y,glyphAtlasIndices:d,glyphColors:h.glyphColors,caretPositions:h.caretPositions,chunkedBounds:h.chunkedBounds,ascender:h.ascender,descender:h.descender,lineHeight:h.lineHeight,capHeight:h.capHeight,xHeight:h.xHeight,topBaseline:h.topBaseline,blockBounds:h.blockBounds,visibleBounds:h.visibleBounds,timings:h.timings}))})}),Promise.resolve().then(()=>{l.contextLost||Gl(u)})}function Lo({path:t,atlasIndex:e,sdfViewBox:i},{sdfGlyphSize:o,sdfCanvas:r,contextLost:n},a){if(n)return Promise.resolve({timing:-1});const{textureWidth:s,sdfExponent:l}=dn,c=Math.max(i[2]-i[0],i[3]-i[1]),u=Math.floor(e/4),f=u%(s/o)*o,h=Math.floor(u/(s/o))*o,d=e%4;return Ll(o,o,t,i,c,l,r,f,h,d,a)}function Wl(t){const e=t.sdfCanvas;e.addEventListener("webglcontextlost",i=>{console.log("Context Lost",i),i.preventDefault(),t.contextLost=!0}),e.addEventListener("webglcontextrestored",i=>{console.log("Context Restored",i),t.contextLost=!1;const o=[];t.glyphsByFont.forEach(r=>{r.forEach(n=>{o.push(Lo(n,t,!0))})}),Promise.all(o).then(()=>{No(t),t.sdfTexture.needsUpdate=!0})})}function Hl({font:t,characters:e,sdfGlyphSize:i},o){let r=Array.isArray(e)?e.join(`
`):""+e;Ro({font:t,sdfGlyphSize:i,text:r},o)}function Vl(t,e){for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}let Yn;function Xl(t){return Yn||(Yn=typeof document>"u"?{}:document.createElement("a")),Yn.href=t,Yn.href}function No(t){if(typeof createImageBitmap!="function"){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:e,sdfTexture:i}=t,{width:o,height:r}=e,n=t.sdfCanvas.getContext("webgl");let a=i.image.data;(!a||a.length!==o*r*4)&&(a=new Uint8Array(o*r*4),i.image={width:o,height:r,data:a},i.flipY=!1,i.isDataTexture=!0),n.readPixels(0,0,o,r,n.RGBA,n.UNSIGNED_BYTE,a)}}const Yl=Qt({name:"Typesetter",dependencies:[Rl,Fl,yl],init(t,e,i){return t(e,i())}}),Oo=Qt({name:"Typesetter",dependencies:[Yl],init(t){return function(e){return new Promise(i=>{t.typeset(e,i)})}},getTransferables(t){const e=[];for(let i in t)t[i]&&t[i].buffer&&e.push(t[i].buffer);return e}});Oo.onMainThread;const Fa={};function ql(t){let e=Fa[t];return e||(e=Fa[t]=new Fi(1,1,t,t).translate(.5,.5,0)),e}const Kl="aTroikaGlyphBounds",Ra="aTroikaGlyphIndex",Zl="aTroikaGlyphColor";class Jl extends So{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new Ci,this.boundingBox=new Un}computeBoundingSphere(){}computeBoundingBox(){}set detail(e){if(e!==this._detail){this._detail=e,(typeof e!="number"||e<1)&&(e=1);let i=ql(e);["position","normal","uv"].forEach(o=>{this.attributes[o]=i.attributes[o].clone()}),this.setIndex(i.getIndex().clone())}}get detail(){return this._detail}set curveRadius(e){e!==this._curveRadius&&(this._curveRadius=e,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(e,i,o,r,n){this.updateAttributeData(Kl,e,4),this.updateAttributeData(Ra,i,1),this.updateAttributeData(Zl,n,3),this._blockBounds=o,this._chunkedBounds=r,this.instanceCount=i.length,this._updateBounds()}_updateBounds(){const e=this._blockBounds;if(e){const{curveRadius:i,boundingBox:o}=this;if(i){const{PI:r,floor:n,min:a,max:s,sin:l,cos:c}=Math,u=r/2,f=r*2,h=Math.abs(i),d=e[0]/h,p=e[2]/h,g=n((d+u)/f)!==n((p+u)/f)?-h:a(l(d)*h,l(p)*h),v=n((d-u)/f)!==n((p-u)/f)?h:s(l(d)*h,l(p)*h),w=n((d+r)/f)!==n((p+r)/f)?h*2:s(h-c(d)*h,h-c(p)*h);o.min.set(g,e[1],i<0?-w:0),o.max.set(v,e[3],i<0?0:w)}else o.min.set(e[0],e[1],0),o.max.set(e[2],e[3],0);o.getBoundingSphere(this.boundingSphere)}}applyClipRect(e){let i=this.getAttribute(Ra).count,o=this._chunkedBounds;if(o)for(let r=o.length;r--;){i=o[r].end;let n=o[r].rect;if(n[1]<e.w&&n[3]>e.y&&n[0]<e.z&&n[2]>e.x)break}this.instanceCount=i}updateAttributeData(e,i,o){const r=this.getAttribute(e);i?r&&r.array.length===i.length?(r.array.set(i),r.needsUpdate=!0):(this.setAttribute(e,new Js(i,o)),delete this._maxInstanceCount,this.dispose()):r&&this.deleteAttribute(e)}}const $l=`
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform vec4 uTroikaTotalBounds;
uniform vec4 uTroikaClipRect;
uniform mat3 uTroikaOrient;
uniform bool uTroikaUseGlyphColors;
uniform float uTroikaEdgeOffset;
uniform float uTroikaBlurRadius;
uniform vec2 uTroikaPositionOffset;
uniform float uTroikaCurveRadius;
attribute vec4 aTroikaGlyphBounds;
attribute float aTroikaGlyphIndex;
attribute vec3 aTroikaGlyphColor;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec3 vTroikaGlyphColor;
varying vec2 vTroikaGlyphDimensions;
`,Ql=`
vec4 bounds = aTroikaGlyphBounds;
bounds.xz += uTroikaPositionOffset.x;
bounds.yw -= uTroikaPositionOffset.y;

vec4 outlineBounds = vec4(
  bounds.xy - uTroikaEdgeOffset - uTroikaBlurRadius,
  bounds.zw + uTroikaEdgeOffset + uTroikaBlurRadius
);
vec4 clippedBounds = vec4(
  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),
  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)
);

vec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);

position.xy = mix(bounds.xy, bounds.zw, clippedXY);

uv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);

float rad = uTroikaCurveRadius;
if (rad != 0.0) {
  float angle = position.x / rad;
  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);
  normal.xz = vec2(sin(angle), cos(angle));
}
  
position = uTroikaOrient * position;
normal = uTroikaOrient * normal;

vTroikaGlyphUV = clippedXY.xy;
vTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);


float txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;
vec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;
vec2 txStartUV = txUvPerSquare * vec2(
  mod(floor(aTroikaGlyphIndex / 4.0), txCols),
  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)
);
vTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);
vTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);
`,ec=`
uniform sampler2D uTroikaSDFTexture;
uniform vec2 uTroikaSDFTextureSize;
uniform float uTroikaSDFGlyphSize;
uniform float uTroikaSDFExponent;
uniform float uTroikaEdgeOffset;
uniform float uTroikaFillOpacity;
uniform float uTroikaBlurRadius;
uniform vec3 uTroikaStrokeColor;
uniform float uTroikaStrokeWidth;
uniform float uTroikaStrokeOpacity;
uniform bool uTroikaSDFDebug;
varying vec2 vTroikaGlyphUV;
varying vec4 vTroikaTextureUVBounds;
varying float vTroikaTextureChannel;
varying vec2 vTroikaGlyphDimensions;

float troikaSdfValueToSignedDistance(float alpha) {
  // Inverse of exponential encoding in webgl-sdf-generator
  
  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);
  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;
  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);
  return signedDist;
}

float troikaGlyphUvToSdfValue(vec2 glyphUV) {
  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);
  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);
  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1
  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;
}

float troikaGlyphUvToDistance(vec2 uv) {
  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));
}

float troikaGetAADist() {
  
  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300
  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;
  #else
  return vTroikaGlyphDimensions.x / 64.0;
  #endif
}

float troikaGetFragDistValue() {
  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);
  float distance = troikaGlyphUvToDistance(clampedGlyphUV);
 
  // Extrapolate distance when outside bounds:
  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : 
    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);

  

  return distance;
}

float troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {
  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)
  float alpha = step(-distanceOffset, -distance);
  #else

  float alpha = smoothstep(
    distanceOffset + aaDist,
    distanceOffset - aaDist,
    distance
  );
  #endif

  return alpha;
}
`,tc=`
float aaDist = troikaGetAADist();
float fragDistance = troikaGetFragDistValue();
float edgeAlpha = uTroikaSDFDebug ?
  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :
  troikaGetEdgeAlpha(fragDistance, uTroikaEdgeOffset, max(aaDist, uTroikaBlurRadius));

#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)
vec4 fillRGBA = gl_FragColor;
fillRGBA.a *= uTroikaFillOpacity;
vec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);
if (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;
gl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(
  -uTroikaStrokeWidth - aaDist,
  -uTroikaStrokeWidth + aaDist,
  fragDistance
));
gl_FragColor.a *= edgeAlpha;
#endif

if (edgeAlpha == 0.0) {
  discard;
}
`;function nc(t){const e=pi(t,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new qt},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new kt(0,0,0,0)},uTroikaClipRect:{value:new kt(0,0,0,0)},uTroikaEdgeOffset:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new qt},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new lt},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Qs},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:$l,vertexTransform:Ql,fragmentDefs:ec,fragmentColorTransform:tc,customRewriter({vertexShader:i,fragmentShader:o}){let r=/\buniform\s+vec3\s+diffuse\b/;return r.test(o)&&(o=o.replace(r,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),r.test(i)||(i=i.replace(Do,`uniform vec3 diffuse;
$&
vTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;
`))),{vertexShader:i,fragmentShader:o}}});return e.transparent=!0,e.forceSinglePass=!0,Object.defineProperties(e,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),e}const Ni=new Zs({color:16777215,side:el,transparent:!0}),La=8421504,Na=new ko,qn=new We,ei=new We,fn=[],rc=new We,ti="+x+y";function Oa(t){return Array.isArray(t)?t[0]:t}let Po=()=>{const t=new _r(new Fi(1,1),Ni);return Po=()=>t,t},Bo=()=>{const t=new _r(new Fi(1,1,32,1),Ni);return Bo=()=>t,t};const ic={type:"syncstart"},ac={type:"synccomplete"},Io=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],oc=Io.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");let Go=class extends _r{constructor(){const e=new Jl;super(e,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=La,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=ti,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(e){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,this.dispatchEvent(ic),Ro({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},i=>{this._isSyncing=!1,this._textRenderInfo=i,this.geometry.updateGlyphs(i.glyphBounds,i.glyphAtlasIndices,i.blockBounds,i.chunkedBounds,i.glyphColors);const o=this._queuedSyncs;o&&(this._queuedSyncs=null,this._needsSync=!0,this.sync(()=>{o.forEach(r=>r&&r())})),this.dispatchEvent(ac),e&&e()})))}onBeforeRender(e,i,o,r,n,a){this.sync(),n.isTroikaTextMaterial&&this._prepareForRender(n)}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}createDerivedMaterial(e){return nc(e)}get material(){let e=this._derivedMaterial;const i=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Ni.clone());if((!e||!e.isDerivedFrom(i))&&(e=this._derivedMaterial=this.createDerivedMaterial(i),i.addEventListener("dispose",function o(){i.removeEventListener("dispose",o),e.dispose()})),this.hasOutline()){let o=e._outlineMtl;return o||(o=e._outlineMtl=Object.create(e,{id:{value:e.id+.1}}),o.isTextOutlineMaterial=!0,o.depthWrite=!1,o.map=null,e.addEventListener("dispose",function r(){e.removeEventListener("dispose",r),o.dispose()})),[o,e]}else return e}set material(e){e&&e.isTroikaTextMaterial?(this._derivedMaterial=e,this._baseMaterial=e.baseMaterial):this._baseMaterial=e}hasOutline(){return!!(this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY)}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(e){this.geometry.detail=e}get curveRadius(){return this.geometry.curveRadius}set curveRadius(e){this.geometry.curveRadius=e}get customDepthMaterial(){return Oa(this.material).getDepthMaterial()}set customDepthMaterial(e){}get customDistanceMaterial(){return Oa(this.material).getDistanceMaterial()}set customDistanceMaterial(e){}_prepareForRender(e){const i=e.isTextOutlineMaterial,o=e.uniforms,r=this.textRenderInfo;if(r){const{sdfTexture:s,blockBounds:l}=r;o.uTroikaSDFTexture.value=s,o.uTroikaSDFTextureSize.value.set(s.image.width,s.image.height),o.uTroikaSDFGlyphSize.value=r.sdfGlyphSize,o.uTroikaSDFExponent.value=r.sdfExponent,o.uTroikaTotalBounds.value.fromArray(l),o.uTroikaUseGlyphColors.value=!i&&!!r.glyphColors;let c=0,u=0,f=0,h,d,p,g=0,v=0;if(i){let{outlineWidth:_,outlineOffsetX:m,outlineOffsetY:y,outlineBlur:S,outlineOpacity:D}=this;c=this._parsePercent(_)||0,u=Math.max(0,this._parsePercent(S)||0),h=D,g=this._parsePercent(m)||0,v=this._parsePercent(y)||0}else f=Math.max(0,this._parsePercent(this.strokeWidth)||0),f&&(p=this.strokeColor,o.uTroikaStrokeColor.value.set(p??La),d=this.strokeOpacity,d==null&&(d=1)),h=this.fillOpacity;o.uTroikaEdgeOffset.value=c,o.uTroikaPositionOffset.value.set(g,v),o.uTroikaBlurRadius.value=u,o.uTroikaStrokeWidth.value=f,o.uTroikaStrokeOpacity.value=d,o.uTroikaFillOpacity.value=h??1,o.uTroikaCurveRadius.value=this.curveRadius||0;let w=this.clipRect;if(w&&Array.isArray(w)&&w.length===4)o.uTroikaClipRect.value.fromArray(w);else{const _=(this.fontSize||.1)*100;o.uTroikaClipRect.value.set(l[0]-_,l[1]-_,l[2]+_,l[3]+_)}this.geometry.applyClipRect(o.uTroikaClipRect.value)}o.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;const n=i?this.outlineColor||0:this.color;if(n==null)delete e.color;else{const s=e.hasOwnProperty("color")?e.color:e.color=new lt;(n!==s._input||typeof n=="object")&&s.set(s._input=n)}let a=this.orientation||ti;if(a!==e._orientation){let s=o.uTroikaOrient.value;a=a.replace(/[^-+xyz]/g,"");let l=a!==ti&&a.match(/^([-+])([xyz])([-+])([xyz])$/);if(l){let[,c,u,f,h]=l;qn.set(0,0,0)[u]=c==="-"?1:-1,ei.set(0,0,0)[h]=f==="-"?-1:1,Na.lookAt(rc,qn.cross(ei),ei),s.setFromMatrix4(Na)}else s.identity();e._orientation=a}}_parsePercent(e){if(typeof e=="string"){let i=e.match(/^(-?[\d.]+)%$/),o=i?parseFloat(i[1]):NaN;e=(isNaN(o)?0:o/100)*this.fontSize}return e}localPositionToTextCoords(e,i=new qt){i.copy(e);const o=this.curveRadius;return o&&(i.x=Math.atan2(e.x,Math.abs(o)-Math.abs(e.z))*Math.abs(o)),i}worldPositionToTextCoords(e,i=new qt){return qn.copy(e),this.localPositionToTextCoords(this.worldToLocal(qn),i)}raycast(e,i){const{textRenderInfo:o,curveRadius:r}=this;if(o){const n=o.blockBounds,a=r?Bo():Po(),s=a.geometry,{position:l,uv:c}=s.attributes;for(let u=0;u<c.count;u++){let f=n[0]+c.getX(u)*(n[2]-n[0]);const h=n[1]+c.getY(u)*(n[3]-n[1]);let d=0;r&&(d=r-Math.cos(f/r)*r,f=Math.sin(f/r)*r),l.setXYZ(u,f,h,d)}s.boundingSphere=this.geometry.boundingSphere,s.boundingBox=this.geometry.boundingBox,a.matrixWorld=this.matrixWorld,a.material.side=this.material.side,fn.length=0,a.raycast(e,fn);for(let u=0;u<fn.length;u++)fn[u].object=this,i.push(fn[u])}}copy(e){const i=this.geometry;return super.copy(e),this.geometry=i,oc.forEach(o=>{this[o]=e[o]}),this}clone(){return new this.constructor().copy(this)}};Io.forEach(t=>{const e="_private_"+t;Object.defineProperty(Go.prototype,t,{get(){return this[e]},set(i){i!==this[e]&&(this[e]=i,this._needsSync=!0)}})});new Un;new lt;const jo=ie.forwardRef(({sdfGlyphSize:t=64,anchorX:e="center",anchorY:i="middle",font:o,fontSize:r=1,children:n,characters:a,onSync:s,...l},c)=>{const u=Di(({invalidate:p})=>p),[f]=ie.useState(()=>new Go),[h,d]=ie.useMemo(()=>{const p=[];let g="";return ie.Children.forEach(n,v=>{typeof v=="string"||typeof v=="number"?g+=v:p.push(v)}),[p,g]},[n]);return ll(()=>new Promise(p=>Hl({font:o,characters:a},p)),["troika-text",o,a]),ie.useLayoutEffect(()=>void f.sync(()=>{u(),s&&s(f)})),ie.useEffect(()=>()=>f.dispose(),[f]),ie.createElement("primitive",fi({object:f,ref:c,font:o,text:d,anchorX:e,anchorY:i,fontSize:r,sdfGlyphSize:t},l),h)}),sc=[{range:"0-20",min:0,max:20},{range:"20-40",min:20,max:40},{range:"40-60",min:40,max:60},{range:"60-80",min:60,max:80},{range:"80-100",min:80,max:100}];function lc(t){const e=t.length;return sc.map(({range:i,min:o,max:r})=>{const n=t.filter(a=>a.habitability_score>=o&&a.habitability_score<(r===100?101:r)).length;return{range:i,min:o,max:r,count:n,pct:e>0?n/e*100:0}})}function cc(t){return t.filter(e=>e.pl_eqt!==null&&e.pl_eqt>0).map(e=>({temp:e.pl_eqt,score:e.habitability_score,name:e.pl_name,isHabitable:e.is_habitable_zone,isEarthLike:e.is_earth_like}))}const ur=["O","B","A","F","G","K","M"];function uc(t){const e=new Map;t.forEach(r=>{const n=r.star_class||"Unknown";e.has(n)||e.set(n,{scores:[],habitableCount:0});const a=e.get(n);a.scores.push(r.habitability_score),r.is_habitable_zone&&a.habitableCount++});const i=t.length,o=[];return e.forEach((r,n)=>{const a=r.scores.reduce((s,l)=>s+l,0)/r.scores.length;o.push({starClass:n,avgScore:a,count:r.scores.length,habitableCount:r.habitableCount,pct:i>0?r.scores.length/i*100:0})}),o.sort((r,n)=>{const a=ur.indexOf(r.starClass),s=ur.indexOf(n.starClass);return a===-1&&s===-1?r.starClass.localeCompare(n.starClass):a===-1||s===-1?1:a-s})}function fc(t){const e=new Map;t.forEach(n=>{const a=n.disc_year;e.has(a)||e.set(a,{total:0,habitable:0});const s=e.get(a);s.total++,n.is_habitable_zone&&s.habitable++});const i=Array.from(e.keys()).sort((n,a)=>n-a);let o=0,r=0;return i.map(n=>{const a=e.get(n);return o+=a.total,r+=a.habitable,{year:n,total:a.total,habitable:a.habitable,cumulative:o,cumulativeHabitable:r}})}function hc(t){return t.filter(e=>e.x_pc!==null&&e.y_pc!==null&&e.z_pc!==null).map(e=>({id:e.pl_name,name:e.pl_name,x:e.x_pc,y:e.y_pc,z:e.z_pc,score:e.habitability_score,isHabitable:e.is_habitable_zone,isEarthLike:e.is_earth_like,distanceLy:e.distance_ly??0,starClass:e.star_class,planetType:e.planet_type}))}function dc(t){const e=t.filter(a=>a.is_habitable_zone),i=t.filter(a=>a.is_earth_like),o=t.reduce((a,s)=>s.habitability_score>a.score?{name:s.pl_name,score:s.habitability_score}:a,{name:"",score:0}),r=e.filter(a=>a.distance_ly!==null&&a.distance_ly>0).sort((a,s)=>(a.distance_ly??1/0)-(s.distance_ly??1/0))[0],n=t.length>0?t.reduce((a,s)=>a+s.habitability_score,0)/t.length:0;return{total:t.length,habitableZone:e.length,earthLike:i.length,topScore:o.score,topScorerName:o.name,nearestHabitable:r?{name:r.pl_name,distanceLy:r.distance_ly}:null,avgScore:n}}function pc(t,e){switch(e){case"habitable":return t.filter(i=>i.isHabitable);case"earthLike":return t.filter(i=>i.isEarthLike);case"top20":return[...t].sort((i,o)=>o.score-i.score).slice(0,20);default:return t}}const Pa=["Sub-Earth","Earth-sized","Super-Earth","Sub-Neptune","Neptune-like","Gas Giant"];function gc(t){const e=new Map;t.forEach(r=>{const n=r.star_class||"Unknown",a=r.planet_type||"Unknown",s=`${n}|${a}`;e.set(s,(e.get(s)||0)+1)});const i=[];let o=0;return ur.forEach(r=>{Pa.forEach(n=>{const a=e.get(`${r}|${n}`)||0;i.push({x:r,y:n,value:a}),a>o&&(o=a)})}),{data:i,xLabels:ur,yLabels:Pa,maxValue:o}}const mc=[{key:"is_habitable_zone",label:"Habitable Zone",category:"Habitability"},{key:"is_earth_like",label:"Earth-like",category:"Habitability"},{key:"is_potentially_rocky",label:"Potentially Rocky",category:"Habitability"},{key:"has_earth_like_insolation",label:"Earth-like Insolation",category:"Habitability"},{key:"is_conservative_habitable",label:"Conservative HZ",category:"Habitability"},{key:"is_optimistic_habitable",label:"Optimistic HZ",category:"Habitability"},{key:"is_top_habitable_candidate",label:"Top Candidate",category:"Habitability"},{key:"is_hot_jupiter",label:"Hot Jupiter",category:"Planet Type"},{key:"is_hot_neptune",label:"Hot Neptune",category:"Planet Type"},{key:"is_ultra_hot",label:"Ultra Hot",category:"Planet Type"},{key:"is_frozen_world",label:"Frozen World",category:"Planet Type"},{key:"is_puffy",label:"Puffy",category:"Planet Type"},{key:"is_ultra_dense",label:"Ultra Dense",category:"Planet Type"},{key:"is_likely_tidally_locked",label:"Tidally Locked",category:"Orbital"},{key:"is_circular_orbit",label:"Circular Orbit",category:"Orbital"},{key:"is_eccentric_orbit",label:"Eccentric Orbit",category:"Orbital"},{key:"is_ultra_short_period",label:"Ultra Short Period",category:"Orbital"},{key:"is_multi_planet_system",label:"Multi-planet System",category:"System"},{key:"is_circumbinary",label:"Circumbinary",category:"System"},{key:"is_nearby",label:"Nearby (<100 ly)",category:"System"},{key:"is_very_nearby",label:"Very Nearby (<50 ly)",category:"System"},{key:"is_sun_like_star",label:"Sun-like Star",category:"Star"},{key:"is_red_dwarf_host",label:"Red Dwarf Host",category:"Star"},{key:"is_solar_analog",label:"Solar Analog",category:"Star"}];function vc(t){const e=t.length;return mc.map(({key:i,label:o,category:r})=>{const n=t.filter(a=>a[i]===!0).length;return{feature:i,label:o,count:n,pct:e>0?n/e*100:0,category:r}}).sort((i,o)=>o.pct-i.pct)}const ni=[{key:"is_habitable_zone",label:"Habitable Zone"},{key:"is_earth_like",label:"Earth-like"},{key:"is_potentially_rocky",label:"Rocky"},{key:"has_earth_like_insolation",label:"Earth Insolation"},{key:"is_likely_tidally_locked",label:"Tidally Locked"},{key:"is_multi_planet_system",label:"Multi-planet"},{key:"is_sun_like_star",label:"Sun-like Star"},{key:"is_red_dwarf_host",label:"Red Dwarf"},{key:"is_nearby",label:"Nearby"}];function yc(t){const e=ni.map(r=>r.label),i=[];let o=0;return ni.forEach(r=>{ni.forEach(n=>{const a=t.filter(c=>c[r.key]===!0&&c[n.key]===!0).length,s=t.filter(c=>c[r.key]===!0).length,l=s>0?a/s*100:0;i.push({x:r.label,y:n.label,value:Math.round(l)}),l>o&&r.key!==n.key&&(o=l)})}),{data:i,labels:e,maxValue:100}}function bc(t){const e=t.length,i=t.filter(l=>l.is_conservative_habitable).length,o=t.filter(l=>l.is_optimistic_habitable&&!l.is_conservative_habitable).length,r=t.filter(l=>l.is_earth_like).length,n=t.filter(l=>l.is_top_habitable_candidate).length,a=t.filter(l=>l.is_potentially_rocky&&!l.is_habitable_zone).length,s=e-i-o-a;return[{category:"Top Candidates",count:n,pct:n/e*100,color:"#ffd700"},{category:"Earth-like",count:r,pct:r/e*100,color:"#00ff88"},{category:"Conservative HZ",count:i,pct:i/e*100,color:"#00ccff"},{category:"Optimistic HZ",count:o,pct:o/e*100,color:"#ff8800"},{category:"Potentially Rocky",count:a,pct:a/e*100,color:"#aa88ff"},{category:"Other",count:s,pct:s/e*100,color:"#666666"}]}const Ht=.75,Ba=2,xc=8;function _c(t,e){if(e.has(t.id))return new lt("#ffd700");if(t.isHabitable&&t.isEarthLike)return new lt("#00ff88");if(t.isHabitable)return new lt("#00ccff");if(t.score>=60)return new lt("#ff8800");const i=.2+t.score/100*.3;return new lt(i,i,i)}function wc(t){const e=t/100;return Ba+e*(xc-Ba)}function Sc(){const e=document.createElement("canvas");e.width=128,e.height=128;const i=e.getContext("2d"),o=128/2;i.clearRect(0,0,128,128);const r=i.createRadialGradient(o,o,0,o,o,o);r.addColorStop(0,"rgba(255, 255, 255, 1)"),r.addColorStop(.1,"rgba(255, 255, 255, 0.8)"),r.addColorStop(.3,"rgba(255, 255, 255, 0.3)"),r.addColorStop(.5,"rgba(255, 255, 255, 0.1)"),r.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=r,i.fillRect(0,0,128,128),i.save(),i.translate(o,o);for(let s=0;s<4;s++){i.rotate(Math.PI/2);const l=i.createLinearGradient(0,0,0,-o);l.addColorStop(0,"rgba(255, 255, 255, 0.8)"),l.addColorStop(.3,"rgba(255, 255, 255, 0.3)"),l.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=l,i.beginPath(),i.moveTo(-2,0),i.lineTo(0,-o*.9),i.lineTo(2,0),i.closePath(),i.fill()}i.restore();const n=i.createRadialGradient(o,o,0,o,o,128*.15);n.addColorStop(0,"rgba(255, 255, 255, 1)"),n.addColorStop(.5,"rgba(255, 255, 255, 0.8)"),n.addColorStop(1,"rgba(255, 255, 255, 0)"),i.fillStyle=n,i.fillRect(0,0,128,128);const a=new nl(e);return a.needsUpdate=!0,a}const kc=`
  attribute vec3 planetColor;
  attribute float planetSize;

  varying vec3 vColor;

  void main() {
    vColor = planetColor;

    vec4 mvPosition = modelViewMatrix * vec4(position, 1.0);
    gl_Position = projectionMatrix * mvPosition;

    // Size attenuation
    gl_PointSize = planetSize * (300.0 / -mvPosition.z);
    gl_PointSize = clamp(gl_PointSize, 1.0, 30.0);
  }
`,Ac=`
  uniform sampler2D uTexture;

  varying vec3 vColor;

  void main() {
    vec4 texColor = texture2D(uTexture, gl_PointCoord);
    gl_FragColor = vec4(vColor * texColor.rgb, texColor.a * 0.9);
  }
`;function Tc({planets:t,onPlanetClick:e,onPlanetHover:i}){const o=ie.useRef(null),r=ie.useRef(null),n=ie.useRef(null),[a,s]=ie.useState(-1),{gl:l,camera:c}=Di(),u=ie.useRef(null),f=5,h=ie.useMemo(()=>Sc(),[]),d=ie.useMemo(()=>{const m=[...t].sort((y,S)=>S.score-y.score);return new Set(m.slice(0,20).map(y=>y.id))},[t]),p=ie.useMemo(()=>{const m=t.length,y=new Float32Array(m*3),S=new Float32Array(m*3),D=new Float32Array(m);return t.forEach((A,M)=>{y[M*3]=A.x*Ht,y[M*3+1]=A.y*Ht,y[M*3+2]=A.z*Ht;const O=_c(A,d);S[M*3]=O.r,S[M*3+1]=O.g,S[M*3+2]=O.b,D[M]=wc(A.score)}),{positions:y,colors:S,sizes:D}},[t,d]);ie.useEffect(()=>{if(!r.current)return;const m=r.current;m.setAttribute("position",new Kr(p.positions,3)),m.setAttribute("planetColor",new Kr(p.colors,3)),m.setAttribute("planetSize",new Kr(p.sizes,1)),m.computeBoundingSphere()},[p]);const g=ie.useCallback(m=>{if(t.length===0)return;const y=l.domElement.getBoundingClientRect(),S=m.clientX-y.left,D=m.clientY-y.top;let A=-1,M=1/0;const O=20;for(let F=0;F<t.length;F++){const N=t[F],k=new We(N.x*Ht,N.y*Ht,N.z*Ht).project(c);if(k.z>1)continue;const U=(k.x+1)/2*y.width,V=(1-k.y)/2*y.height,G=S-U,q=D-V,K=Math.sqrt(G*G+q*q);K<O&&K<M&&(A=F,M=K)}A!==a?(s(A),A>=0?(l.domElement.style.cursor="pointer",i==null||i(t[A],{x:m.clientX,y:m.clientY})):(l.domElement.style.cursor="grab",i==null||i(null))):A>=0&&(i==null||i(t[A],{x:m.clientX,y:m.clientY}))},[t,a,l,c,i]),v=ie.useCallback(m=>{u.current={x:m.clientX,y:m.clientY}},[]),w=ie.useCallback(m=>{if(u.current){const y=m.clientX-u.current.x,S=m.clientY-u.current.y;if(Math.sqrt(y*y+S*S)>f)return}a>=0&&t[a]&&(e==null||e(t[a]))},[a,t,e]),_=ie.useCallback(()=>{s(-1),l.domElement.style.cursor="grab",i==null||i(null)},[l,i]);return ie.useEffect(()=>{const m=l.domElement;return m.addEventListener("pointerdown",v),m.addEventListener("pointermove",g),m.addEventListener("click",w),m.addEventListener("pointerleave",_),()=>{m.removeEventListener("pointerdown",v),m.removeEventListener("pointermove",g),m.removeEventListener("click",w),m.removeEventListener("pointerleave",_)}},[l,v,g,w,_]),ie.useEffect(()=>()=>{h.dispose()},[h]),t.length===0?null:T.jsxs("points",{ref:o,frustumCulled:!1,children:[T.jsx("bufferGeometry",{ref:r}),T.jsx("shaderMaterial",{ref:n,vertexShader:kc,fragmentShader:Ac,uniforms:{uTexture:{value:h}},transparent:!0,depthWrite:!1,blending:tl})]})}const Uc=.75/3.26,Ec=[10,50,100,500,1e3];function Mc({distance:t,color:e,opacity:i,showPrefix:o=!1}){const r=t*Uc,n=64,a=ie.useMemo(()=>{const s=[];for(let l=0;l<=n;l++){const c=l/n*Math.PI*2;s.push(new We(Math.cos(c)*r,0,Math.sin(c)*r))}return s},[r]);return T.jsxs("group",{children:[T.jsx(nr,{points:a,color:e,lineWidth:1,opacity:i,transparent:!0}),T.jsx(jo,{position:[r,0,5],fontSize:3,color:e,anchorX:"center",anchorY:"middle",children:o?`LY ${t}`:t})]})}function Cc(){return T.jsxs("group",{rotation:[0,0,0],children:[Ec.map((t,e)=>T.jsx(Mc,{distance:t,color:"#ffffff",opacity:.15-e*.02,showPrefix:e===0},t)),T.jsx("gridHelper",{args:[1e3,20,"#333333","#222222"],position:[0,-.1,0]}),T.jsx(nr,{points:[[0,0,0],[50,0,0]],color:"#ff4444",lineWidth:2,opacity:.5,transparent:!0}),T.jsx(nr,{points:[[0,0,0],[0,50,0]],color:"#44ff44",lineWidth:2,opacity:.5,transparent:!0}),T.jsx(nr,{points:[[0,0,0],[0,0,50]],color:"#4444ff",lineWidth:2,opacity:.5,transparent:!0})]})}function Dc({data:t,stats:e}){const{t:i}=Je(),o=Ps(),[r,n]=ie.useState("all"),[a,s]=ie.useState(null),[l,c]=ie.useState({x:0,y:0}),u=pc(t,r),f=ie.useCallback(d=>{o(`/planets/${tr(d.name)}`)},[o]),h=ie.useCallback((d,p)=>{s(d),p&&c(p)},[]);return T.jsxs("div",{className:"galaxy-view-container",children:[T.jsx("div",{className:"galaxy-canvas",children:T.jsx(rl,{camera:{position:[0,20,60],fov:60,near:.1,far:5e3},gl:{antialias:!0,alpha:!0},children:T.jsxs(ie.Suspense,{fallback:null,children:[T.jsx("ambientLight",{intensity:.3}),T.jsx(Tc,{planets:u,onPlanetClick:f,onPlanetHover:h}),T.jsx(Cc,{}),T.jsx(jo,{position:[0,0,0],fontSize:2,color:"#ffd700",anchorX:"center",anchorY:"middle",children:"SOL"}),T.jsx(il,{enablePan:!0,enableZoom:!0,enableRotate:!0,minDistance:20,maxDistance:1e3,minPolarAngle:0,maxPolarAngle:Math.PI,autoRotate:!0,autoRotateSpeed:.3})]})})}),T.jsxs("div",{className:"galaxy-controls",children:[T.jsx("div",{className:"filter-buttons",children:["all","habitable","earthLike","top20"].map(d=>T.jsx("button",{className:`filter-btn ${r===d?"active":""}`,onClick:()=>n(d),children:i(`pages.habitability.galaxy.filters.${d}`)},d))}),T.jsx("p",{className:"galaxy-hint",children:i("pages.habitability.galaxy.hint")})]}),T.jsxs("div",{className:"galaxy-legend",children:[T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot top"}),T.jsx("span",{children:i("pages.habitability.galaxy.legend.top")})]}),T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot habitable-earthlike"}),T.jsx("span",{children:i("pages.habitability.galaxy.legend.habitableEarthLike")})]}),T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot habitable"}),T.jsx("span",{children:i("pages.habitability.galaxy.legend.habitable")})]}),T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot other"}),T.jsx("span",{children:i("pages.habitability.galaxy.legend.other")})]})]}),T.jsxs("div",{className:"galaxy-callouts",children:[e.nearestHabitable&&T.jsxs("div",{className:"galaxy-callout clickable",onClick:()=>o(`/planets/${tr(e.nearestHabitable.name)}`),children:[T.jsxs("span",{className:"callout-label",children:[i("pages.habitability.stats.nearest"),":"]}),T.jsx("span",{className:"callout-value",children:e.nearestHabitable.name}),T.jsx("span",{className:"callout-distance",children:i("pages.habitability.galaxy.distance",{distance:e.nearestHabitable.distanceLy.toFixed(1)})})]}),e.topScorerName&&T.jsxs("div",{className:"galaxy-callout clickable",onClick:()=>o(`/planets/${tr(e.topScorerName)}`),children:[T.jsxs("span",{className:"callout-label",children:[i("pages.habitability.stats.topScore"),":"]}),T.jsx("span",{className:"callout-value",children:e.topScorerName}),T.jsx("span",{className:"callout-score",children:i("pages.habitability.charts.score",{score:e.topScore.toFixed(1)})})]})]}),a&&T.jsxs("div",{className:"galaxy-tooltip",style:{left:l.x+15,top:l.y-10},children:[T.jsx("div",{className:"tooltip-name",children:a.name}),T.jsx("div",{className:"tooltip-score",children:i("pages.habitability.charts.score",{score:a.score.toFixed(1)})}),T.jsxs("div",{className:"tooltip-distance",children:[a.distanceLy.toFixed(1)," ",i("pages.habitability.charts.lightYears")]}),a.isHabitable&&T.jsx("div",{className:"tooltip-badge habitable",children:i("pages.habitability.charts.badges.habitableZone")}),a.isEarthLike&&T.jsx("div",{className:"tooltip-badge earth-like",children:i("pages.habitability.charts.badges.earthLike")})]})]})}function Fc({stats:t}){const{t:e}=Je(),i=[{key:"total",value:t.total.toLocaleString(),label:e("pages.habitability.stats.total")},{key:"habitableZone",value:t.habitableZone.toLocaleString(),label:e("pages.habitability.stats.habitableZone"),highlight:!0},{key:"earthLike",value:t.earthLike.toLocaleString(),label:e("pages.habitability.stats.earthLike"),highlight:!0},{key:"topScore",value:t.topScore.toFixed(1),label:e("pages.habitability.stats.topScore"),sublabel:t.topScorerName}];return T.jsx("div",{className:"habitability-stats-bar",children:i.map(o=>T.jsxs("div",{className:`stat-item ${o.highlight?"highlight":""}`,children:[T.jsx("div",{className:"stat-value",children:o.value}),T.jsx("div",{className:"stat-label",children:o.label}),o.sublabel&&T.jsx("div",{className:"stat-sublabel",children:o.sublabel})]},o.key))})}function Rc({candidates:t}){return T.jsx("div",{className:"candidates-grid",children:t.map((e,i)=>T.jsx(Lc,{planet:e,rank:i+1},e.pl_name))})}function Lc({planet:t,rank:e}){const{t:i}=Je();return T.jsxs(Bs,{to:`/planets/${tr(t.pl_name)}`,className:"candidate-card",children:[T.jsx("div",{className:"candidate-rank",children:i("pages.habitability.candidates.rank",{rank:e})}),T.jsxs("div",{className:"candidate-content",children:[T.jsx("h4",{className:"candidate-name",children:t.pl_name}),T.jsxs("div",{className:"candidate-score",children:[T.jsx("span",{className:"score-value",children:t.habitability_score.toFixed(1)}),T.jsx("span",{className:"score-label",children:"/ 100"})]}),T.jsxs("div",{className:"candidate-details",children:[t.planet_type&&T.jsx("span",{className:"detail-item",children:t.planet_type}),t.distance_ly&&T.jsx("span",{className:"detail-item",children:i("pages.habitability.candidates.distance",{distance:t.distance_ly.toFixed(1)})}),t.pl_eqt&&T.jsxs("span",{className:"detail-item",children:[t.pl_eqt.toFixed(0),"K"]})]}),T.jsxs("div",{className:"candidate-badges",children:[t.is_habitable_zone&&T.jsx("span",{className:"badge habitable",children:i("pages.habitability.charts.badges.habitableZone")}),t.is_earth_like&&T.jsx("span",{className:"badge earth-like",children:i("pages.habitability.charts.badges.earthLike")})]})]}),T.jsxs("div",{className:"candidate-hover",children:[i("pages.habitability.candidates.viewDetails")," "]})]})}function ar(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Nc(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function zo(t){let e,i,o;t.length!==2?(e=ar,i=(s,l)=>ar(t(s),l),o=(s,l)=>t(s)-l):(e=t===ar||t===Nc?t:Oc,i=t,o=t);function r(s,l,c=0,u=s.length){if(c<u){if(e(l,l)!==0)return u;do{const f=c+u>>>1;i(s[f],l)<0?c=f+1:u=f}while(c<u)}return c}function n(s,l,c=0,u=s.length){if(c<u){if(e(l,l)!==0)return u;do{const f=c+u>>>1;i(s[f],l)<=0?c=f+1:u=f}while(c<u)}return c}function a(s,l,c=0,u=s.length){const f=r(s,l,c,u-1);return f>c&&o(s[f-1],l)>-o(s[f],l)?f-1:f}return{left:r,center:a,right:n}}function Oc(){return 0}function Pc(t){return t===null?NaN:+t}const Bc=zo(ar),Ic=Bc.right;zo(Pc).center;class Ia extends Map{constructor(e,i=zc){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),e!=null)for(const[o,r]of e)this.set(o,r)}get(e){return super.get(Ga(this,e))}has(e){return super.has(Ga(this,e))}set(e,i){return super.set(Gc(this,e),i)}delete(e){return super.delete(jc(this,e))}}function Ga({_intern:t,_key:e},i){const o=e(i);return t.has(o)?t.get(o):i}function Gc({_intern:t,_key:e},i){const o=e(i);return t.has(o)?t.get(o):(t.set(o,i),i)}function jc({_intern:t,_key:e},i){const o=e(i);return t.has(o)&&(i=t.get(o),t.delete(o)),i}function zc(t){return t!==null&&typeof t=="object"?t.valueOf():t}const Wc=Math.sqrt(50),Hc=Math.sqrt(10),Vc=Math.sqrt(2);function fr(t,e,i){const o=(e-t)/Math.max(0,i),r=Math.floor(Math.log10(o)),n=o/Math.pow(10,r),a=n>=Wc?10:n>=Hc?5:n>=Vc?2:1;let s,l,c;return r<0?(c=Math.pow(10,-r)/a,s=Math.round(t*c),l=Math.round(e*c),s/c<t&&++s,l/c>e&&--l,c=-c):(c=Math.pow(10,r)*a,s=Math.round(t/c),l=Math.round(e/c),s*c<t&&++s,l*c>e&&--l),l<s&&.5<=i&&i<2?fr(t,e,i*2):[s,l,c]}function mi(t,e,i){if(e=+e,t=+t,i=+i,!(i>0))return[];if(t===e)return[t];const o=e<t,[r,n,a]=o?fr(e,t,i):fr(t,e,i);if(!(n>=r))return[];const s=n-r+1,l=new Array(s);if(o)if(a<0)for(let c=0;c<s;++c)l[c]=(n-c)/-a;else for(let c=0;c<s;++c)l[c]=(n-c)*a;else if(a<0)for(let c=0;c<s;++c)l[c]=(r+c)/-a;else for(let c=0;c<s;++c)l[c]=(r+c)*a;return l}function vi(t,e,i){return e=+e,t=+t,i=+i,fr(t,e,i)[2]}function Xc(t,e,i){e=+e,t=+t,i=+i;const o=e<t,r=o?vi(e,t,i):vi(t,e,i);return(o?-1:1)*(r<0?1/-r:r)}function xn(t,e){let i;if(e===void 0)for(const o of t)o!=null&&(i<o||i===void 0&&o>=o)&&(i=o);else{let o=-1;for(let r of t)(r=e(r,++o,t))!=null&&(i<r||i===void 0&&r>=r)&&(i=r)}return i}function ja(t,e){let i;if(e===void 0)for(const o of t)o!=null&&(i>o||i===void 0&&o>=o)&&(i=o);else{let o=-1;for(let r of t)(r=e(r,++o,t))!=null&&(i>r||i===void 0&&r>=r)&&(i=r)}return i}function Yc(t,e,i){t=+t,e=+e,i=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+i;for(var o=-1,r=Math.max(0,Math.ceil((e-t)/i))|0,n=new Array(r);++o<r;)n[o]=t+o*i;return n}function qc(t){return t}var ri=1,ii=2,yi=3,pn=4,za=1e-6;function Kc(t){return"translate("+t+",0)"}function Zc(t){return"translate(0,"+t+")"}function Jc(t){return e=>+t(e)}function $c(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),i=>+t(i)+e}function Qc(){return!this.__axis}function Wo(t,e){var i=[],o=null,r=null,n=6,a=6,s=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,c=t===ri||t===pn?-1:1,u=t===pn||t===ii?"x":"y",f=t===ri||t===yi?Kc:Zc;function h(d){var p=o??(e.ticks?e.ticks.apply(e,i):e.domain()),g=r??(e.tickFormat?e.tickFormat.apply(e,i):qc),v=Math.max(n,0)+s,w=e.range(),_=+w[0]+l,m=+w[w.length-1]+l,y=(e.bandwidth?$c:Jc)(e.copy(),l),S=d.selection?d.selection():d,D=S.selectAll(".domain").data([null]),A=S.selectAll(".tick").data(p,e).order(),M=A.exit(),O=A.enter().append("g").attr("class","tick"),F=A.select("line"),N=A.select("text");D=D.merge(D.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),A=A.merge(O),F=F.merge(O.append("line").attr("stroke","currentColor").attr(u+"2",c*n)),N=N.merge(O.append("text").attr("fill","currentColor").attr(u,c*v).attr("dy",t===ri?"0em":t===yi?"0.71em":"0.32em")),d!==S&&(D=D.transition(d),A=A.transition(d),F=F.transition(d),N=N.transition(d),M=M.transition(d).attr("opacity",za).attr("transform",function(x){return isFinite(x=y(x))?f(x+l):this.getAttribute("transform")}),O.attr("opacity",za).attr("transform",function(x){var k=this.parentNode.__axis;return f((k&&isFinite(k=k(x))?k:y(x))+l)})),M.remove(),D.attr("d",t===pn||t===ii?a?"M"+c*a+","+_+"H"+l+"V"+m+"H"+c*a:"M"+l+","+_+"V"+m:a?"M"+_+","+c*a+"V"+l+"H"+m+"V"+c*a:"M"+_+","+l+"H"+m),A.attr("opacity",1).attr("transform",function(x){return f(y(x)+l)}),F.attr(u+"2",c*n),N.attr(u,c*v).text(g),S.filter(Qc).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ii?"start":t===pn?"end":"middle"),S.each(function(){this.__axis=y})}return h.scale=function(d){return arguments.length?(e=d,h):e},h.ticks=function(){return i=Array.from(arguments),h},h.tickArguments=function(d){return arguments.length?(i=d==null?[]:Array.from(d),h):i.slice()},h.tickValues=function(d){return arguments.length?(o=d==null?null:Array.from(d),h):o&&o.slice()},h.tickFormat=function(d){return arguments.length?(r=d,h):r},h.tickSize=function(d){return arguments.length?(n=a=+d,h):n},h.tickSizeInner=function(d){return arguments.length?(n=+d,h):n},h.tickSizeOuter=function(d){return arguments.length?(a=+d,h):a},h.tickPadding=function(d){return arguments.length?(s=+d,h):s},h.offset=function(d){return arguments.length?(l=+d,h):l},h}function Lt(t){return Wo(yi,t)}function mt(t){return Wo(pn,t)}var eu={value:()=>{}};function Ho(){for(var t=0,e=arguments.length,i={},o;t<e;++t){if(!(o=arguments[t]+"")||o in i||/[\s.]/.test(o))throw new Error("illegal type: "+o);i[o]=[]}return new or(i)}function or(t){this._=t}function tu(t,e){return t.trim().split(/^|\s+/).map(function(i){var o="",r=i.indexOf(".");if(r>=0&&(o=i.slice(r+1),i=i.slice(0,r)),i&&!e.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:o}})}or.prototype=Ho.prototype={constructor:or,on:function(t,e){var i=this._,o=tu(t+"",i),r,n=-1,a=o.length;if(arguments.length<2){for(;++n<a;)if((r=(t=o[n]).type)&&(r=nu(i[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++n<a;)if(r=(t=o[n]).type)i[r]=Wa(i[r],t.name,e);else if(e==null)for(r in i)i[r]=Wa(i[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var i in e)t[i]=e[i].slice();return new or(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var i=new Array(r),o=0,r,n;o<r;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(n=this._[t],o=0,r=n.length;o<r;++o)n[o].value.apply(e,i)},apply:function(t,e,i){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var o=this._[t],r=0,n=o.length;r<n;++r)o[r].value.apply(e,i)}};function nu(t,e){for(var i=0,o=t.length,r;i<o;++i)if((r=t[i]).name===e)return r.value}function Wa(t,e,i){for(var o=0,r=t.length;o<r;++o)if(t[o].name===e){t[o]=eu,t=t.slice(0,o).concat(t.slice(o+1));break}return i!=null&&t.push({name:e,value:i}),t}var bi="http://www.w3.org/1999/xhtml";const Ha={svg:"http://www.w3.org/2000/svg",xhtml:bi,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Sr(t){var e=t+="",i=e.indexOf(":");return i>=0&&(e=t.slice(0,i))!=="xmlns"&&(t=t.slice(i+1)),Ha.hasOwnProperty(e)?{space:Ha[e],local:t}:t}function ru(t){return function(){var e=this.ownerDocument,i=this.namespaceURI;return i===bi&&e.documentElement.namespaceURI===bi?e.createElement(t):e.createElementNS(i,t)}}function iu(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Vo(t){var e=Sr(t);return(e.local?iu:ru)(e)}function au(){}function Oi(t){return t==null?au:function(){return this.querySelector(t)}}function ou(t){typeof t!="function"&&(t=Oi(t));for(var e=this._groups,i=e.length,o=new Array(i),r=0;r<i;++r)for(var n=e[r],a=n.length,s=o[r]=new Array(a),l,c,u=0;u<a;++u)(l=n[u])&&(c=t.call(l,l.__data__,u,n))&&("__data__"in l&&(c.__data__=l.__data__),s[u]=c);return new Ze(o,this._parents)}function su(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function lu(){return[]}function Xo(t){return t==null?lu:function(){return this.querySelectorAll(t)}}function cu(t){return function(){return su(t.apply(this,arguments))}}function uu(t){typeof t=="function"?t=cu(t):t=Xo(t);for(var e=this._groups,i=e.length,o=[],r=[],n=0;n<i;++n)for(var a=e[n],s=a.length,l,c=0;c<s;++c)(l=a[c])&&(o.push(t.call(l,l.__data__,c,a)),r.push(l));return new Ze(o,r)}function Yo(t){return function(){return this.matches(t)}}function qo(t){return function(e){return e.matches(t)}}var fu=Array.prototype.find;function hu(t){return function(){return fu.call(this.children,t)}}function du(){return this.firstElementChild}function pu(t){return this.select(t==null?du:hu(typeof t=="function"?t:qo(t)))}var gu=Array.prototype.filter;function mu(){return Array.from(this.children)}function vu(t){return function(){return gu.call(this.children,t)}}function yu(t){return this.selectAll(t==null?mu:vu(typeof t=="function"?t:qo(t)))}function bu(t){typeof t!="function"&&(t=Yo(t));for(var e=this._groups,i=e.length,o=new Array(i),r=0;r<i;++r)for(var n=e[r],a=n.length,s=o[r]=[],l,c=0;c<a;++c)(l=n[c])&&t.call(l,l.__data__,c,n)&&s.push(l);return new Ze(o,this._parents)}function Ko(t){return new Array(t.length)}function xu(){return new Ze(this._enter||this._groups.map(Ko),this._parents)}function hr(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}hr.prototype={constructor:hr,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function _u(t){return function(){return t}}function wu(t,e,i,o,r,n){for(var a=0,s,l=e.length,c=n.length;a<c;++a)(s=e[a])?(s.__data__=n[a],o[a]=s):i[a]=new hr(t,n[a]);for(;a<l;++a)(s=e[a])&&(r[a]=s)}function Su(t,e,i,o,r,n,a){var s,l,c=new Map,u=e.length,f=n.length,h=new Array(u),d;for(s=0;s<u;++s)(l=e[s])&&(h[s]=d=a.call(l,l.__data__,s,e)+"",c.has(d)?r[s]=l:c.set(d,l));for(s=0;s<f;++s)d=a.call(t,n[s],s,n)+"",(l=c.get(d))?(o[s]=l,l.__data__=n[s],c.delete(d)):i[s]=new hr(t,n[s]);for(s=0;s<u;++s)(l=e[s])&&c.get(h[s])===l&&(r[s]=l)}function ku(t){return t.__data__}function Au(t,e){if(!arguments.length)return Array.from(this,ku);var i=e?Su:wu,o=this._parents,r=this._groups;typeof t!="function"&&(t=_u(t));for(var n=r.length,a=new Array(n),s=new Array(n),l=new Array(n),c=0;c<n;++c){var u=o[c],f=r[c],h=f.length,d=Tu(t.call(u,u&&u.__data__,c,o)),p=d.length,g=s[c]=new Array(p),v=a[c]=new Array(p),w=l[c]=new Array(h);i(u,f,g,v,w,d,e);for(var _=0,m=0,y,S;_<p;++_)if(y=g[_]){for(_>=m&&(m=_+1);!(S=v[m])&&++m<p;);y._next=S||null}}return a=new Ze(a,o),a._enter=s,a._exit=l,a}function Tu(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Uu(){return new Ze(this._exit||this._groups.map(Ko),this._parents)}function Eu(t,e,i){var o=this.enter(),r=this,n=this.exit();return typeof t=="function"?(o=t(o),o&&(o=o.selection())):o=o.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),i==null?n.remove():i(n),o&&r?o.merge(r).order():r}function Mu(t){for(var e=t.selection?t.selection():t,i=this._groups,o=e._groups,r=i.length,n=o.length,a=Math.min(r,n),s=new Array(r),l=0;l<a;++l)for(var c=i[l],u=o[l],f=c.length,h=s[l]=new Array(f),d,p=0;p<f;++p)(d=c[p]||u[p])&&(h[p]=d);for(;l<r;++l)s[l]=i[l];return new Ze(s,this._parents)}function Cu(){for(var t=this._groups,e=-1,i=t.length;++e<i;)for(var o=t[e],r=o.length-1,n=o[r],a;--r>=0;)(a=o[r])&&(n&&a.compareDocumentPosition(n)^4&&n.parentNode.insertBefore(a,n),n=a);return this}function Du(t){t||(t=Fu);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var i=this._groups,o=i.length,r=new Array(o),n=0;n<o;++n){for(var a=i[n],s=a.length,l=r[n]=new Array(s),c,u=0;u<s;++u)(c=a[u])&&(l[u]=c);l.sort(e)}return new Ze(r,this._parents).order()}function Fu(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ru(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Lu(){return Array.from(this)}function Nu(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var o=t[e],r=0,n=o.length;r<n;++r){var a=o[r];if(a)return a}return null}function Ou(){let t=0;for(const e of this)++t;return t}function Pu(){return!this.node()}function Bu(t){for(var e=this._groups,i=0,o=e.length;i<o;++i)for(var r=e[i],n=0,a=r.length,s;n<a;++n)(s=r[n])&&t.call(s,s.__data__,n,r);return this}function Iu(t){return function(){this.removeAttribute(t)}}function Gu(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ju(t,e){return function(){this.setAttribute(t,e)}}function zu(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Wu(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttribute(t):this.setAttribute(t,i)}}function Hu(t,e){return function(){var i=e.apply(this,arguments);i==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,i)}}function Vu(t,e){var i=Sr(t);if(arguments.length<2){var o=this.node();return i.local?o.getAttributeNS(i.space,i.local):o.getAttribute(i)}return this.each((e==null?i.local?Gu:Iu:typeof e=="function"?i.local?Hu:Wu:i.local?zu:ju)(i,e))}function Zo(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Xu(t){return function(){this.style.removeProperty(t)}}function Yu(t,e,i){return function(){this.style.setProperty(t,e,i)}}function qu(t,e,i){return function(){var o=e.apply(this,arguments);o==null?this.style.removeProperty(t):this.style.setProperty(t,o,i)}}function Ku(t,e,i){return arguments.length>1?this.each((e==null?Xu:typeof e=="function"?qu:Yu)(t,e,i??"")):Kt(this.node(),t)}function Kt(t,e){return t.style.getPropertyValue(e)||Zo(t).getComputedStyle(t,null).getPropertyValue(e)}function Zu(t){return function(){delete this[t]}}function Ju(t,e){return function(){this[t]=e}}function $u(t,e){return function(){var i=e.apply(this,arguments);i==null?delete this[t]:this[t]=i}}function Qu(t,e){return arguments.length>1?this.each((e==null?Zu:typeof e=="function"?$u:Ju)(t,e)):this.node()[t]}function Jo(t){return t.trim().split(/^|\s+/)}function Pi(t){return t.classList||new $o(t)}function $o(t){this._node=t,this._names=Jo(t.getAttribute("class")||"")}$o.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Qo(t,e){for(var i=Pi(t),o=-1,r=e.length;++o<r;)i.add(e[o])}function es(t,e){for(var i=Pi(t),o=-1,r=e.length;++o<r;)i.remove(e[o])}function ef(t){return function(){Qo(this,t)}}function tf(t){return function(){es(this,t)}}function nf(t,e){return function(){(e.apply(this,arguments)?Qo:es)(this,t)}}function rf(t,e){var i=Jo(t+"");if(arguments.length<2){for(var o=Pi(this.node()),r=-1,n=i.length;++r<n;)if(!o.contains(i[r]))return!1;return!0}return this.each((typeof e=="function"?nf:e?ef:tf)(i,e))}function af(){this.textContent=""}function of(t){return function(){this.textContent=t}}function sf(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function lf(t){return arguments.length?this.each(t==null?af:(typeof t=="function"?sf:of)(t)):this.node().textContent}function cf(){this.innerHTML=""}function uf(t){return function(){this.innerHTML=t}}function ff(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function hf(t){return arguments.length?this.each(t==null?cf:(typeof t=="function"?ff:uf)(t)):this.node().innerHTML}function df(){this.nextSibling&&this.parentNode.appendChild(this)}function pf(){return this.each(df)}function gf(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function mf(){return this.each(gf)}function vf(t){var e=typeof t=="function"?t:Vo(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function yf(){return null}function bf(t,e){var i=typeof t=="function"?t:Vo(t),o=e==null?yf:typeof e=="function"?e:Oi(e);return this.select(function(){return this.insertBefore(i.apply(this,arguments),o.apply(this,arguments)||null)})}function xf(){var t=this.parentNode;t&&t.removeChild(this)}function _f(){return this.each(xf)}function wf(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Sf(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kf(t){return this.select(t?Sf:wf)}function Af(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Tf(t){return function(e){t.call(this,e,this.__data__)}}function Uf(t){return t.trim().split(/^|\s+/).map(function(e){var i="",o=e.indexOf(".");return o>=0&&(i=e.slice(o+1),e=e.slice(0,o)),{type:e,name:i}})}function Ef(t){return function(){var e=this.__on;if(e){for(var i=0,o=-1,r=e.length,n;i<r;++i)n=e[i],(!t.type||n.type===t.type)&&n.name===t.name?this.removeEventListener(n.type,n.listener,n.options):e[++o]=n;++o?e.length=o:delete this.__on}}}function Mf(t,e,i){return function(){var o=this.__on,r,n=Tf(e);if(o){for(var a=0,s=o.length;a<s;++a)if((r=o[a]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=n,r.options=i),r.value=e;return}}this.addEventListener(t.type,n,i),r={type:t.type,name:t.name,value:e,listener:n,options:i},o?o.push(r):this.__on=[r]}}function Cf(t,e,i){var o=Uf(t+""),r,n=o.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,c=s.length,u;l<c;++l)for(r=0,u=s[l];r<n;++r)if((a=o[r]).type===u.type&&a.name===u.name)return u.value}return}for(s=e?Mf:Ef,r=0;r<n;++r)this.each(s(o[r],e,i));return this}function ts(t,e,i){var o=Zo(t),r=o.CustomEvent;typeof r=="function"?r=new r(e,i):(r=o.document.createEvent("Event"),i?(r.initEvent(e,i.bubbles,i.cancelable),r.detail=i.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Df(t,e){return function(){return ts(this,t,e)}}function Ff(t,e){return function(){return ts(this,t,e.apply(this,arguments))}}function Rf(t,e){return this.each((typeof e=="function"?Ff:Df)(t,e))}function*Lf(){for(var t=this._groups,e=0,i=t.length;e<i;++e)for(var o=t[e],r=0,n=o.length,a;r<n;++r)(a=o[r])&&(yield a)}var ns=[null];function Ze(t,e){this._groups=t,this._parents=e}function En(){return new Ze([[document.documentElement]],ns)}function Nf(){return this}Ze.prototype=En.prototype={constructor:Ze,select:ou,selectAll:uu,selectChild:pu,selectChildren:yu,filter:bu,data:Au,enter:xu,exit:Uu,join:Eu,merge:Mu,selection:Nf,order:Cu,sort:Du,call:Ru,nodes:Lu,node:Nu,size:Ou,empty:Pu,each:Bu,attr:Vu,style:Ku,property:Qu,classed:rf,text:lf,html:hf,raise:pf,lower:mf,append:vf,insert:bf,remove:_f,clone:kf,datum:Af,on:Cf,dispatch:Rf,[Symbol.iterator]:Lf};function ut(t){return typeof t=="string"?new Ze([[document.querySelector(t)]],[document.documentElement]):new Ze([[t]],ns)}function Bi(t,e,i){t.prototype=e.prototype=i,i.constructor=t}function rs(t,e){var i=Object.create(t.prototype);for(var o in e)i[o]=e[o];return i}function Mn(){}var _n=.7,dr=1/_n,Yt="\\s*([+-]?\\d+)\\s*",wn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ft="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Of=/^#([0-9a-f]{3,8})$/,Pf=new RegExp(`^rgb\\(${Yt},${Yt},${Yt}\\)$`),Bf=new RegExp(`^rgb\\(${ft},${ft},${ft}\\)$`),If=new RegExp(`^rgba\\(${Yt},${Yt},${Yt},${wn}\\)$`),Gf=new RegExp(`^rgba\\(${ft},${ft},${ft},${wn}\\)$`),jf=new RegExp(`^hsl\\(${wn},${ft},${ft}\\)$`),zf=new RegExp(`^hsla\\(${wn},${ft},${ft},${wn}\\)$`),Va={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Bi(Mn,Nt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Xa,formatHex:Xa,formatHex8:Wf,formatHsl:Hf,formatRgb:Ya,toString:Ya});function Xa(){return this.rgb().formatHex()}function Wf(){return this.rgb().formatHex8()}function Hf(){return is(this).formatHsl()}function Ya(){return this.rgb().formatRgb()}function Nt(t){var e,i;return t=(t+"").trim().toLowerCase(),(e=Of.exec(t))?(i=e[1].length,e=parseInt(e[1],16),i===6?qa(e):i===3?new qe(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):i===8?Kn(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):i===4?Kn(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Pf.exec(t))?new qe(e[1],e[2],e[3],1):(e=Bf.exec(t))?new qe(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=If.exec(t))?Kn(e[1],e[2],e[3],e[4]):(e=Gf.exec(t))?Kn(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=jf.exec(t))?Ja(e[1],e[2]/100,e[3]/100,1):(e=zf.exec(t))?Ja(e[1],e[2]/100,e[3]/100,e[4]):Va.hasOwnProperty(t)?qa(Va[t]):t==="transparent"?new qe(NaN,NaN,NaN,0):null}function qa(t){return new qe(t>>16&255,t>>8&255,t&255,1)}function Kn(t,e,i,o){return o<=0&&(t=e=i=NaN),new qe(t,e,i,o)}function Vf(t){return t instanceof Mn||(t=Nt(t)),t?(t=t.rgb(),new qe(t.r,t.g,t.b,t.opacity)):new qe}function xi(t,e,i,o){return arguments.length===1?Vf(t):new qe(t,e,i,o??1)}function qe(t,e,i,o){this.r=+t,this.g=+e,this.b=+i,this.opacity=+o}Bi(qe,xi,rs(Mn,{brighter(t){return t=t==null?dr:Math.pow(dr,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?_n:Math.pow(_n,t),new qe(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new qe(Rt(this.r),Rt(this.g),Rt(this.b),pr(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ka,formatHex:Ka,formatHex8:Xf,formatRgb:Za,toString:Za}));function Ka(){return`#${Ct(this.r)}${Ct(this.g)}${Ct(this.b)}`}function Xf(){return`#${Ct(this.r)}${Ct(this.g)}${Ct(this.b)}${Ct((isNaN(this.opacity)?1:this.opacity)*255)}`}function Za(){const t=pr(this.opacity);return`${t===1?"rgb(":"rgba("}${Rt(this.r)}, ${Rt(this.g)}, ${Rt(this.b)}${t===1?")":`, ${t})`}`}function pr(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Rt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ct(t){return t=Rt(t),(t<16?"0":"")+t.toString(16)}function Ja(t,e,i,o){return o<=0?t=e=i=NaN:i<=0||i>=1?t=e=NaN:e<=0&&(t=NaN),new nt(t,e,i,o)}function is(t){if(t instanceof nt)return new nt(t.h,t.s,t.l,t.opacity);if(t instanceof Mn||(t=Nt(t)),!t)return new nt;if(t instanceof nt)return t;t=t.rgb();var e=t.r/255,i=t.g/255,o=t.b/255,r=Math.min(e,i,o),n=Math.max(e,i,o),a=NaN,s=n-r,l=(n+r)/2;return s?(e===n?a=(i-o)/s+(i<o)*6:i===n?a=(o-e)/s+2:a=(e-i)/s+4,s/=l<.5?n+r:2-n-r,a*=60):s=l>0&&l<1?0:a,new nt(a,s,l,t.opacity)}function Yf(t,e,i,o){return arguments.length===1?is(t):new nt(t,e,i,o??1)}function nt(t,e,i,o){this.h=+t,this.s=+e,this.l=+i,this.opacity=+o}Bi(nt,Yf,rs(Mn,{brighter(t){return t=t==null?dr:Math.pow(dr,t),new nt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?_n:Math.pow(_n,t),new nt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,i=this.l,o=i+(i<.5?i:1-i)*e,r=2*i-o;return new qe(ai(t>=240?t-240:t+120,r,o),ai(t,r,o),ai(t<120?t+240:t-120,r,o),this.opacity)},clamp(){return new nt($a(this.h),Zn(this.s),Zn(this.l),pr(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=pr(this.opacity);return`${t===1?"hsl(":"hsla("}${$a(this.h)}, ${Zn(this.s)*100}%, ${Zn(this.l)*100}%${t===1?")":`, ${t})`}`}}));function $a(t){return t=(t||0)%360,t<0?t+360:t}function Zn(t){return Math.max(0,Math.min(1,t||0))}function ai(t,e,i){return(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)*255}const Ii=t=>()=>t;function qf(t,e){return function(i){return t+i*e}}function Kf(t,e,i){return t=Math.pow(t,i),e=Math.pow(e,i)-t,i=1/i,function(o){return Math.pow(t+o*e,i)}}function Zf(t){return(t=+t)==1?as:function(e,i){return i-e?Kf(e,i,t):Ii(isNaN(e)?i:e)}}function as(t,e){var i=e-t;return i?qf(t,i):Ii(isNaN(t)?e:t)}const Sn=function t(e){var i=Zf(e);function o(r,n){var a=i((r=xi(r)).r,(n=xi(n)).r),s=i(r.g,n.g),l=i(r.b,n.b),c=as(r.opacity,n.opacity);return function(u){return r.r=a(u),r.g=s(u),r.b=l(u),r.opacity=c(u),r+""}}return o.gamma=t,o}(1);function Jf(t,e){e||(e=[]);var i=t?Math.min(e.length,t.length):0,o=e.slice(),r;return function(n){for(r=0;r<i;++r)o[r]=t[r]*(1-n)+e[r]*n;return o}}function $f(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Qf(t,e){var i=e?e.length:0,o=t?Math.min(i,t.length):0,r=new Array(o),n=new Array(i),a;for(a=0;a<o;++a)r[a]=kr(t[a],e[a]);for(;a<i;++a)n[a]=e[a];return function(s){for(a=0;a<o;++a)n[a]=r[a](s);return n}}function eh(t,e){var i=new Date;return t=+t,e=+e,function(o){return i.setTime(t*(1-o)+e*o),i}}function tt(t,e){return t=+t,e=+e,function(i){return t*(1-i)+e*i}}function th(t,e){var i={},o={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?i[r]=kr(t[r],e[r]):o[r]=e[r];return function(n){for(r in i)o[r]=i[r](n);return o}}var _i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,oi=new RegExp(_i.source,"g");function nh(t){return function(){return t}}function rh(t){return function(e){return t(e)+""}}function os(t,e){var i=_i.lastIndex=oi.lastIndex=0,o,r,n,a=-1,s=[],l=[];for(t=t+"",e=e+"";(o=_i.exec(t))&&(r=oi.exec(e));)(n=r.index)>i&&(n=e.slice(i,n),s[a]?s[a]+=n:s[++a]=n),(o=o[0])===(r=r[0])?s[a]?s[a]+=r:s[++a]=r:(s[++a]=null,l.push({i:a,x:tt(o,r)})),i=oi.lastIndex;return i<e.length&&(n=e.slice(i),s[a]?s[a]+=n:s[++a]=n),s.length<2?l[0]?rh(l[0].x):nh(e):(e=l.length,function(c){for(var u=0,f;u<e;++u)s[(f=l[u]).i]=f.x(c);return s.join("")})}function kr(t,e){var i=typeof e,o;return e==null||i==="boolean"?Ii(e):(i==="number"?tt:i==="string"?(o=Nt(e))?(e=o,Sn):os:e instanceof Nt?Sn:e instanceof Date?eh:$f(e)?Jf:Array.isArray(e)?Qf:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?th:tt)(t,e)}function ss(t,e){return t=+t,e=+e,function(i){return Math.round(t*(1-i)+e*i)}}var Qa=180/Math.PI,wi={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ls(t,e,i,o,r,n){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*i+e*o)&&(i-=t*l,o-=e*l),(s=Math.sqrt(i*i+o*o))&&(i/=s,o/=s,l/=s),t*o<e*i&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:n,rotate:Math.atan2(e,t)*Qa,skewX:Math.atan(l)*Qa,scaleX:a,scaleY:s}}var Jn;function ih(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?wi:ls(e.a,e.b,e.c,e.d,e.e,e.f)}function ah(t){return t==null||(Jn||(Jn=document.createElementNS("http://www.w3.org/2000/svg","g")),Jn.setAttribute("transform",t),!(t=Jn.transform.baseVal.consolidate()))?wi:(t=t.matrix,ls(t.a,t.b,t.c,t.d,t.e,t.f))}function cs(t,e,i,o){function r(c){return c.length?c.pop()+" ":""}function n(c,u,f,h,d,p){if(c!==f||u!==h){var g=d.push("translate(",null,e,null,i);p.push({i:g-4,x:tt(c,f)},{i:g-2,x:tt(u,h)})}else(f||h)&&d.push("translate("+f+e+h+i)}function a(c,u,f,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:f.push(r(f)+"rotate(",null,o)-2,x:tt(c,u)})):u&&f.push(r(f)+"rotate("+u+o)}function s(c,u,f,h){c!==u?h.push({i:f.push(r(f)+"skewX(",null,o)-2,x:tt(c,u)}):u&&f.push(r(f)+"skewX("+u+o)}function l(c,u,f,h,d,p){if(c!==f||u!==h){var g=d.push(r(d)+"scale(",null,",",null,")");p.push({i:g-4,x:tt(c,f)},{i:g-2,x:tt(u,h)})}else(f!==1||h!==1)&&d.push(r(d)+"scale("+f+","+h+")")}return function(c,u){var f=[],h=[];return c=t(c),u=t(u),n(c.translateX,c.translateY,u.translateX,u.translateY,f,h),a(c.rotate,u.rotate,f,h),s(c.skewX,u.skewX,f,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,h),c=u=null,function(d){for(var p=-1,g=h.length,v;++p<g;)f[(v=h[p]).i]=v.x(d);return f.join("")}}}var oh=cs(ih,"px, ","px)","deg)"),sh=cs(ah,", ",")",")"),Zt=0,gn=0,hn=0,us=1e3,gr,mn,mr=0,Ot=0,Ar=0,kn=typeof performance=="object"&&performance.now?performance:Date,fs=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Gi(){return Ot||(fs(lh),Ot=kn.now()+Ar)}function lh(){Ot=0}function vr(){this._call=this._time=this._next=null}vr.prototype=hs.prototype={constructor:vr,restart:function(t,e,i){if(typeof t!="function")throw new TypeError("callback is not a function");i=(i==null?Gi():+i)+(e==null?0:+e),!this._next&&mn!==this&&(mn?mn._next=this:gr=this,mn=this),this._call=t,this._time=i,Si()},stop:function(){this._call&&(this._call=null,this._time=1/0,Si())}};function hs(t,e,i){var o=new vr;return o.restart(t,e,i),o}function ch(){Gi(),++Zt;for(var t=gr,e;t;)(e=Ot-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Zt}function eo(){Ot=(mr=kn.now())+Ar,Zt=gn=0;try{ch()}finally{Zt=0,fh(),Ot=0}}function uh(){var t=kn.now(),e=t-mr;e>us&&(Ar-=e,mr=t)}function fh(){for(var t,e=gr,i,o=1/0;e;)e._call?(o>e._time&&(o=e._time),t=e,e=e._next):(i=e._next,e._next=null,e=t?t._next=i:gr=i);mn=t,Si(o)}function Si(t){if(!Zt){gn&&(gn=clearTimeout(gn));var e=t-Ot;e>24?(t<1/0&&(gn=setTimeout(eo,t-kn.now()-Ar)),hn&&(hn=clearInterval(hn))):(hn||(mr=kn.now(),hn=setInterval(uh,us)),Zt=1,fs(eo))}}function to(t,e,i){var o=new vr;return e=e==null?0:+e,o.restart(r=>{o.stop(),t(r+e)},e,i),o}var hh=Ho("start","end","cancel","interrupt"),dh=[],ds=0,no=1,ki=2,sr=3,ro=4,Ai=5,lr=6;function Tr(t,e,i,o,r,n){var a=t.__transition;if(!a)t.__transition={};else if(i in a)return;ph(t,i,{name:e,index:o,group:r,on:hh,tween:dh,time:n.time,delay:n.delay,duration:n.duration,ease:n.ease,timer:null,state:ds})}function ji(t,e){var i=rt(t,e);if(i.state>ds)throw new Error("too late; already scheduled");return i}function ht(t,e){var i=rt(t,e);if(i.state>sr)throw new Error("too late; already running");return i}function rt(t,e){var i=t.__transition;if(!i||!(i=i[e]))throw new Error("transition not found");return i}function ph(t,e,i){var o=t.__transition,r;o[e]=i,i.timer=hs(n,0,i.time);function n(c){i.state=no,i.timer.restart(a,i.delay,i.time),i.delay<=c&&a(c-i.delay)}function a(c){var u,f,h,d;if(i.state!==no)return l();for(u in o)if(d=o[u],d.name===i.name){if(d.state===sr)return to(a);d.state===ro?(d.state=lr,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete o[u]):+u<e&&(d.state=lr,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete o[u])}if(to(function(){i.state===sr&&(i.state=ro,i.timer.restart(s,i.delay,i.time),s(c))}),i.state=ki,i.on.call("start",t,t.__data__,i.index,i.group),i.state===ki){for(i.state=sr,r=new Array(h=i.tween.length),u=0,f=-1;u<h;++u)(d=i.tween[u].value.call(t,t.__data__,i.index,i.group))&&(r[++f]=d);r.length=f+1}}function s(c){for(var u=c<i.duration?i.ease.call(null,c/i.duration):(i.timer.restart(l),i.state=Ai,1),f=-1,h=r.length;++f<h;)r[f].call(t,u);i.state===Ai&&(i.on.call("end",t,t.__data__,i.index,i.group),l())}function l(){i.state=lr,i.timer.stop(),delete o[e];for(var c in o)return;delete t.__transition}}function gh(t,e){var i=t.__transition,o,r,n=!0,a;if(i){e=e==null?null:e+"";for(a in i){if((o=i[a]).name!==e){n=!1;continue}r=o.state>ki&&o.state<Ai,o.state=lr,o.timer.stop(),o.on.call(r?"interrupt":"cancel",t,t.__data__,o.index,o.group),delete i[a]}n&&delete t.__transition}}function mh(t){return this.each(function(){gh(this,t)})}function vh(t,e){var i,o;return function(){var r=ht(this,t),n=r.tween;if(n!==i){o=i=n;for(var a=0,s=o.length;a<s;++a)if(o[a].name===e){o=o.slice(),o.splice(a,1);break}}r.tween=o}}function yh(t,e,i){var o,r;if(typeof i!="function")throw new Error;return function(){var n=ht(this,t),a=n.tween;if(a!==o){r=(o=a).slice();for(var s={name:e,value:i},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=s;break}l===c&&r.push(s)}n.tween=r}}function bh(t,e){var i=this._id;if(t+="",arguments.length<2){for(var o=rt(this.node(),i).tween,r=0,n=o.length,a;r<n;++r)if((a=o[r]).name===t)return a.value;return null}return this.each((e==null?vh:yh)(i,t,e))}function zi(t,e,i){var o=t._id;return t.each(function(){var r=ht(this,o);(r.value||(r.value={}))[e]=i.apply(this,arguments)}),function(r){return rt(r,o).value[e]}}function ps(t,e){var i;return(typeof e=="number"?tt:e instanceof Nt?Sn:(i=Nt(e))?(e=i,Sn):os)(t,e)}function xh(t){return function(){this.removeAttribute(t)}}function _h(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wh(t,e,i){var o,r=i+"",n;return function(){var a=this.getAttribute(t);return a===r?null:a===o?n:n=e(o=a,i)}}function Sh(t,e,i){var o,r=i+"",n;return function(){var a=this.getAttributeNS(t.space,t.local);return a===r?null:a===o?n:n=e(o=a,i)}}function kh(t,e,i){var o,r,n;return function(){var a,s=i(this),l;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),l=s+"",a===l?null:a===o&&l===r?n:(r=l,n=e(o=a,s)))}}function Ah(t,e,i){var o,r,n;return function(){var a,s=i(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),l=s+"",a===l?null:a===o&&l===r?n:(r=l,n=e(o=a,s)))}}function Th(t,e){var i=Sr(t),o=i==="transform"?sh:ps;return this.attrTween(t,typeof e=="function"?(i.local?Ah:kh)(i,o,zi(this,"attr."+t,e)):e==null?(i.local?_h:xh)(i):(i.local?Sh:wh)(i,o,e))}function Uh(t,e){return function(i){this.setAttribute(t,e.call(this,i))}}function Eh(t,e){return function(i){this.setAttributeNS(t.space,t.local,e.call(this,i))}}function Mh(t,e){var i,o;function r(){var n=e.apply(this,arguments);return n!==o&&(i=(o=n)&&Eh(t,n)),i}return r._value=e,r}function Ch(t,e){var i,o;function r(){var n=e.apply(this,arguments);return n!==o&&(i=(o=n)&&Uh(t,n)),i}return r._value=e,r}function Dh(t,e){var i="attr."+t;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;var o=Sr(t);return this.tween(i,(o.local?Mh:Ch)(o,e))}function Fh(t,e){return function(){ji(this,t).delay=+e.apply(this,arguments)}}function Rh(t,e){return e=+e,function(){ji(this,t).delay=e}}function Lh(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Fh:Rh)(e,t)):rt(this.node(),e).delay}function Nh(t,e){return function(){ht(this,t).duration=+e.apply(this,arguments)}}function Oh(t,e){return e=+e,function(){ht(this,t).duration=e}}function Ph(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Nh:Oh)(e,t)):rt(this.node(),e).duration}function Bh(t,e){if(typeof e!="function")throw new Error;return function(){ht(this,t).ease=e}}function Ih(t){var e=this._id;return arguments.length?this.each(Bh(e,t)):rt(this.node(),e).ease}function Gh(t,e){return function(){var i=e.apply(this,arguments);if(typeof i!="function")throw new Error;ht(this,t).ease=i}}function jh(t){if(typeof t!="function")throw new Error;return this.each(Gh(this._id,t))}function zh(t){typeof t!="function"&&(t=Yo(t));for(var e=this._groups,i=e.length,o=new Array(i),r=0;r<i;++r)for(var n=e[r],a=n.length,s=o[r]=[],l,c=0;c<a;++c)(l=n[c])&&t.call(l,l.__data__,c,n)&&s.push(l);return new vt(o,this._parents,this._name,this._id)}function Wh(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,i=t._groups,o=e.length,r=i.length,n=Math.min(o,r),a=new Array(o),s=0;s<n;++s)for(var l=e[s],c=i[s],u=l.length,f=a[s]=new Array(u),h,d=0;d<u;++d)(h=l[d]||c[d])&&(f[d]=h);for(;s<o;++s)a[s]=e[s];return new vt(a,this._parents,this._name,this._id)}function Hh(t){return(t+"").trim().split(/^|\s+/).every(function(e){var i=e.indexOf(".");return i>=0&&(e=e.slice(0,i)),!e||e==="start"})}function Vh(t,e,i){var o,r,n=Hh(e)?ji:ht;return function(){var a=n(this,t),s=a.on;s!==o&&(r=(o=s).copy()).on(e,i),a.on=r}}function Xh(t,e){var i=this._id;return arguments.length<2?rt(this.node(),i).on.on(t):this.each(Vh(i,t,e))}function Yh(t){return function(){var e=this.parentNode;for(var i in this.__transition)if(+i!==t)return;e&&e.removeChild(this)}}function qh(){return this.on("end.remove",Yh(this._id))}function Kh(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Oi(t));for(var o=this._groups,r=o.length,n=new Array(r),a=0;a<r;++a)for(var s=o[a],l=s.length,c=n[a]=new Array(l),u,f,h=0;h<l;++h)(u=s[h])&&(f=t.call(u,u.__data__,h,s))&&("__data__"in u&&(f.__data__=u.__data__),c[h]=f,Tr(c[h],e,i,h,c,rt(u,i)));return new vt(n,this._parents,e,i)}function Zh(t){var e=this._name,i=this._id;typeof t!="function"&&(t=Xo(t));for(var o=this._groups,r=o.length,n=[],a=[],s=0;s<r;++s)for(var l=o[s],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var h=t.call(u,u.__data__,f,l),d,p=rt(u,i),g=0,v=h.length;g<v;++g)(d=h[g])&&Tr(d,e,i,g,h,p);n.push(h),a.push(u)}return new vt(n,a,e,i)}var Jh=En.prototype.constructor;function $h(){return new Jh(this._groups,this._parents)}function Qh(t,e){var i,o,r;return function(){var n=Kt(this,t),a=(this.style.removeProperty(t),Kt(this,t));return n===a?null:n===i&&a===o?r:r=e(i=n,o=a)}}function gs(t){return function(){this.style.removeProperty(t)}}function ed(t,e,i){var o,r=i+"",n;return function(){var a=Kt(this,t);return a===r?null:a===o?n:n=e(o=a,i)}}function td(t,e,i){var o,r,n;return function(){var a=Kt(this,t),s=i(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),Kt(this,t))),a===l?null:a===o&&l===r?n:(r=l,n=e(o=a,s))}}function nd(t,e){var i,o,r,n="style."+e,a="end."+n,s;return function(){var l=ht(this,t),c=l.on,u=l.value[n]==null?s||(s=gs(e)):void 0;(c!==i||r!==u)&&(o=(i=c).copy()).on(a,r=u),l.on=o}}function rd(t,e,i){var o=(t+="")=="transform"?oh:ps;return e==null?this.styleTween(t,Qh(t,o)).on("end.style."+t,gs(t)):typeof e=="function"?this.styleTween(t,td(t,o,zi(this,"style."+t,e))).each(nd(this._id,t)):this.styleTween(t,ed(t,o,e),i).on("end.style."+t,null)}function id(t,e,i){return function(o){this.style.setProperty(t,e.call(this,o),i)}}function ad(t,e,i){var o,r;function n(){var a=e.apply(this,arguments);return a!==r&&(o=(r=a)&&id(t,a,i)),o}return n._value=e,n}function od(t,e,i){var o="style."+(t+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(e==null)return this.tween(o,null);if(typeof e!="function")throw new Error;return this.tween(o,ad(t,e,i??""))}function sd(t){return function(){this.textContent=t}}function ld(t){return function(){var e=t(this);this.textContent=e??""}}function cd(t){return this.tween("text",typeof t=="function"?ld(zi(this,"text",t)):sd(t==null?"":t+""))}function ud(t){return function(e){this.textContent=t.call(this,e)}}function fd(t){var e,i;function o(){var r=t.apply(this,arguments);return r!==i&&(e=(i=r)&&ud(r)),e}return o._value=t,o}function hd(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,fd(t))}function dd(){for(var t=this._name,e=this._id,i=ms(),o=this._groups,r=o.length,n=0;n<r;++n)for(var a=o[n],s=a.length,l,c=0;c<s;++c)if(l=a[c]){var u=rt(l,e);Tr(l,t,i,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new vt(o,this._parents,t,i)}function pd(){var t,e,i=this,o=i._id,r=i.size();return new Promise(function(n,a){var s={value:a},l={value:function(){--r===0&&n()}};i.each(function(){var c=ht(this,o),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),c.on=e}),r===0&&n()})}var gd=0;function vt(t,e,i,o){this._groups=t,this._parents=e,this._name=i,this._id=o}function ms(){return++gd}var gt=En.prototype;vt.prototype={constructor:vt,select:Kh,selectAll:Zh,selectChild:gt.selectChild,selectChildren:gt.selectChildren,filter:zh,merge:Wh,selection:$h,transition:dd,call:gt.call,nodes:gt.nodes,node:gt.node,size:gt.size,empty:gt.empty,each:gt.each,on:Xh,attr:Th,attrTween:Dh,style:rd,styleTween:od,text:cd,textTween:hd,remove:qh,tween:bh,delay:Lh,duration:Ph,ease:Ih,easeVarying:jh,end:pd,[Symbol.iterator]:gt[Symbol.iterator]};function md(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var vd={time:null,delay:0,duration:250,ease:md};function yd(t,e){for(var i;!(i=t.__transition)||!(i=i[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return i}function bd(t){var e,i;t instanceof vt?(e=t._id,t=t._name):(e=ms(),(i=vd).time=Gi(),t=t==null?null:t+"");for(var o=this._groups,r=o.length,n=0;n<r;++n)for(var a=o[n],s=a.length,l,c=0;c<s;++c)(l=a[c])&&Tr(l,t,e,c,a,i||yd(l,e));return new vt(o,this._parents,t,e)}En.prototype.interrupt=mh;En.prototype.transition=bd;const Ti=Math.PI,Ui=2*Ti,Mt=1e-6,xd=Ui-Mt;function vs(t){this._+=t[0];for(let e=1,i=t.length;e<i;++e)this._+=arguments[e]+t[e]}function _d(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return vs;const i=10**e;return function(o){this._+=o[0];for(let r=1,n=o.length;r<n;++r)this._+=Math.round(arguments[r]*i)/i+o[r]}}class wd{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?vs:_d(e)}moveTo(e,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,i){this._append`L${this._x1=+e},${this._y1=+i}`}quadraticCurveTo(e,i,o,r){this._append`Q${+e},${+i},${this._x1=+o},${this._y1=+r}`}bezierCurveTo(e,i,o,r,n,a){this._append`C${+e},${+i},${+o},${+r},${this._x1=+n},${this._y1=+a}`}arcTo(e,i,o,r,n){if(e=+e,i=+i,o=+o,r=+r,n=+n,n<0)throw new Error(`negative radius: ${n}`);let a=this._x1,s=this._y1,l=o-e,c=r-i,u=a-e,f=s-i,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=i}`;else if(h>Mt)if(!(Math.abs(f*l-c*u)>Mt)||!n)this._append`L${this._x1=e},${this._y1=i}`;else{let d=o-a,p=r-s,g=l*l+c*c,v=d*d+p*p,w=Math.sqrt(g),_=Math.sqrt(h),m=n*Math.tan((Ti-Math.acos((g+h-v)/(2*w*_)))/2),y=m/_,S=m/w;Math.abs(y-1)>Mt&&this._append`L${e+y*u},${i+y*f}`,this._append`A${n},${n},0,0,${+(f*d>u*p)},${this._x1=e+S*l},${this._y1=i+S*c}`}}arc(e,i,o,r,n,a){if(e=+e,i=+i,o=+o,a=!!a,o<0)throw new Error(`negative radius: ${o}`);let s=o*Math.cos(r),l=o*Math.sin(r),c=e+s,u=i+l,f=1^a,h=a?r-n:n-r;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Mt||Math.abs(this._y1-u)>Mt)&&this._append`L${c},${u}`,o&&(h<0&&(h=h%Ui+Ui),h>xd?this._append`A${o},${o},0,1,${f},${e-s},${i-l}A${o},${o},0,1,${f},${this._x1=c},${this._y1=u}`:h>Mt&&this._append`A${o},${o},0,${+(h>=Ti)},${f},${this._x1=e+o*Math.cos(n)},${this._y1=i+o*Math.sin(n)}`)}rect(e,i,o,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+i}h${o=+o}v${+r}h${-o}Z`}toString(){return this._}}function Sd(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function yr(t,e){if((i=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var i,o=t.slice(0,i);return[o.length>1?o[0]+o.slice(2):o,+t.slice(i+1)]}function Jt(t){return t=yr(Math.abs(t)),t?t[1]:NaN}function kd(t,e){return function(i,o){for(var r=i.length,n=[],a=0,s=t[0],l=0;r>0&&s>0&&(l+s+1>o&&(s=Math.max(1,o-l)),n.push(i.substring(r-=s,r+s)),!((l+=s+1)>o));)s=t[a=(a+1)%t.length];return n.reverse().join(e)}}function Ad(t){return function(e){return e.replace(/[0-9]/g,function(i){return t[+i]})}}var Td=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function An(t){if(!(e=Td.exec(t)))throw new Error("invalid format: "+t);var e;return new Wi({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}An.prototype=Wi.prototype;function Wi(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Wi.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Ud(t){e:for(var e=t.length,i=1,o=-1,r;i<e;++i)switch(t[i]){case".":o=r=i;break;case"0":o===0&&(o=i),r=i;break;default:if(!+t[i])break e;o>0&&(o=0);break}return o>0?t.slice(0,o)+t.slice(r+1):t}var ys;function Ed(t,e){var i=yr(t,e);if(!i)return t+"";var o=i[0],r=i[1],n=r-(ys=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,a=o.length;return n===a?o:n>a?o+new Array(n-a+1).join("0"):n>0?o.slice(0,n)+"."+o.slice(n):"0."+new Array(1-n).join("0")+yr(t,Math.max(0,e+n-1))[0]}function io(t,e){var i=yr(t,e);if(!i)return t+"";var o=i[0],r=i[1];return r<0?"0."+new Array(-r).join("0")+o:o.length>r+1?o.slice(0,r+1)+"."+o.slice(r+1):o+new Array(r-o.length+2).join("0")}const ao={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Sd,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>io(t*100,e),r:io,s:Ed,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function oo(t){return t}var so=Array.prototype.map,lo=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Md(t){var e=t.grouping===void 0||t.thousands===void 0?oo:kd(so.call(t.grouping,Number),t.thousands+""),i=t.currency===void 0?"":t.currency[0]+"",o=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",n=t.numerals===void 0?oo:Ad(so.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(f){f=An(f);var h=f.fill,d=f.align,p=f.sign,g=f.symbol,v=f.zero,w=f.width,_=f.comma,m=f.precision,y=f.trim,S=f.type;S==="n"?(_=!0,S="g"):ao[S]||(m===void 0&&(m=12),y=!0,S="g"),(v||h==="0"&&d==="=")&&(v=!0,h="0",d="=");var D=g==="$"?i:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",A=g==="$"?o:/[%p]/.test(S)?a:"",M=ao[S],O=/[defgprs%]/.test(S);m=m===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m));function F(N){var x=D,k=A,U,V,G;if(S==="c")k=M(N)+k,N="";else{N=+N;var q=N<0||1/N<0;if(N=isNaN(N)?l:M(Math.abs(N),m),y&&(N=Ud(N)),q&&+N==0&&p!=="+"&&(q=!1),x=(q?p==="("?p:s:p==="-"||p==="("?"":p)+x,k=(S==="s"?lo[8+ys/3]:"")+k+(q&&p==="("?")":""),O){for(U=-1,V=N.length;++U<V;)if(G=N.charCodeAt(U),48>G||G>57){k=(G===46?r+N.slice(U+1):N.slice(U))+k,N=N.slice(0,U);break}}}_&&!v&&(N=e(N,1/0));var K=x.length+N.length+k.length,B=K<w?new Array(w-K+1).join(h):"";switch(_&&v&&(N=e(B+N,B.length?w-k.length:1/0),B=""),d){case"<":N=x+N+k+B;break;case"=":N=x+B+N+k;break;case"^":N=B.slice(0,K=B.length>>1)+x+N+k+B.slice(K);break;default:N=B+x+N+k;break}return n(N)}return F.toString=function(){return f+""},F}function u(f,h){var d=c((f=An(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(Jt(h)/3)))*3,g=Math.pow(10,-p),v=lo[8+p/3];return function(w){return d(g*w)+v}}return{format:c,formatPrefix:u}}var $n,Hi,bs;Cd({thousands:",",grouping:[3],currency:["$",""]});function Cd(t){return $n=Md(t),Hi=$n.format,bs=$n.formatPrefix,$n}function Dd(t){return Math.max(0,-Jt(Math.abs(t)))}function Fd(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Jt(e)/3)))*3-Jt(Math.abs(t)))}function Rd(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Jt(e)-Jt(t))+1}function Ur(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ld(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const co=Symbol("implicit");function xs(){var t=new Ia,e=[],i=[],o=co;function r(n){let a=t.get(n);if(a===void 0){if(o!==co)return o;t.set(n,a=e.push(n)-1)}return i[a%i.length]}return r.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new Ia;for(const a of n)t.has(a)||t.set(a,e.push(a)-1);return r},r.range=function(n){return arguments.length?(i=Array.from(n),r):i.slice()},r.unknown=function(n){return arguments.length?(o=n,r):o},r.copy=function(){return xs(e,i).unknown(o)},Ur.apply(r,arguments),r}function $t(){var t=xs().unknown(void 0),e=t.domain,i=t.range,o=0,r=1,n,a,s=!1,l=0,c=0,u=.5;delete t.unknown;function f(){var h=e().length,d=r<o,p=d?r:o,g=d?o:r;n=(g-p)/Math.max(1,h-l+c*2),s&&(n=Math.floor(n)),p+=(g-p-n*(h-l))*u,a=n*(1-l),s&&(p=Math.round(p),a=Math.round(a));var v=Yc(h).map(function(w){return p+n*w});return i(d?v.reverse():v)}return t.domain=function(h){return arguments.length?(e(h),f()):e()},t.range=function(h){return arguments.length?([o,r]=h,o=+o,r=+r,f()):[o,r]},t.rangeRound=function(h){return[o,r]=h,o=+o,r=+r,s=!0,f()},t.bandwidth=function(){return a},t.step=function(){return n},t.round=function(h){return arguments.length?(s=!!h,f()):s},t.padding=function(h){return arguments.length?(l=Math.min(1,c=+h),f()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),f()):l},t.paddingOuter=function(h){return arguments.length?(c=+h,f()):c},t.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),f()):u},t.copy=function(){return $t(e(),[o,r]).round(s).paddingInner(l).paddingOuter(c).align(u)},Ur.apply(f(),arguments)}function Nd(t){return function(){return t}}function Od(t){return+t}var uo=[0,1];function St(t){return t}function Ei(t,e){return(e-=t=+t)?function(i){return(i-t)/e}:Nd(isNaN(e)?NaN:.5)}function Pd(t,e){var i;return t>e&&(i=t,t=e,e=i),function(o){return Math.max(t,Math.min(e,o))}}function Bd(t,e,i){var o=t[0],r=t[1],n=e[0],a=e[1];return r<o?(o=Ei(r,o),n=i(a,n)):(o=Ei(o,r),n=i(n,a)),function(s){return n(o(s))}}function Id(t,e,i){var o=Math.min(t.length,e.length)-1,r=new Array(o),n=new Array(o),a=-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<o;)r[a]=Ei(t[a],t[a+1]),n[a]=i(e[a],e[a+1]);return function(s){var l=Ic(t,s,1,o)-1;return n[l](r[l](s))}}function _s(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function ws(){var t=uo,e=uo,i=kr,o,r,n,a=St,s,l,c;function u(){var h=Math.min(t.length,e.length);return a!==St&&(a=Pd(t[0],t[h-1])),s=h>2?Id:Bd,l=c=null,f}function f(h){return h==null||isNaN(h=+h)?n:(l||(l=s(t.map(o),e,i)))(o(a(h)))}return f.invert=function(h){return a(r((c||(c=s(e,t.map(o),tt)))(h)))},f.domain=function(h){return arguments.length?(t=Array.from(h,Od),u()):t.slice()},f.range=function(h){return arguments.length?(e=Array.from(h),u()):e.slice()},f.rangeRound=function(h){return e=Array.from(h),i=ss,u()},f.clamp=function(h){return arguments.length?(a=h?!0:St,u()):a!==St},f.interpolate=function(h){return arguments.length?(i=h,u()):i},f.unknown=function(h){return arguments.length?(n=h,f):n},function(h,d){return o=h,r=d,u()}}function Gd(){return ws()(St,St)}function jd(t,e,i,o){var r=Xc(t,e,i),n;switch(o=An(o??",f"),o.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return o.precision==null&&!isNaN(n=Fd(r,a))&&(o.precision=n),bs(o,a)}case"":case"e":case"g":case"p":case"r":{o.precision==null&&!isNaN(n=Rd(r,Math.max(Math.abs(t),Math.abs(e))))&&(o.precision=n-(o.type==="e"));break}case"f":case"%":{o.precision==null&&!isNaN(n=Dd(r))&&(o.precision=n-(o.type==="%")*2);break}}return Hi(o)}function Ss(t){var e=t.domain;return t.ticks=function(i){var o=e();return mi(o[0],o[o.length-1],i??10)},t.tickFormat=function(i,o){var r=e();return jd(r[0],r[r.length-1],i??10,o)},t.nice=function(i){i==null&&(i=10);var o=e(),r=0,n=o.length-1,a=o[r],s=o[n],l,c,u=10;for(s<a&&(c=a,a=s,s=c,c=r,r=n,n=c);u-- >0;){if(c=vi(a,s,i),c===l)return o[r]=a,o[n]=s,e(o);if(c>0)a=Math.floor(a/c)*c,s=Math.ceil(s/c)*c;else if(c<0)a=Math.ceil(a*c)/c,s=Math.floor(s*c)/c;else break;l=c}return t},t}function Pt(){var t=Gd();return t.copy=function(){return _s(t,Pt())},Ur.apply(t,arguments),Ss(t)}function zd(t,e){t=t.slice();var i=0,o=t.length-1,r=t[i],n=t[o],a;return n<r&&(a=i,i=o,o=a,a=r,r=n,n=a),t[i]=e.floor(r),t[o]=e.ceil(n),t}function fo(t){return Math.log(t)}function ho(t){return Math.exp(t)}function Wd(t){return-Math.log(-t)}function Hd(t){return-Math.exp(-t)}function Vd(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Xd(t){return t===10?Vd:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Yd(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function po(t){return(e,i)=>-t(-e,i)}function qd(t){const e=t(fo,ho),i=e.domain;let o=10,r,n;function a(){return r=Yd(o),n=Xd(o),i()[0]<0?(r=po(r),n=po(n),t(Wd,Hd)):t(fo,ho),e}return e.base=function(s){return arguments.length?(o=+s,a()):o},e.domain=function(s){return arguments.length?(i(s),a()):i()},e.ticks=s=>{const l=i();let c=l[0],u=l[l.length-1];const f=u<c;f&&([c,u]=[u,c]);let h=r(c),d=r(u),p,g;const v=s==null?10:+s;let w=[];if(!(o%1)&&d-h<v){if(h=Math.floor(h),d=Math.ceil(d),c>0){for(;h<=d;++h)for(p=1;p<o;++p)if(g=h<0?p/n(-h):p*n(h),!(g<c)){if(g>u)break;w.push(g)}}else for(;h<=d;++h)for(p=o-1;p>=1;--p)if(g=h>0?p/n(-h):p*n(h),!(g<c)){if(g>u)break;w.push(g)}w.length*2<v&&(w=mi(c,u,v))}else w=mi(h,d,Math.min(d-h,v)).map(n);return f?w.reverse():w},e.tickFormat=(s,l)=>{if(s==null&&(s=10),l==null&&(l=o===10?"s":","),typeof l!="function"&&(!(o%1)&&(l=An(l)).precision==null&&(l.trim=!0),l=Hi(l)),s===1/0)return l;const c=Math.max(1,o*s/e.ticks().length);return u=>{let f=u/n(Math.round(r(u)));return f*o<o-.5&&(f*=o),f<=c?l(u):""}},e.nice=()=>i(zd(i(),{floor:s=>n(Math.floor(r(s))),ceil:s=>n(Math.ceil(r(s)))})),e}function ks(){const t=qd(ws()).domain([1,10]);return t.copy=()=>_s(t,ks()).base(t.base()),Ur.apply(t,arguments),t}function Kd(){var t=0,e=1,i,o,r,n,a=St,s=!1,l;function c(f){return f==null||isNaN(f=+f)?l:a(r===0?.5:(f=(n(f)-i)*r,s?Math.max(0,Math.min(1,f)):f))}c.domain=function(f){return arguments.length?([t,e]=f,i=n(t=+t),o=n(e=+e),r=i===o?0:1/(o-i),c):[t,e]},c.clamp=function(f){return arguments.length?(s=!!f,c):s},c.interpolator=function(f){return arguments.length?(a=f,c):a};function u(f){return function(h){var d,p;return arguments.length?([d,p]=h,a=f(d,p),c):[a(0),a(1)]}}return c.range=u(kr),c.rangeRound=u(ss),c.unknown=function(f){return arguments.length?(l=f,c):l},function(f){return n=f,i=f(t),o=f(e),r=i===o?0:1/(o-i),c}}function Zd(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function As(){var t=Ss(Kd()(St));return t.copy=function(){return Zd(t,As())},Ld.apply(t,arguments)}function we(t){return function(){return t}}const go=Math.abs,Ge=Math.atan2,Et=Math.cos,Jd=Math.max,si=Math.min,st=Math.sin,Xt=Math.sqrt,Ye=1e-12,Tn=Math.PI,br=Tn/2,cr=2*Tn;function $d(t){return t>1?0:t<-1?Tn:Math.acos(t)}function mo(t){return t>=1?br:t<=-1?-br:Math.asin(t)}function Vi(t){let e=3;return t.digits=function(i){if(!arguments.length)return e;if(i==null)e=null;else{const o=Math.floor(i);if(!(o>=0))throw new RangeError(`invalid digits: ${i}`);e=o}return t},()=>new wd(e)}function Qd(t){return t.innerRadius}function ep(t){return t.outerRadius}function tp(t){return t.startAngle}function np(t){return t.endAngle}function rp(t){return t&&t.padAngle}function ip(t,e,i,o,r,n,a,s){var l=i-t,c=o-e,u=a-r,f=s-n,h=f*l-u*c;if(!(h*h<Ye))return h=(u*(e-n)-f*(t-r))/h,[t+h*l,e+h*c]}function Qn(t,e,i,o,r,n,a){var s=t-i,l=e-o,c=(a?n:-n)/Xt(s*s+l*l),u=c*l,f=-c*s,h=t+u,d=e+f,p=i+u,g=o+f,v=(h+p)/2,w=(d+g)/2,_=p-h,m=g-d,y=_*_+m*m,S=r-n,D=h*g-p*d,A=(m<0?-1:1)*Xt(Jd(0,S*S*y-D*D)),M=(D*m-_*A)/y,O=(-D*_-m*A)/y,F=(D*m+_*A)/y,N=(-D*_+m*A)/y,x=M-v,k=O-w,U=F-v,V=N-w;return x*x+k*k>U*U+V*V&&(M=F,O=N),{cx:M,cy:O,x01:-u,y01:-f,x11:M*(r/S-1),y11:O*(r/S-1)}}function vo(){var t=Qd,e=ep,i=we(0),o=null,r=tp,n=np,a=rp,s=null,l=Vi(c);function c(){var u,f,h=+t.apply(this,arguments),d=+e.apply(this,arguments),p=r.apply(this,arguments)-br,g=n.apply(this,arguments)-br,v=go(g-p),w=g>p;if(s||(s=u=l()),d<h&&(f=d,d=h,h=f),!(d>Ye))s.moveTo(0,0);else if(v>cr-Ye)s.moveTo(d*Et(p),d*st(p)),s.arc(0,0,d,p,g,!w),h>Ye&&(s.moveTo(h*Et(g),h*st(g)),s.arc(0,0,h,g,p,w));else{var _=p,m=g,y=p,S=g,D=v,A=v,M=a.apply(this,arguments)/2,O=M>Ye&&(o?+o.apply(this,arguments):Xt(h*h+d*d)),F=si(go(d-h)/2,+i.apply(this,arguments)),N=F,x=F,k,U;if(O>Ye){var V=mo(O/h*st(M)),G=mo(O/d*st(M));(D-=V*2)>Ye?(V*=w?1:-1,y+=V,S-=V):(D=0,y=S=(p+g)/2),(A-=G*2)>Ye?(G*=w?1:-1,_+=G,m-=G):(A=0,_=m=(p+g)/2)}var q=d*Et(_),K=d*st(_),B=h*Et(S),I=h*st(S);if(F>Ye){var b=d*Et(m),E=d*st(m),R=h*Et(y),L=h*st(y),C;if(v<Tn)if(C=ip(q,K,R,L,b,E,B,I)){var W=q-C[0],P=K-C[1],j=b-C[0],Z=E-C[1],ee=1/st($d((W*j+P*Z)/(Xt(W*W+P*P)*Xt(j*j+Z*Z)))/2),X=Xt(C[0]*C[0]+C[1]*C[1]);N=si(F,(h-X)/(ee-1)),x=si(F,(d-X)/(ee+1))}else N=x=0}A>Ye?x>Ye?(k=Qn(R,L,q,K,d,x,w),U=Qn(b,E,B,I,d,x,w),s.moveTo(k.cx+k.x01,k.cy+k.y01),x<F?s.arc(k.cx,k.cy,x,Ge(k.y01,k.x01),Ge(U.y01,U.x01),!w):(s.arc(k.cx,k.cy,x,Ge(k.y01,k.x01),Ge(k.y11,k.x11),!w),s.arc(0,0,d,Ge(k.cy+k.y11,k.cx+k.x11),Ge(U.cy+U.y11,U.cx+U.x11),!w),s.arc(U.cx,U.cy,x,Ge(U.y11,U.x11),Ge(U.y01,U.x01),!w))):(s.moveTo(q,K),s.arc(0,0,d,_,m,!w)):s.moveTo(q,K),!(h>Ye)||!(D>Ye)?s.lineTo(B,I):N>Ye?(k=Qn(B,I,b,E,h,-N,w),U=Qn(q,K,R,L,h,-N,w),s.lineTo(k.cx+k.x01,k.cy+k.y01),N<F?s.arc(k.cx,k.cy,N,Ge(k.y01,k.x01),Ge(U.y01,U.x01),!w):(s.arc(k.cx,k.cy,N,Ge(k.y01,k.x01),Ge(k.y11,k.x11),!w),s.arc(0,0,h,Ge(k.cy+k.y11,k.cx+k.x11),Ge(U.cy+U.y11,U.cx+U.x11),w),s.arc(U.cx,U.cy,N,Ge(U.y11,U.x11),Ge(U.y01,U.x01),!w))):s.arc(0,0,h,S,y,w)}if(s.closePath(),u)return s=null,u+""||null}return c.centroid=function(){var u=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +n.apply(this,arguments))/2-Tn/2;return[Et(f)*u,st(f)*u]},c.innerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:we(+u),c):t},c.outerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:we(+u),c):e},c.cornerRadius=function(u){return arguments.length?(i=typeof u=="function"?u:we(+u),c):i},c.padRadius=function(u){return arguments.length?(o=u==null?null:typeof u=="function"?u:we(+u),c):o},c.startAngle=function(u){return arguments.length?(r=typeof u=="function"?u:we(+u),c):r},c.endAngle=function(u){return arguments.length?(n=typeof u=="function"?u:we(+u),c):n},c.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:we(+u),c):a},c.context=function(u){return arguments.length?(s=u??null,c):s},c}function Xi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ts(t){this._context=t}Ts.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function Us(t){return new Ts(t)}function Es(t){return t[0]}function Ms(t){return t[1]}function Mi(t,e){var i=we(!0),o=null,r=Us,n=null,a=Vi(s);t=typeof t=="function"?t:t===void 0?Es:we(t),e=typeof e=="function"?e:e===void 0?Ms:we(e);function s(l){var c,u=(l=Xi(l)).length,f,h=!1,d;for(o==null&&(n=r(d=a())),c=0;c<=u;++c)!(c<u&&i(f=l[c],c,l))===h&&((h=!h)?n.lineStart():n.lineEnd()),h&&n.point(+t(f,c,l),+e(f,c,l));if(d)return n=null,d+""||null}return s.x=function(l){return arguments.length?(t=typeof l=="function"?l:we(+l),s):t},s.y=function(l){return arguments.length?(e=typeof l=="function"?l:we(+l),s):e},s.defined=function(l){return arguments.length?(i=typeof l=="function"?l:we(!!l),s):i},s.curve=function(l){return arguments.length?(r=l,o!=null&&(n=r(o)),s):r},s.context=function(l){return arguments.length?(l==null?o=n=null:n=r(o=l),s):o},s}function yo(t,e,i){var o=null,r=we(!0),n=null,a=Us,s=null,l=Vi(c);t=typeof t=="function"?t:t===void 0?Es:we(+t),e=typeof e=="function"?e:we(e===void 0?0:+e),i=typeof i=="function"?i:i===void 0?Ms:we(+i);function c(f){var h,d,p,g=(f=Xi(f)).length,v,w=!1,_,m=new Array(g),y=new Array(g);for(n==null&&(s=a(_=l())),h=0;h<=g;++h){if(!(h<g&&r(v=f[h],h,f))===w)if(w=!w)d=h,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),p=h-1;p>=d;--p)s.point(m[p],y[p]);s.lineEnd(),s.areaEnd()}w&&(m[h]=+t(v,h,f),y[h]=+e(v,h,f),s.point(o?+o(v,h,f):m[h],i?+i(v,h,f):y[h]))}if(_)return s=null,_+""||null}function u(){return Mi().defined(r).curve(a).context(n)}return c.x=function(f){return arguments.length?(t=typeof f=="function"?f:we(+f),o=null,c):t},c.x0=function(f){return arguments.length?(t=typeof f=="function"?f:we(+f),c):t},c.x1=function(f){return arguments.length?(o=f==null?null:typeof f=="function"?f:we(+f),c):o},c.y=function(f){return arguments.length?(e=typeof f=="function"?f:we(+f),i=null,c):e},c.y0=function(f){return arguments.length?(e=typeof f=="function"?f:we(+f),c):e},c.y1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:we(+f),c):i},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(i)},c.lineX1=function(){return u().x(o).y(e)},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:we(!!f),c):r},c.curve=function(f){return arguments.length?(a=f,n!=null&&(s=a(n)),c):a},c.context=function(f){return arguments.length?(f==null?n=s=null:s=a(n=f),c):n},c}function ap(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function op(t){return t}function sp(){var t=op,e=ap,i=null,o=we(0),r=we(cr),n=we(0);function a(s){var l,c=(s=Xi(s)).length,u,f,h=0,d=new Array(c),p=new Array(c),g=+o.apply(this,arguments),v=Math.min(cr,Math.max(-cr,r.apply(this,arguments)-g)),w,_=Math.min(Math.abs(v)/c,n.apply(this,arguments)),m=_*(v<0?-1:1),y;for(l=0;l<c;++l)(y=p[d[l]=l]=+t(s[l],l,s))>0&&(h+=y);for(e!=null?d.sort(function(S,D){return e(p[S],p[D])}):i!=null&&d.sort(function(S,D){return i(s[S],s[D])}),l=0,f=h?(v-c*m)/h:0;l<c;++l,g=w)u=d[l],y=p[u],w=g+(y>0?y*f:0)+m,p[u]={data:s[u],index:l,value:y,startAngle:g,endAngle:w,padAngle:_};return p}return a.value=function(s){return arguments.length?(t=typeof s=="function"?s:we(+s),a):t},a.sortValues=function(s){return arguments.length?(e=s,i=null,a):e},a.sort=function(s){return arguments.length?(i=s,e=null,a):i},a.startAngle=function(s){return arguments.length?(o=typeof s=="function"?s:we(+s),a):o},a.endAngle=function(s){return arguments.length?(r=typeof s=="function"?s:we(+s),a):r},a.padAngle=function(s){return arguments.length?(n=typeof s=="function"?s:we(+s),a):n},a}function bo(t){return t<0?-1:1}function xo(t,e,i){var o=t._x1-t._x0,r=e-t._x1,n=(t._y1-t._y0)/(o||r<0&&-0),a=(i-t._y1)/(r||o<0&&-0),s=(n*r+a*o)/(o+r);return(bo(n)+bo(a))*Math.min(Math.abs(n),Math.abs(a),.5*Math.abs(s))||0}function _o(t,e){var i=t._x1-t._x0;return i?(3*(t._y1-t._y0)/i-e)/2:e}function li(t,e,i){var o=t._x0,r=t._y0,n=t._x1,a=t._y1,s=(n-o)/3;t._context.bezierCurveTo(o+s,r+s*e,n-s,a-s*i,n,a)}function xr(t){this._context=t}xr.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:li(this,this._t0,_o(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var i=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,li(this,_o(this,i=xo(this,t,e)),i);break;default:li(this,this._t0,i=xo(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=i}}};Object.create(xr.prototype).point=function(t,e){xr.prototype.point.call(this,e,t)};function er(t){return new xr(t)}function vn(t,e,i){this.k=t,this.x=e,this.y=i}vn.prototype={constructor:vn,scale:function(t){return t===1?this:new vn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new vn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};vn.prototype;function Bt({children:t,aspectRatio:e=16/9,minHeight:i=200,className:o=""}){const r=ie.useRef(null),[n,a]=ie.useState({width:0,height:0});return ie.useEffect(()=>{const s=r.current;if(!s)return;const l=()=>{const u=s.clientWidth,f=Math.max(u/e,i);a({width:u,height:f})};l();const c=new ResizeObserver(l);return c.observe(s),()=>{c.disconnect()}},[e,i]),T.jsx("div",{ref:r,className:`d3-chart-container ${o}`,children:n.width>0&&t(n)})}const Er={top:20,right:20,bottom:40,left:50},ce={primary:"#00ccff",secondary:"#00ff88",tertiary:"#ffd700",muted:"#666666",axis:"#888888",grid:"#333333",text:"#ffffff",goldilocks:"rgba(0, 255, 136, 0.2)"};function lp({data:t}){const{t:e}=Je(),i=t.filter(o=>o.min>=60).reduce((o,r)=>o+r.pct,0);return T.jsxs("div",{className:"insight-card",children:[T.jsx("h3",{className:"card-title",children:e("pages.habitability.insights.scoreDistribution.title")}),T.jsx("p",{className:"card-description",children:e("pages.habitability.insights.scoreDistribution.description",{pct:i.toFixed(1)})}),T.jsx(Bt,{aspectRatio:2,children:o=>T.jsx(cp,{data:t,...o})})]})}function cp({data:t,width:e,height:i}){const o=ie.useRef(null),{t:r}=Je();return ie.useEffect(()=>{if(!o.current||e===0)return;const n=ut(o.current);n.selectAll("*").remove();const a=Er,s=e-a.left-a.right,l=i-a.top-a.bottom,c=n.append("g").attr("transform",`translate(${a.left},${a.top})`),u=$t().domain(t.map(h=>h.range)).range([0,s]).padding(.2),f=Pt().domain([0,xn(t,h=>h.pct)||100]).nice().range([l,0]);c.append("g").attr("class","grid").call(mt(f).tickSize(-s).tickFormat(()=>"")).selectAll("line").attr("stroke",ce.grid).attr("stroke-opacity",.5),c.selectAll(".grid .domain").remove(),c.selectAll(".bar").data(t).join("rect").attr("class","bar").attr("x",h=>u(h.range)||0).attr("y",h=>f(h.pct)).attr("width",u.bandwidth()).attr("height",h=>l-f(h.pct)).attr("fill",h=>h.min>=60?ce.secondary:ce.primary).attr("rx",2),c.selectAll(".bar-label").data(t).join("text").attr("class","bar-label").attr("x",h=>(u(h.range)||0)+u.bandwidth()/2).attr("y",h=>f(h.pct)-5).attr("text-anchor","middle").attr("fill",ce.text).attr("font-size","11px").text(h=>`${h.pct.toFixed(1)}%`),c.append("g").attr("transform",`translate(0,${l})`).call(Lt(u)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.selectAll(".domain, .tick line").attr("stroke",ce.axis),c.append("g").call(mt(f).ticks(5).tickFormat(h=>`${h}%`)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.append("text").attr("transform","rotate(-90)").attr("y",-40).attr("x",-l/2).attr("text-anchor","middle").attr("fill",ce.text).attr("font-size","12px").text(r("pages.habitability.charts.axes.percentOfPlanets"))},[t,e,i,r]),T.jsx("svg",{ref:o,width:e,height:i})}function up({data:t}){const{t:e}=Je();return T.jsxs("div",{className:"insight-card",children:[T.jsx("h3",{className:"card-title",children:e("pages.habitability.insights.temperature.title")}),T.jsx("p",{className:"card-description",children:e("pages.habitability.insights.temperature.description")}),T.jsx(Bt,{aspectRatio:2,children:i=>T.jsx(fp,{data:t,...i})})]})}function fp({data:t,width:e,height:i}){const o=ie.useRef(null),{t:r}=Je();return ie.useEffect(()=>{if(!o.current||e===0)return;const n=ut(o.current);n.selectAll("*").remove();const a=Er,s=e-a.left-a.right,l=i-a.top-a.bottom,c=n.append("g").attr("transform",`translate(${a.left},${a.top})`),u=t.length>2e3?t.filter((g,v)=>v%Math.ceil(t.length/2e3)===0):t,f=ks().domain([50,xn(t,g=>g.temp)||3e3]).range([0,s]),h=Pt().domain([0,100]).range([l,0]),d=200,p=320;c.append("rect").attr("x",f(d)).attr("y",0).attr("width",f(p)-f(d)).attr("height",l).attr("fill",ce.goldilocks),c.append("text").attr("x",f(Math.sqrt(d*p))).attr("y",15).attr("text-anchor","middle").attr("fill",ce.secondary).attr("font-size","11px").attr("font-weight","bold").text(r("pages.habitability.charts.goldilocksZone")),c.append("g").attr("class","grid").call(mt(h).tickSize(-s).tickFormat(()=>"")).selectAll("line").attr("stroke",ce.grid).attr("stroke-opacity",.5),c.selectAll(".grid .domain").remove(),c.selectAll(".point").data(u).join("circle").attr("class","point").attr("cx",g=>f(g.temp)).attr("cy",g=>h(g.score)).attr("r",g=>g.isHabitable?3:1.5).attr("fill",g=>g.isHabitable&&g.isEarthLike?ce.secondary:g.isHabitable?ce.primary:ce.muted).attr("opacity",g=>g.isHabitable?.8:.3),c.append("g").attr("transform",`translate(0,${l})`).call(Lt(f).tickValues([100,200,500,1e3,2e3]).tickFormat(g=>`${g}K`)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.selectAll(".domain, .tick line").attr("stroke",ce.axis),c.append("g").call(mt(h).ticks(5)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.append("text").attr("x",s/2).attr("y",l+35).attr("text-anchor","middle").attr("fill",ce.text).attr("font-size","12px").text(r("pages.habitability.charts.axes.temperature")),c.append("text").attr("transform","rotate(-90)").attr("y",-40).attr("x",-l/2).attr("text-anchor","middle").attr("fill",ce.text).attr("font-size","12px").text(r("pages.habitability.charts.axes.habitabilityScore"))},[t,e,i,r]),T.jsx("svg",{ref:o,width:e,height:i})}const hp={O:"#9bb0ff",B:"#aabfff",A:"#cad7ff",F:"#f8f7ff",G:"#fff4ea",K:"#ffd2a1",M:"#ffcc6f",L:"#ff8800",T:"#ff6666",Y:"#cc4444",Unknown:"#888888"};function dp({data:t}){const{t:e}=Je(),i=t.filter(o=>["F","G","K","M"].includes(o.starClass)&&o.count>=10);return T.jsxs("div",{className:"insight-card",children:[T.jsx("h3",{className:"card-title",children:e("pages.habitability.insights.starType.title")}),T.jsx("p",{className:"card-description",children:e("pages.habitability.insights.starType.description")}),T.jsx(Bt,{aspectRatio:2,children:o=>T.jsx(pp,{data:i,...o})})]})}function pp({data:t,width:e,height:i}){const o=ie.useRef(null),{t:r}=Je();return ie.useEffect(()=>{if(!o.current||e===0)return;const n=ut(o.current);n.selectAll("*").remove();const a={...Er,left:60},s=e-a.left-a.right,l=i-a.top-a.bottom,c=n.append("g").attr("transform",`translate(${a.left},${a.top})`),u=[...t].sort((d,p)=>p.avgScore-d.avgScore),f=$t().domain(u.map(d=>d.starClass)).range([0,l]).padding(.3),h=Pt().domain([0,xn(u,d=>d.avgScore)||50]).nice().range([0,s]);c.append("g").attr("class","grid").call(Lt(h).tickSize(l).tickFormat(()=>"")).selectAll("line").attr("stroke",ce.grid).attr("stroke-opacity",.5),c.selectAll(".grid .domain").remove(),c.selectAll(".bar").data(u).join("rect").attr("class","bar").attr("y",d=>f(d.starClass)||0).attr("x",0).attr("height",f.bandwidth()).attr("width",d=>h(d.avgScore)).attr("fill",d=>hp[d.starClass]||ce.muted).attr("rx",2),c.selectAll(".bar-label").data(u).join("text").attr("class","bar-label").attr("y",d=>(f(d.starClass)||0)+f.bandwidth()/2).attr("x",d=>h(d.avgScore)+5).attr("dy","0.35em").attr("fill",ce.text).attr("font-size","11px").text(d=>`${d.avgScore.toFixed(1)} (${d.count.toLocaleString()})`),c.append("g").call(mt(f)).selectAll("text").attr("fill",ce.axis).attr("font-size","12px").attr("font-weight","bold"),c.selectAll(".domain, .tick line").attr("stroke",ce.axis),c.append("g").attr("transform",`translate(0,${l})`).call(Lt(h).ticks(5)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.append("text").attr("x",s/2).attr("y",l+35).attr("text-anchor","middle").attr("fill",ce.text).attr("font-size","12px").text(r("pages.habitability.charts.axes.avgHabitabilityScore"))},[t,e,i,r]),T.jsx("svg",{ref:o,width:e,height:i})}const gp=2009,mp=2018;function vp({data:t}){const{t:e}=Je();return T.jsxs("div",{className:"insight-card",children:[T.jsx("h3",{className:"card-title",children:e("pages.habitability.insights.discovery.title")}),T.jsx("p",{className:"card-description",children:e("pages.habitability.insights.discovery.description")}),T.jsx(Bt,{aspectRatio:2,children:i=>T.jsx(yp,{data:t,...i})})]})}function yp({data:t,width:e,height:i}){const o=ie.useRef(null),{t:r}=Je();return ie.useEffect(()=>{if(!o.current||e===0||t.length===0)return;const n=ut(o.current);n.selectAll("*").remove();const a=Er,s=e-a.left-a.right,l=i-a.top-a.bottom,c=n.append("g").attr("transform",`translate(${a.left},${a.top})`),u=t.filter(m=>m.year>=1995),f=Pt().domain([ja(u,m=>m.year)||1995,xn(u,m=>m.year)||2024]).range([0,s]),h=Pt().domain([0,xn(u,m=>m.cumulative)||1e3]).nice().range([l,0]),d=yo().x(m=>f(m.year)).y0(l).y1(m=>h(m.cumulative)).curve(er),p=yo().x(m=>f(m.year)).y0(l).y1(m=>h(m.cumulativeHabitable)).curve(er);c.append("g").attr("class","grid").call(mt(h).tickSize(-s).tickFormat(()=>"")).selectAll("line").attr("stroke",ce.grid).attr("stroke-opacity",.5),c.selectAll(".grid .domain").remove(),c.append("path").datum(u).attr("fill",ce.primary).attr("fill-opacity",.3).attr("d",d),c.append("path").datum(u).attr("fill",ce.secondary).attr("fill-opacity",.5).attr("d",p);const g=Mi().x(m=>f(m.year)).y(m=>h(m.cumulative)).curve(er);c.append("path").datum(u).attr("fill","none").attr("stroke",ce.primary).attr("stroke-width",2).attr("d",g);const v=Mi().x(m=>f(m.year)).y(m=>h(m.cumulativeHabitable)).curve(er);c.append("path").datum(u).attr("fill","none").attr("stroke",ce.secondary).attr("stroke-width",2).attr("d",v),[{year:gp,label:r("pages.habitability.insights.discovery.kepler")},{year:mp,label:r("pages.habitability.insights.discovery.tess")}].forEach(m=>{m.year>=(ja(u,y=>y.year)||1995)&&(c.append("line").attr("x1",f(m.year)).attr("x2",f(m.year)).attr("y1",0).attr("y2",l).attr("stroke",ce.tertiary).attr("stroke-width",1).attr("stroke-dasharray","4,4").attr("opacity",.7),c.append("text").attr("x",f(m.year)).attr("y",-5).attr("text-anchor","middle").attr("fill",ce.tertiary).attr("font-size","10px").text(m.label))}),c.append("g").attr("transform",`translate(0,${l})`).call(Lt(f).tickFormat(m=>String(m)).ticks(6)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px"),c.selectAll(".domain, .tick line").attr("stroke",ce.axis),c.append("g").call(mt(h).ticks(5)).selectAll("text").attr("fill",ce.axis).attr("font-size","11px");const _=c.append("g").attr("transform",`translate(${s-120}, 10)`);_.append("rect").attr("x",0).attr("y",0).attr("width",15).attr("height",3).attr("fill",ce.primary),_.append("text").attr("x",20).attr("y",4).attr("fill",ce.text).attr("font-size","10px").text(r("pages.habitability.charts.legend.allDiscoveries")),_.append("rect").attr("x",0).attr("y",15).attr("width",15).attr("height",3).attr("fill",ce.secondary),_.append("text").attr("x",20).attr("y",19).attr("fill",ce.text).attr("font-size","10px").text(r("pages.habitability.charts.legend.habitableZone"))},[t,e,i,r]),T.jsx("svg",{ref:o,width:e,height:i})}function wo({data:t,xLabels:e,yLabels:i,maxValue:o,title:r,xAxisLabel:n,yAxisLabel:a,colorScheme:s="blue",showValues:l=!0}){return T.jsxs("div",{className:"chart-wrapper",children:[T.jsx("h3",{className:"chart-title",children:r}),T.jsx(Bt,{aspectRatio:1.2,minHeight:300,children:({width:c,height:u})=>T.jsx(bp,{data:t,xLabels:e,yLabels:i,maxValue:o,width:c,height:u,xAxisLabel:n,yAxisLabel:a,colorScheme:s,showValues:l})})]})}function bp({data:t,xLabels:e,yLabels:i,maxValue:o,width:r,height:n,xAxisLabel:a,yAxisLabel:s,colorScheme:l,showValues:c}){const u=ie.useRef(null);return ie.useEffect(()=>{if(!u.current||t.length===0)return;const f=ut(u.current);f.selectAll("*").remove();const h={top:20,right:20,bottom:60,left:80},d=r-h.left-h.right,p=n-h.top-h.bottom,g=f.append("g").attr("transform",`translate(${h.left},${h.top})`),v=$t().domain(e).range([0,d]).padding(.05),w=$t().domain(i).range([0,p]).padding(.05),_=l==="green"?["#0a1a0a","#00ff88"]:l==="orange"?["#1a0a0a","#ff8800"]:["#0a0a1a","#00ccff"],m=As().domain([0,o]).interpolator(Sn(_[0],_[1]));g.selectAll("rect").data(t).join("rect").attr("x",y=>v(y.x)||0).attr("y",y=>w(y.y)||0).attr("width",v.bandwidth()).attr("height",w.bandwidth()).attr("fill",y=>y.value>0?m(y.value):"#111").attr("stroke","#222").attr("stroke-width",1).attr("rx",2),c&&g.selectAll("text.cell-value").data(t.filter(y=>y.value>0)).join("text").attr("class","cell-value").attr("x",y=>(v(y.x)||0)+v.bandwidth()/2).attr("y",y=>(w(y.y)||0)+w.bandwidth()/2).attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill",y=>y.value>o*.6?"#000":"#fff").attr("font-size",Math.min(v.bandwidth(),w.bandwidth())*.35).text(y=>y.value),g.append("g").attr("transform",`translate(0,${p})`).call(Lt(v)).selectAll("text").attr("fill",ce.text).attr("font-size",11),g.selectAll(".domain, .tick line").attr("stroke",ce.axis),g.append("g").call(mt(w)).selectAll("text").attr("fill",ce.text).attr("font-size",10),a&&g.append("text").attr("x",d/2).attr("y",p+45).attr("text-anchor","middle").attr("fill",ce.axis).attr("font-size",12).text(a),s&&g.append("text").attr("transform","rotate(-90)").attr("x",-p/2).attr("y",-60).attr("text-anchor","middle").attr("fill",ce.axis).attr("font-size",12).text(s)},[t,e,i,o,r,n,l,c,a,s]),T.jsx("svg",{ref:u,width:r,height:n})}const Cs={Habitability:"#00ff88","Planet Type":"#ff8800",Orbital:"#00ccff",System:"#aa88ff",Star:"#ffd700"};function xp({data:t,title:e,maxItems:i=20}){const o=t.slice(0,i);return T.jsxs("div",{className:"chart-wrapper",children:[T.jsx("h3",{className:"chart-title",children:e}),T.jsx(Bt,{aspectRatio:.8,minHeight:400,children:({width:r,height:n})=>T.jsx(_p,{data:o,width:r,height:n})}),T.jsx("div",{className:"chart-legend horizontal",children:Object.entries(Cs).map(([r,n])=>T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot",style:{background:n}}),T.jsx("span",{children:r})]},r))})]})}function _p({data:t,width:e,height:i}){const o=ie.useRef(null);return ie.useEffect(()=>{if(!o.current||t.length===0)return;const r=ut(o.current);r.selectAll("*").remove();const n={top:10,right:60,bottom:30,left:140},a=e-n.left-n.right,s=i-n.top-n.bottom,l=r.append("g").attr("transform",`translate(${n.left},${n.top})`),c=$t().domain(t.map(f=>f.label)).range([0,s]).padding(.2),u=Pt().domain([0,Math.max(...t.map(f=>f.pct))*1.1]).range([0,a]);l.selectAll("line.grid").data(u.ticks(5)).join("line").attr("class","grid").attr("x1",f=>u(f)).attr("x2",f=>u(f)).attr("y1",0).attr("y2",s).attr("stroke",ce.grid).attr("stroke-dasharray","2,2"),l.selectAll("rect").data(t).join("rect").attr("x",0).attr("y",f=>c(f.label)||0).attr("width",f=>u(f.pct)).attr("height",c.bandwidth()).attr("fill",f=>Cs[f.category]||ce.muted).attr("rx",2).attr("opacity",.85),l.selectAll("text.pct").data(t).join("text").attr("class","pct").attr("x",f=>u(f.pct)+5).attr("y",f=>(c(f.label)||0)+c.bandwidth()/2).attr("dominant-baseline","middle").attr("fill",ce.text).attr("font-size",11).text(f=>`${f.pct.toFixed(1)}%`),l.append("g").call(mt(c).tickSize(0)).selectAll("text").attr("fill",ce.text).attr("font-size",11),l.selectAll(".domain").remove(),l.append("g").attr("transform",`translate(0,${s})`).call(Lt(u).ticks(5).tickFormat(f=>`${f}%`)).selectAll("text").attr("fill",ce.text).attr("font-size",10),l.selectAll(".domain, .tick line").attr("stroke",ce.axis)},[t,e,i]),T.jsx("svg",{ref:o,width:e,height:i})}function wp({data:t,title:e,totalPlanets:i}){return T.jsxs("div",{className:"chart-wrapper",children:[T.jsx("h3",{className:"chart-title",children:e}),T.jsx(Bt,{aspectRatio:1.3,minHeight:300,children:({width:o,height:r})=>T.jsx(Sp,{data:t,width:o,height:r,totalPlanets:i})}),T.jsx("div",{className:"chart-legend horizontal",children:t.map(o=>T.jsxs("div",{className:"legend-item",children:[T.jsx("span",{className:"legend-dot",style:{background:o.color}}),T.jsxs("span",{children:[o.category," (",o.count.toLocaleString(),")"]})]},o.category))})]})}function Sp({data:t,width:e,height:i,totalPlanets:o}){const r=ie.useRef(null),{t:n}=Je();return ie.useEffect(()=>{if(!r.current||t.length===0)return;const a=ut(r.current);a.selectAll("*").remove();const l=Math.min(e,i)/2-20,c=l*.55,u=a.append("g").attr("transform",`translate(${e/2},${i/2})`),f=sp().value(g=>g.count).sort(null),h=vo().innerRadius(c).outerRadius(l),d=vo().innerRadius(c).outerRadius(l+8);u.selectAll("path").data(f(t)).join("path").attr("d",h).attr("fill",g=>g.data.color).attr("stroke","#000").attr("stroke-width",2).style("cursor","pointer").on("mouseover",function(g,v){ut(this).transition().duration(200).attr("d",d(v)),p.style("opacity",1).html(`<strong>${v.data.category}</strong><br/>${v.data.count.toLocaleString()} ${n("pages.habitability.charts.breakdown.planets")}<br/>${v.data.pct.toFixed(2)}%`).style("left",`${g.offsetX+10}px`).style("top",`${g.offsetY-10}px`)}).on("mouseout",function(g,v){ut(this).transition().duration(200).attr("d",h(v)),p.style("opacity",0)}),u.append("text").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill",ce.text).attr("font-size",14).attr("dy",-10).text(n("pages.habitability.charts.breakdown.total")),u.append("text").attr("text-anchor","middle").attr("dominant-baseline","middle").attr("fill",ce.primary).attr("font-size",24).attr("font-weight","bold").attr("dy",15).text(o.toLocaleString());const p=ut(r.current.parentNode).append("div").attr("class","chart-tooltip").style("opacity",0).style("position","absolute").style("background","rgba(0,0,0,0.9)").style("border","1px solid #333").style("border-radius","4px").style("padding","8px 12px").style("font-size","12px").style("color","#fff").style("pointer-events","none").style("z-index","10");return()=>{p.remove()}},[t,e,i,o,n]),T.jsx("svg",{ref:r,width:e,height:i})}function Ep(){const{t}=Je(),{isLoading:e,error:i,getAllPlanets:o,getTopHabitable:r}=Is(),n=ie.useMemo(()=>{if(e)return null;const a=o(),s=r(10);return{stats:dc(a),spatial:hc(a),scoreDistribution:lc(a),temperatureData:cc(a),starTypeStats:uc(a),discoveryTrends:fc(a),planetStarHeatmap:gc(a),featureCooccurrence:yc(a),featurePrevalence:vc(a),habitabilityBreakdown:bc(a),topCandidates:s,totalPlanets:a.length}},[e,o,r]);return e?T.jsx("div",{className:"flex-1 flex items-center justify-center",children:T.jsxs("div",{className:"text-center",children:[T.jsx(Gs,{}),T.jsx("p",{className:"mt-4 text-white/60",children:t("pages.habitability.loading")})]})}):i?T.jsx("div",{className:"flex-1 flex items-center justify-center",children:T.jsxs("div",{className:"text-center text-red-400",children:[T.jsx("h2",{className:"text-xl font-bold mb-2",children:t("common.error")}),T.jsx("p",{children:i})]})}):n?T.jsxs("div",{className:"habitability-page",children:[T.jsxs("section",{className:"habitability-hero-section",children:[T.jsxs("div",{className:"habitability-hero-header",children:[T.jsx("h1",{className:"habitability-title",children:t("pages.habitability.title")}),T.jsx("p",{className:"habitability-subtitle",children:t("pages.habitability.subtitle")})]}),T.jsx(Dc,{data:n.spatial,stats:n.stats})]}),T.jsx(Fc,{stats:n.stats}),T.jsxs("section",{className:"habitability-charts-section",children:[T.jsx("h2",{className:"section-title",children:t("pages.habitability.insights.title")}),T.jsxs("div",{className:"charts-grid",children:[T.jsx(lp,{data:n.scoreDistribution}),T.jsx(up,{data:n.temperatureData}),T.jsx(dp,{data:n.starTypeStats}),T.jsx(vp,{data:n.discoveryTrends})]})]}),T.jsxs("section",{className:"habitability-charts-section",children:[T.jsx("h2",{className:"section-title",children:t("pages.habitability.deepDive.title")}),T.jsxs("div",{className:"charts-grid",children:[T.jsx(wo,{data:n.planetStarHeatmap.data,xLabels:n.planetStarHeatmap.xLabels,yLabels:n.planetStarHeatmap.yLabels,maxValue:n.planetStarHeatmap.maxValue,title:t("pages.habitability.deepDive.planetStarHeatmap"),xAxisLabel:t("pages.habitability.deepDive.starClass"),yAxisLabel:t("pages.habitability.deepDive.planetType"),colorScheme:"blue"}),T.jsx(wo,{data:n.featureCooccurrence.data,xLabels:n.featureCooccurrence.labels,yLabels:n.featureCooccurrence.labels,maxValue:n.featureCooccurrence.maxValue,title:t("pages.habitability.deepDive.featureCooccurrence"),colorScheme:"green",showValues:!0}),T.jsx(xp,{data:n.featurePrevalence,title:t("pages.habitability.deepDive.featurePrevalence")}),T.jsx(wp,{data:n.habitabilityBreakdown,title:t("pages.habitability.deepDive.habitabilityBreakdown"),totalPlanets:n.totalPlanets})]})]}),T.jsxs("section",{className:"habitability-candidates-section",children:[T.jsx("h2",{className:"section-title",children:t("pages.habitability.candidates.title")}),T.jsx("p",{className:"section-description",children:t("pages.habitability.candidates.description")}),T.jsx(Rc,{candidates:n.topCandidates})]}),T.jsxs("section",{className:"habitability-methodology-section",children:[T.jsx("h2",{className:"section-title",children:t("pages.habitability.methodology.title")}),T.jsxs("div",{className:"methodology-card",children:[T.jsx("p",{className:"methodology-intro",children:t("pages.habitability.methodology.description")}),T.jsxs("ul",{className:"methodology-list",children:[T.jsx("li",{children:t("pages.habitability.methodology.temperature")}),T.jsx("li",{children:t("pages.habitability.methodology.size")}),T.jsx("li",{children:t("pages.habitability.methodology.starType")}),T.jsx("li",{children:t("pages.habitability.methodology.insolation")})]})]})]})]}):null}export{Ep as default};
