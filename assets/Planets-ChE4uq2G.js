import{c as he,d as de,u as pe,f as ue,r as n,j as s,S as ge}from"./index-BO05hWw5.js";import{P as me}from"./PlanetCard-Cju8cCGc.js";const T=24;function je(){const{t:a}=he(),{getAllPlanets:O,isLoading:Q,error:w}=de(),{trackSearch:W,trackFilter:S}=pe(),[i,L]=ue(),M=n.useRef(null),[b,E]=n.useState(i.get("sort")||"name"),[h,z]=n.useState(i.get("types")?i.get("types").split(","):[]),[d,F]=n.useState(i.get("classes")?i.get("classes").split(","):[]),[u,H]=n.useState(i.get("search")||""),[f,A]=n.useState(i.get("habitable")==="true"),[x,I]=n.useState(i.get("earthlike")==="true"),[j,R]=n.useState(i.get("eccentric")==="true"),[y,q]=n.useState(i.get("circumbinary")==="true"),[g,D]=n.useState(i.get("method")||"all"),[v,U]=n.useState(i.get("ultrahot")==="true"),[N,B]=n.useState(i.get("frozen")==="true"),[G,_]=n.useState(parseInt(i.get("page")||"1",10)),m=n.useMemo(()=>O(),[O]),J=n.useMemo(()=>{const e=new Set;return m.forEach(r=>{r.planet_type&&e.add(r.planet_type)}),Array.from(e).sort()},[m]),K=n.useMemo(()=>{const e=new Set;return m.forEach(r=>{r.star_class&&e.add(r.star_class)}),Array.from(e).sort()},[m]),k=n.useMemo(()=>{let e=m;if(h.length>0&&(e=e.filter(t=>t.planet_type&&h.includes(t.planet_type))),d.length>0&&(e=e.filter(t=>t.star_class&&d.includes(t.star_class))),f&&(e=e.filter(t=>t.is_habitable_zone)),x&&(e=e.filter(t=>t.is_earth_like)),j&&(e=e.filter(t=>t.is_eccentric_orbit)),y&&(e=e.filter(t=>t.is_circumbinary)),g!=="all"&&(e=e.filter(t=>{const l=t.has_rv_data,C=t.is_transiting;switch(g){case"rv":return l&&!C;case"transit":return C&&!l;case"both":return l&&C;default:return!0}})),v&&(e=e.filter(t=>t.is_ultra_hot)),N&&(e=e.filter(t=>t.is_frozen_world)),u){const t=u.toLowerCase();e=e.filter(l=>l.pl_name.toLowerCase().includes(t)||l.hostname.toLowerCase().includes(t))}return[...e].sort((t,l)=>{switch(b){case"distance":return(t.distance_ly??1/0)-(l.distance_ly??1/0);case"mass":return(l.pl_bmasse??0)-(t.pl_bmasse??0);case"radius":return(l.pl_rade??0)-(t.pl_rade??0);case"discoveryYear":return l.disc_year-t.disc_year;case"habitability":const C=t.habitability_score??0;return(l.habitability_score??0)-C;case"temperatureHot":return(l.pl_eqt??0)-(t.pl_eqt??0);case"temperatureCold":return(t.pl_eqt??1/0)-(l.pl_eqt??1/0);case"name":default:return t.pl_name.localeCompare(l.pl_name)}})},[m,h,d,f,x,j,y,g,v,N,u,b]),p=Math.ceil(k.length/T),c=Math.min(Math.max(1,G),p||1),P=(c-1)*T,Y=P+T,$=k.slice(P,Y);n.useEffect(()=>{const e=new URLSearchParams;b!=="name"&&e.set("sort",b),h.length>0&&e.set("types",h.join(",")),d.length>0&&e.set("classes",d.join(",")),u&&e.set("search",u),f&&e.set("habitable","true"),x&&e.set("earthlike","true"),j&&e.set("eccentric","true"),y&&e.set("circumbinary","true"),g!=="all"&&e.set("method",g),v&&e.set("ultrahot","true"),N&&e.set("frozen","true"),c!==1&&e.set("page",String(c)),L(e,{replace:!0})},[b,h,d,u,f,x,j,y,g,v,N,c,L]);const o=()=>{_(1)},V=e=>{const r=!h.includes(e);z(t=>t.includes(e)?t.filter(l=>l!==e):[...t,e]),o(),r&&S("planet_type",e)},X=e=>{const r=!d.includes(e);F(t=>t.includes(e)?t.filter(l=>l!==e):[...t,e]),o(),r&&S("star_class",e)},Z=e=>{H(e),o(),M.current&&clearTimeout(M.current),e.length>=2&&(M.current=setTimeout(()=>{const r=m.filter(t=>t.pl_name.toLowerCase().includes(e.toLowerCase())||t.hostname.toLowerCase().includes(e.toLowerCase()));W("planets",e,r.length)},500))},ee=e=>{E(e),o()},se=()=>{f||S("habitable_zone","true"),A(e=>!e),o()},te=()=>{x||S("earth_like","true"),I(e=>!e),o()},ae=()=>{R(e=>!e),o()},le=()=>{q(e=>!e),o()},ne=e=>{D(e),o()},re=()=>{U(e=>!e),o()},ie=()=>{B(e=>!e),o()},ce=()=>{z([]),F([]),H(""),A(!1),I(!1),R(!1),q(!1),D("all"),U(!1),B(!1),E("name"),_(1)};if(Q)return s.jsx(ge,{message:a("pages.planets.loading")});if(w)return s.jsx("div",{className:"error-container",children:s.jsxs("div",{className:"error-content",children:[s.jsx("h1",{className:"error-title",children:a("pages.planets.errorTitle")}),s.jsx("p",{className:"error-message",children:w})]})});const oe=h.length>0||d.length>0||u||f||x||j||y||g!=="all"||v||N;return s.jsxs("div",{className:"page-container",children:[s.jsx("h1",{className:"page-title",children:a("pages.planets.title")}),s.jsxs("div",{className:"planets-controls",children:[s.jsx("div",{className:"search-bar",children:s.jsx("input",{type:"text",placeholder:a("pages.planets.searchPlaceholder"),value:u,onChange:e=>Z(e.target.value),className:"search-input"})}),s.jsxs("div",{className:"controls-row",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:a("pages.planets.filters.planetType")}),s.jsx("div",{className:"type-buttons",children:J.map(e=>s.jsx("button",{onClick:()=>V(e),className:`type-button ${h.includes(e)?"active":""}`,children:e},e))})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:a("pages.planets.filters.starClass")}),s.jsx("div",{className:"class-buttons",children:K.map(e=>s.jsx("button",{onClick:()=>X(e),className:`class-button ${d.includes(e)?"active":""}`,children:e},e))})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:a("pages.planets.filters.discoveryMethod")}),s.jsxs("select",{value:g,onChange:e=>ne(e.target.value),className:"sort-select",children:[s.jsx("option",{value:"all",children:a("pages.planets.filters.discoveryMethods.all")}),s.jsx("option",{value:"transit",children:a("pages.planets.filters.discoveryMethods.transit")}),s.jsx("option",{value:"rv",children:a("pages.planets.filters.discoveryMethods.rv")}),s.jsx("option",{value:"both",children:a("pages.planets.filters.discoveryMethods.both")})]})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{className:"filter-label",children:a("pages.planets.filters.sortBy")}),s.jsxs("select",{value:b,onChange:e=>ee(e.target.value),className:"sort-select",children:[s.jsx("option",{value:"name",children:a("pages.planets.sort.name")}),s.jsx("option",{value:"distance",children:a("pages.planets.sort.distance")}),s.jsx("option",{value:"mass",children:a("pages.planets.sort.mass")}),s.jsx("option",{value:"radius",children:a("pages.planets.sort.radius")}),s.jsx("option",{value:"discoveryYear",children:a("pages.planets.sort.discoveryYear")}),s.jsx("option",{value:"habitability",children:a("pages.planets.sort.habitability")}),s.jsx("option",{value:"temperatureHot",children:"Temperature (Hottest)"}),s.jsx("option",{value:"temperatureCold",children:"Temperature (Coldest)"})]})]})]}),s.jsxs("div",{className:"toggle-filters",children:[s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:f,onChange:se,className:"toggle-checkbox"}),s.jsx("span",{children:a("pages.planets.filters.habitableOnly")})]}),s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:x,onChange:te,className:"toggle-checkbox"}),s.jsx("span",{children:a("pages.planets.filters.earthLikeOnly")})]}),s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:j,onChange:ae,className:"toggle-checkbox"}),s.jsx("span",{children:a("pages.planets.filters.eccentricOnly")})]}),s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:y,onChange:le,className:"toggle-checkbox"}),s.jsx("span",{children:a("pages.planets.filters.circumbinaryOnly")})]}),s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:v,onChange:re,className:"toggle-checkbox"}),s.jsx("span",{children:"Ultra Hot Worlds"})]}),s.jsxs("label",{className:"toggle-filter",children:[s.jsx("input",{type:"checkbox",checked:N,onChange:ie,className:"toggle-checkbox"}),s.jsx("span",{children:"Frozen Worlds"})]})]}),oe&&s.jsx("button",{onClick:ce,className:"clear-button",children:a("pages.planets.filters.clearFilters")}),s.jsxs("div",{className:"results-info",children:[a(k.length!==1?"pages.planets.results.showing_plural":"pages.planets.results.showing",{start:P+1,end:Math.min(Y,k.length),filtered:k.length})," ",a("pages.planets.results.total",{total:m.length})]})]}),$.length>0?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"planets-grid",children:$.map(e=>s.jsx("div",{className:"planets-grid-item",children:s.jsx(me,{planet:e})},e.pl_name))}),p>1&&s.jsxs("div",{className:"pagination-container",children:[s.jsx("button",{onClick:()=>_(Math.max(1,c-1)),disabled:c===1,className:"pagination-button",children:a("pages.planets.pagination.previous")}),s.jsx("div",{className:"pagination-info",children:a("pages.planets.pagination.pageOf",{current:c,total:p})}),s.jsx("div",{className:"pagination-numbers",children:Array.from({length:Math.min(5,p)},(e,r)=>{let t=r+1;return p>5&&(c<=3?t=r+1:c>=p-2?t=p-4+r:t=c-2+r),s.jsx("button",{onClick:()=>_(t),className:`pagination-number ${c===t?"active":""}`,children:t},t)})}),s.jsx("button",{onClick:()=>_(Math.min(p,c+1)),disabled:c===p,className:"pagination-button",children:a("pages.planets.pagination.next")})]})]}):s.jsx("div",{className:"placeholder",children:a("pages.planets.results.noResults")})]})}export{je as default};
